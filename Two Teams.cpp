// store the indices of extremes for each element;
// and when an element is deleted, update the indices of the extremes for its extreme elements' neighbours



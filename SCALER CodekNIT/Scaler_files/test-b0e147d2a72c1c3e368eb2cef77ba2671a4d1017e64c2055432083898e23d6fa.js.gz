function S3Store(e,t){this.bucket=t||"ib-assessment-tests",this.bucketRegion=e||"us-west-2",this.addPhoto=function(e,t){this.upload_params=t,this.getPostPolicyDocument(e,t.Key.split("/").pop())},this.getPostPolicyDocument=function(e,t){var n=this;$.ajax({url:"ppd",type:"GET",data:{record_type:e,file_name:t},dataType:"json",success:function(o){if("csv_for_cold"==e&&toastr.success("Uploading..."),o){n.signed_s3_post=o.signed_s3_post;var i=n.populateFormData(n.signed_s3_post,n.upload_params);$.ajax({method:"POST",crossDomain:!0,url:"https://"+n.bucket+".s3.amazonaws.com/",data:i,enctype:"multipart/form-data",contentType:!1,processData:!1,cache:!1,success:function(){"csv_for_cold"==e&&(toastr.success("Uploaded."),$.ajax({url:"add-csv-to-cold",type:"POST",data:{file_name:t},dataType:"json",success:function(){}}))}})}},error:function(){}})},this.populateFormData=function(e,t){var n=new FormData;return n.append("key",e.key),n.append("acl",e.acl),n.append("Content-Type",t.ContentType),n.append("AWSAccessKeyId",e.access_key),n.append("policy",e.policy),n.append("signature",e.signature),n.append("file",t.Body),n},this.resizeBase64Image=function(e,t,n){var o=document.createElement("canvas");o.width=t,o.height=n;var i=o.getContext("2d"),r=$.Deferred();return $("<img/>").attr("src",e).load(function(){i.scale(t/this.width,n/this.height),i.drawImage(this,0,0),r.resolve($("<img/>").attr("src",o.toDataURL())),o=null}),r.promise()},this.getDataURLFromImg=function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0);var n=t.toDataURL("image/png");return t=null,n},this.getBase64Image=function(){var e=document.createElement("canvas");e.width=img.width,e.height=img.height,e.getContext("2d").drawImage(img,0,0);var t=e.toDataURL("image/png");return e=null,t.replace(/^data:image\/(png|jpg);base64,/,"")}}function setGlobalConfig(e){globalConfig=e}function endTest(){$.ajax({url:rootUrl+"finish",type:"POST",success:function(){window.location="feedback"},error:function(e){console.log(e)}})}function endSection(e){var e=e;$.ajax({url:rootUrl+"end-section",data:{section_key:e},type:"POST",success:function(){toastr.info("One of the sections has ended. Refreshing...","INFO"),setTimeout(function(){$("#index_page").click()},2e3)},error:function(e){console.log(e)}})}function endIdeathonPhase(e){toastr.info(e+" Phase has ended! Refreshing...","INFO"),setTimeout(function(){window.location.reload()},5e3)}function recordRestrictedEvent(e,t){if([undefined,null].includes(t)&&(t=!0),window.ignore_event)return void(window.ignore_event=!1);logoutOnCrime(),disqualifyOnCrime();try{$.ajax({url:rootUrl+"record-event",type:"POST",data:{event_type:e},success:function(e){e.success&&alertCount<=MAX_ALERTS&&t&&toastr.warning("You have performed "+alertCount+" restricted event(s). You might be DISQUALIFIED after "+MAX_ALERTS+" events.","WARNING!",{timeOut:1e4})},error:function(e){console.log(e)}})}catch(e){console.log("Event record failed.")}}function recordErrors(e){window.location.pathname.match(/^\/test\//g)&&$.ajax({url:rootUrl+"error",type:"POST",data:{error:e},success:function(){},error:function(e){console.log(e)}})}function handleVisibilityChange(){0!=document.webkitIsFullScreen&&0!=document.mozFullScreen&&0!=document.msFullscreenElement||document.hidden&&!window.ignore_event&&(alertCount++,recordRestrictedEvent("tab_switch"))}function openConnectivityCheck(){$("#ib_loader").hide(),toastr.error("Not able to establish connection to InterviewBit Servers. Please check internet connectivity","Error",{timeOut:3e4}),shownConnectivityToast=!0}function closeConnectivityCheck(){1==shownConnectivityToast&&(toastr.success("Connection Established!","SUCCESS",{timeOut:3e4}),shownConnectivityToast=!1)}function cloneObject(e){return JSON.parse(JSON.stringify(e))}function sortObjectByKey(e){var t=[],n={};for(var o in e)e.hasOwnProperty(o)&&t.push(o);return t.sort(),jQuery.each(t,function(t,o){n[o]=e[o]}),n}function serverErrorHandling(e){if($("#ib_loader").hide(),"abort"!=e.statusText){EXIT_WARNINGS=1;var t=window.location.href.split("/")[4].toString(),n=JSON.parse(localStorage.getItem("serverError"));if(null==n&&(n={}),n[t]){if(n[t]=n[t]+1,localStorage.serverError=JSON.stringify(n),n[t]%3==0){var o=e.config&&e.config.url?e.config.url:"url not catched in response";recordErrors("Server Error occured for this test slug "+t+" for "+n[t]+" times. Details: Request Status is "+e.status+" with statusText as "+e.statusText+" and request failed at "+o)}}else n[t]=1,localStorage.setItem("serverError",JSON.stringify(n));n[t]>3?toastr.error("Something went wrong! Please contact IB team..","Error",{timeOut:5e3}):(toastr.error("Something went wrong! Refreshing the page..","Error",{timeOut:5e3}),location.reload())}}function cancelAllRequestsAndIntervals(){currentSaveRequest&&currentSaveRequest.abort(),currentCodeRequest&&currentCodeRequest.abort(),clearTimeout(getStatusTimer),clearTimeout(autoSave)}Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){function n(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),i=o.length>>>0;if(0===i)return!1;for(var r=0|t,s=Math.max(r>=0?r:i-Math.abs(r),0);s<i;){if(n(o[s],e))return!0;s++}return!1}}),Object.values||(Object.values=function(e){return Object.keys(e).map(function(t){return e[t]})}),myinterviewtrainer={},myinterviewtrainer.createNS=function(e){var t=e.split("."),n=myinterviewtrainer;"myinterviewtrainer"===t[0]&&(t=t.slice(1));for(var o=0;o<t.length;o++){var i=t[o];"undefined"==typeof n[i]&&(n[i]={}),n=n[i]}return n};var get_browser=function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(n[1]))return e=/\brv[ :]+(\d+)/g.exec(t)||[],{name:"IE",version:e[1]||""};if("Chrome"===n[1]&&null!=(e=t.match(/\bOPR|Edge\/(\d+)/)))return{name:"Opera",version:e[1]};n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]);var o=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,i="undefined"!=typeof InstallTrigger,r=/constructor/i.test(window.HTMLElement)||function(e){return"[object SafariRemoteNotification]"===e.toString()}(!window.safari||"undefined"!=typeof safari&&safari.pushNotification),s=!!document.documentMode,a=!s&&!!window.StyleMedia,l=!!window.chrome&&!!window.chrome.webstore,c=(l||o)&&!!window.CSS,u="";return o&&(u+="Opera/"),l&&(u+="Chrome/"),c&&(u+="Blink/"),i&&(u+="Firefox/"),r&&(u+="Safari/"),s&&(u+="IE/"),a&&(u+="Edge/"),{name:u,version:n[1]}},get_OS=function(){var e="Unknown OS";return-1!=navigator.appVersion.indexOf("Win")&&(e="Windows"),-1!=navigator.appVersion.indexOf("Mac")&&(e="MacOS"),-1!=navigator.appVersion.indexOf("X11")&&(e="UNIX"),-1!=navigator.appVersion.indexOf("Linux")&&(e="Linux"),e};/*
 * Toastr
 * Copyright 2012-2015
 * Authors: John Papa, Hans FjÃ¤llemark, and Tim Ferrell.
 * All Rights Reserved.
 * Use, reproduction, distribution, and modification of this code is subject to the terms and
 * conditions of the MIT license, available at http://www.opensource.org/licenses/mit-license.php
 *
 * ARIA Support: Greta Krafsig
 *
 * Project: https://github.com/CodeSeven/toastr
 */
!function(e){e(["jquery"],function(e){return function(){function t(e,t,n){try{ga("send","exception",{exDescription:"Toastr Err:: title: "+t+", message: "+e,exFatal:!1})}catch(e){console.log(e)}return f({type:C.error,iconClass:m().iconClasses.error,message:e,optionsOverride:n,title:t})}function n(t,n){return t||(t=m()),v=e("#"+t.containerId),v.length?v:(n&&(v=d(t)),v)}function o(e,t,n){return f({type:C.info,iconClass:m().iconClasses.info,message:e,optionsOverride:n,title:t})}function i(e){y=e}function r(e,t,n){return f({type:C.success,iconClass:m().iconClasses.success,message:e,optionsOverride:n,title:t})}function s(e,t,n){return f({type:C.warning,iconClass:m().iconClasses.warning,message:e,optionsOverride:n,title:t})}function a(e,t){var o=m();v||n(o),u(e,o,t)||c(o)}function l(t){var o=m();if(v||n(o),t&&0===e(":focus",t).length)return void g(t);v.children().length&&v.remove()}function c(t){for(var n=v.children(),o=n.length-1;o>=0;o--)u(e(n[o]),t)}function u(t,n,o){var i=!(!o||!o.force)&&o.force;return!(!t||!i&&0!==e(":focus",t).length)&&(t[n.hideMethod]({duration:n.hideDuration,easing:n.hideEasing,complete:function(){g(t)}}),!0)}function d(t){return v=e("<div/>").attr("id",t.containerId).addClass(t.positionClass),v.appendTo(e(t.target)),v}function h(){return{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:undefined,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:undefined,closeMethod:!1,closeDuration:!1,closeEasing:!1,closeOnHover:!0,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",escapeHtml:!1,target:"body",closeHtml:'<button type="button">&times;</button>',closeClass:"toast-close-button",newestOnTop:!0,preventDuplicates:!1,progressBar:!1,progressClass:"toast-progress",rtl:!1}}function p(e){y&&y(e)}function f(t){function o(e){return null==e&&(e=""),e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function i(){l(),u(),d(),h(),f(),y(),c(),r()}function r(){var e="";switch(t.iconClass){case"toast-success":case"toast-info":e="polite";break;default:e="assertive"}A.attr("aria-live",e)}function s(){$.closeOnHover&&A.hover(S,_),!$.onclick&&$.tapToDismiss&&A.click(k),$.closeButton&&R&&R.click(function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble!==undefined&&!0!==e.cancelBubble&&(e.cancelBubble=!0),$.onCloseClick&&$.onCloseClick(e),k(!0)}),$.onclick&&A.click(function(e){$.onclick(e),k()})}function a(){A.hide(),A[$.showMethod]({duration:$.showDuration,easing:$.showEasing,complete:$.onShown}),$.timeOut>0&&(E=setTimeout(k,$.timeOut),L.maxHideTime=parseFloat($.timeOut),L.hideEta=(new Date).getTime()+L.maxHideTime,$.progressBar&&(L.intervalId=setInterval(x,10)))}function l(){t.iconClass&&A.addClass($.toastClass).addClass(T)}function c(){$.newestOnTop?v.prepend(A):v.append(A)}function u(){if(t.title){var e=t.title;$.escapeHtml&&(e=o(t.title)),M.append(e).addClass($.titleClass),A.append(M)}}function d(){if(t.message){var e=t.message;$.escapeHtml&&(e=o(t.message)),I.append(e).addClass($.messageClass),A.append(I)}}function h(){$.closeButton&&(R.addClass($.closeClass).attr("role","button"),A.prepend(R))}function f(){$.progressBar&&(O.addClass($.progressClass),A.prepend(O))}function y(){$.rtl&&A.addClass("rtl")}function C(e,t){if(e.preventDuplicates){if(t.message===b)return!0;b=t.message}return!1}function k(t){var n=t&&!1!==$.closeMethod?$.closeMethod:$.hideMethod,o=t&&!1!==$.closeDuration?$.closeDuration:$.hideDuration,i=t&&!1!==$.closeEasing?$.closeEasing:$.hideEasing;if(!e(":focus",A).length||t)return clearTimeout(L.intervalId),A[n]({duration:o,easing:i,complete:function(){g(A),clearTimeout(E),$.onHidden&&"hidden"!==P.state&&$.onHidden(),P.state="hidden",P.endTime=new Date,p(P)}})}function _(){($.timeOut>0||$.extendedTimeOut>0)&&(E=setTimeout(k,$.extendedTimeOut),L.maxHideTime=parseFloat($.extendedTimeOut),L.hideEta=(new Date).getTime()+L.maxHideTime)}function S(){clearTimeout(E),L.hideEta=0,A.stop(!0,!0)[$.showMethod]({duration:$.showDuration,easing:$.showEasing})}function x(){var e=(L.hideEta-(new Date).getTime())/L.maxHideTime*100;O.width(e+"%")}var $=m(),T=t.iconClass||$.iconClass;if("undefined"!=typeof t.optionsOverride&&($=e.extend($,t.optionsOverride),T=t.optionsOverride.iconClass||T),!C($,t)){w++,v=n($,!0);var E=null,A=e("<div/>"),M=e("<div/>"),I=e("<div/>"),O=e("<div/>"),R=e($.closeHtml),L={intervalId:null,hideEta:null,maxHideTime:null},P={toastId:w,state:"visible",startTime:new Date,options:$,map:t};return i(),a(),s(),p(P),$.debug&&console&&console.log(P),A}}function m(){return e.extend({},h(),k.options)}function g(e){v||(v=n()),e.is(":visible")||(e.remove(),e=null,0===v.children().length&&(v.remove(),b=undefined))}var v,y,b,w=0,C={error:"error",info:"info",success:"success",warning:"warning"},k={clear:a,remove:l,error:t,getContainer:n,info:o,options:{},subscribe:i,success:r,version:"2.1.3",warning:s};return k}()})}("function"==typeof define&&define.amd?define:function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):window.toastr=t(window.jQuery)}),/**
 * Super simple wysiwyg editor v0.8.9
 * https://summernote.org
 *
 * Copyright 2013- Alan Hong. and other contributors
 * summernote may be freely distributed under the MIT license.
 *
 * Date: 2017-12-25T06:39Z
 */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(e.jQuery)}(this,function(e){"use strict";function t(e){return function(t){return e===t}}function n(e,t){return e===t}function o(e){return function(t,n){return t[e]===n[e]}}function i(){return!0}function r(){return!1}function s(e){return function(){return!e.apply(e,arguments)}}function a(e,t){return function(n){return e(n)&&t(n)}}function l(e){return e}function c(e,t){return function(){return e[t].apply(e,arguments)}}function u(e){var t=++ft+"";return e?e+t:t}function d(e){var t=$(document);return{top:e.top+t.scrollTop(),left:e.left+t.scrollLeft(),width:e.right-e.left,height:e.bottom-e.top}}function h(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function p(e,t){return(t=t||"")+e.split(".").map(function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}).join("")}function f(e,t,n){var o,i=this;return function(){var r=i,s=arguments,a=function(){o=null,n||e.apply(r,s)},l=n&&!o;clearTimeout(o),o=setTimeout(a,t),l&&e.apply(r,s)}}function m(e){return e[0]}function g(e){return e[e.length-1]}function v(e){return e.slice(0,e.length-1)}function y(e){return e.slice(1)}function b(e,t){for(var n=0,o=e.length;n<o;n++){var i=e[n];if(t(i))return i}}function w(e,t){for(var n=0,o=e.length;n<o;n++)if(!t(e[n]))return!1;return!0}function C(t,n){return e.inArray(n,t)}function k(e,t){return-1!==C(e,t)}function _(e,t){return t=t||mt.self,e.reduce(function(e,n){return e+t(n)},0)}function S(e){for(var t=[],n=e.length,o=-1;++o<n;)t[o]=e[o];return t}function x(e){return!e||!e.length}function T(e,t){return e.length?y(e).reduce(function(e,n){var o=g(e);return t(g(o),n)?o[o.length]=n:e[e.length]=[n],e},[[m(e)]]):[]}function E(e){for(var t=[],n=0,o=e.length;n<o;n++)e[n]&&t.push(e[n]);return t}function A(e){for(var t=[],n=0,o=e.length;n<o;n++)k(t,e[n])||t.push(e[n]);return t}function M(e,t){var n=C(e,t);return-1===n?null:e[n+1]}function I(e,t){var n=C(e,t);return-1===n?null:e[n-1]}function O(t){var n="Comic Sans MS"===t?"Courier New":"Comic Sans MS",o=e("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),i=o.css("fontFamily",n).width(),r=o.css("fontFamily",t+","+n).width();return o.remove(),i!==r}function R(t){return t&&e(t).hasClass("note-editable")}function L(t){return t&&e(t).hasClass("note-control-sizing")}function P(e){return e=e.toUpperCase(),function(t){return t&&t.nodeName.toUpperCase()===e}}function D(e){return e&&3===e.nodeType}function N(e){return e&&1===e.nodeType}function H(e){return e&&/^BR|^IMG|^HR|^IFRAME|^BUTTON|^INPUT/.test(e.nodeName.toUpperCase())}function B(e){return!R(e)&&(e&&/^DIV|^P|^LI|^H[1-7]/.test(e.nodeName.toUpperCase()))}function F(e){return e&&/^H[1-7]/.test(e.nodeName.toUpperCase())}function j(e){return B(e)&&!At(e)}function U(e){return!(K(e)||q(e)||Ot(e)||B(e)||Mt(e)||Rt(e)||It(e))}function q(e){return e&&/^UL|^OL/.test(e.nodeName.toUpperCase())}function z(e){return e&&/^TD|^TH/.test(e.nodeName.toUpperCase())}function K(e){return z(e)||Rt(e)||R(e)}function W(e){return U(e)&&!!Z(e,B)}function V(e){return U(e)&&!Z(e,B)}function G(e,t){return e.nextSibling===t||e.previousSibling===t}function Y(e,t){t=t||mt.ok;var n=[];return e.previousSibling&&t(e.previousSibling)&&n.push(e.previousSibling),n.push(e),e.nextSibling&&t(e.nextSibling)&&n.push(e.nextSibling),n}function Q(e){return D(e)?e.nodeValue.length:e?e.childNodes.length:0}function J(e){var t=Q(e);return 0===t||(!D(e)&&1===t&&e.innerHTML===Dt||!(!gt.all(e.childNodes,D)||""!==e.innerHTML))}function X(e){H(e)||Q(e)||(e.innerHTML=Dt)}function Z(e,t){for(;e;){if(t(e))return e;if(R(e))break;e=e.parentNode}return null}function ee(e,t){for(e=e.parentNode;e&&1===Q(e);){if(t(e))return e;if(R(e))break;e=e.parentNode}return null}function te(e,t){t=t||mt.fail;var n=[];return Z(e,function(e){return R(e)||n.push(e),t(e)}),n}function ne(e,t){var n=te(e);return gt.last(n.filter(t))}function oe(t,n){for(var o=te(t),i=n;i;i=i.parentNode)if(e.inArray(i,o)>-1)return i;return null}function ie(e,t){t=t||mt.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.previousSibling;return n}function re(e,t){t=t||mt.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.nextSibling;return n}function se(e,t){var n=[];return t=t||mt.ok,function o(i){e!==i&&t(i)&&n.push(i);for(var r=0,s=i.childNodes.length;r<s;r++)o(i.childNodes[r])}(e),n}function ae(t,n){var o=t.parentNode,i=e("<"+n+">")[0];return o.insertBefore(i,t),i.appendChild(t),i}function le(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function ce(t,n){return e.each(n,function(e,n){t.appendChild(n)}),t}function ue(e){return 0===e.offset}function de(e){return e.offset===Q(e.node)}function he(e){return ue(e)||de(e)}function pe(e,t){for(;e&&e!==t;){if(0!==ve(e))return!1;e=e.parentNode}return!0}function fe(e,t){if(!t)return!1;for(;e&&e!==t;){if(ve(e)!==Q(e.parentNode)-1)return!1;e=e.parentNode}return!0}function me(e,t){return ue(e)&&pe(e.node,t)}function ge(e,t){return de(e)&&fe(e.node,t)}function ve(e){for(var t=0;e=e.previousSibling;)t+=1;return t}function ye(e){return!!(e&&e.childNodes&&e.childNodes.length)}function be(e,t){var n,o;if(0===e.offset){if(R(e.node))return null;n=e.node.parentNode,o=ve(e.node)}else ye(e.node)?(n=e.node.childNodes[e.offset-1],o=Q(n)):(n=e.node,o=t?0:e.offset-1);return{node:n,offset:o}}function we(e,t){var n,o;if(Q(e.node)===e.offset){if(R(e.node))return null;n=e.node.parentNode,o=ve(e.node)+1}else ye(e.node)?(n=e.node.childNodes[e.offset],o=0):(n=e.node,o=t?Q(e.node):e.offset+1);return{node:n,offset:o}}function Ce(e,t){return e.node===t.node&&e.offset===t.offset}function ke(e){if(D(e.node)||!ye(e.node)||J(e.node))return!0;var t=e.node.childNodes[e.offset-1],n=e.node.childNodes[e.offset];return!(t&&!H(t)||n&&!H(n))}function _e(e,t){for(;e;){if(t(e))return e;e=be(e)}return null}function Se(e,t){for(;e;){if(t(e))return e;e=we(e)}return null}function xe(e){if(!D(e.node))return!1;var t=e.node.nodeValue.charAt(e.offset-1);return t&&" "!==t&&t!==$t}function $e(e,t,n,o){for(var i=e;i&&(n(i),!Ce(i,t));){i=we(i,o&&e.node!==i.node&&t.node!==i.node)}}function Te(e,t){return te(t,mt.eq(e)).map(ve).reverse()}function Ee(e,t){for(var n=e,o=0,i=t.length;o<i;o++)n=n.childNodes.length<=t[o]?n.childNodes[n.childNodes.length-1]:n.childNodes[t[o]];return n}function Ae(e,t){var n=t&&t.isSkipPaddingBlankHTML,o=t&&t.isNotSplitEdgePoint;if(he(e)&&(D(e.node)||o)){if(ue(e))return e.node;if(de(e))return e.node.nextSibling}if(D(e.node))return e.node.splitText(e.offset);var i=e.node.childNodes[e.offset],r=le(e.node.cloneNode(!1),e.node);return ce(r,re(i)),n||(X(e.node),X(r)),r}function Me(e,t,n){var o=te(t.node,mt.eq(e));return o.length?1===o.length?Ae(t,n):o.reduce(function(e,o){return e===t.node&&(e=Ae(t,n)),Ae({node:o,offset:e?ve(e):Q(o)},n)}):null}function Ie(e,t){var n,o,i=t?B:K,r=te(e.node,i),s=gt.last(r)||e.node;i(s)?(n=r[r.length-2],o=s):(n=s,o=n.parentNode);var a=n&&Me(n,e,{isSkipPaddingBlankHTML:t,isNotSplitEdgePoint:t});return a||o!==e.node||(a=e.node.childNodes[e.offset]),{rightNode:a,container:o}}function Oe(e){return document.createElement(e)}function Re(e){return document.createTextNode(e)}function Le(e,t){if(e&&e.parentNode){if(e.removeNode)return e.removeNode(t);var n=e.parentNode;if(!t){for(var o=[],i=0,r=e.childNodes.length;i<r;i++)o.push(e.childNodes[i]);for(var i=0,r=o.length;i<r;i++)n.insertBefore(o[i],e)}n.removeChild(e)}}function Pe(e,t){for(;e&&!R(e)&&t(e);){var n=e.parentNode;Le(e),e=n}}function De(e,t){if(e.nodeName.toUpperCase()===t.toUpperCase())return e;var n=Oe(t);return e.style.cssText&&(n.style.cssText=e.style.cssText),ce(n,gt.from(e.childNodes)),le(n,e),Le(e),n}function Ne(e,t){var n=Nt(e[0])?e.val():e.html();return t?n.replace(/[\n\r]/g,""):n}function He(t,n){var o=Ne(t);if(n){var i=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;o=o.replace(i,function(e,t,n){n=n.toUpperCase();var o=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(n)&&!!t,i=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(n);return e+(o||i?"\n":"")}),o=e.trim(o)}return o}function Be(t){var n=e(t),o=n.offset(),i=n.outerHeight(!0);return{left:o.left,top:o.top+i}}function Fe(e,t){Object.keys(t).forEach(function(n){e.on(n,t[n])})}function je(e,t){Object.keys(t).forEach(function(n){e.off(n,t[n])})}function Ue(e){return e&&!D(e)&&gt.contains(e.classList,"note-styletag")}function qe(e,t){var n,o,i=e.parentElement(),r=document.body.createTextRange(),s=gt.from(i.childNodes);for(n=0;n<s.length;n++)if(!Ht.isText(s[n])){if(r.moveToElementText(s[n]),r.compareEndPoints("StartToStart",e)>=0)break;o=s[n]}if(0!==n&&Ht.isText(s[n-1])){var a=document.body.createTextRange(),l=null;a.moveToElementText(o||i),a.collapse(!o),l=o?o.nextSibling:i.firstChild;var c=e.duplicate();c.setEndPoint("StartToStart",a);for(var u=c.text.replace(/[\r\n]/g,"").length;u>l.nodeValue.length&&l.nextSibling;)u-=l.nodeValue.length,l=l.nextSibling;l.nodeValue;t&&l.nextSibling&&Ht.isText(l.nextSibling)&&u===l.nodeValue.length&&(u-=l.nodeValue.length,l=l.nextSibling),i=l,n=u}return{cont:i,offset:n}}function ze(e){var t=function(e,n){var o,i;if(Ht.isText(e)){var r=Ht.listPrev(e,mt.not(Ht.isText)),s=gt.last(r).previousSibling;o=s||e.parentNode,n+=gt.sum(gt.tail(r),Ht.nodeLength),i=!s}else{if(o=e.childNodes[n]||e,Ht.isText(o))return t(o,0);n=0,i=!1}return{node:o,collapseToStart:i,offset:n}},n=document.body.createTextRange(),o=t(e.node,e.offset);return n.moveToElementText(o.node),n.collapse(o.collapseToStart),n.moveStart("character",o.offset),n}function Ke(t){return e.Deferred(function(n){e.extend(new FileReader,{onload:function(e){var t=e.target.result;n.resolve(t)},onerror:function(e){n.reject(e)}}).readAsDataURL(t)}).promise()}function We(t){return e.Deferred(function(n){var o=e("<img>");o.one("load",function(){o.off("error abort"),n.resolve(o)}).one("error abort",function(){o.off("load").detach(),n.reject(o)}).css({display:"none"}).appendTo(document.body).attr("src",t)}).promise()}e=e&&e.hasOwnProperty("default")?e["default"]:e;var Ve,Ge=function(){function t(e,t,n,o){this.markup=e,this.children=t,this.options=n,this.callback=o}return t.prototype.render=function(t){var n=e(this.markup);if(this.options&&this.options.contents&&n.html(this.options.contents),this.options&&this.options.className&&n.addClass(this.options.className),this.options&&this.options.data&&e.each(this.options.data,function(e,t){n.attr("data-"+e,t)}),this.options&&this.options.click&&n.on("click",this.options.click),this.children){var o=n.find(".note-children-container");this.children.forEach(function(e){e.render(o.length?o:n)})}return this.callback&&this.callback(n,this.options),this.options&&this.options.callback&&this.options.callback(n),t&&t.append(n),n},t}(),Ye={create:function(t,n){return function(){var o="object"==typeof arguments[1]?arguments[1]:arguments[0],i=e.isArray(arguments[0])?arguments[0]:[];return o&&o.children&&(i=o.children),new Ge(t,i,o,n)}}},Qe=Ye.create('<div class="note-editor note-frame panel"/>'),Je=Ye.create('<div class="note-toolbar-wrapper panel-default"><div class="note-toolbar panel-heading"></div></div>'),Xe=Ye.create('<div class="note-editing-area"/>'),Ze=Ye.create('<textarea class="note-codable"/>'),et=Ye.create('<div class="note-editable" contentEditable="true"/>'),tt=Ye.create(['<div class="note-statusbar">','  <div class="note-resizebar">','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>',"  </div>","</div>"].join("")),nt=Ye.create('<div class="note-editor"/>'),ot=Ye.create('<div class="note-editable" contentEditable="true"/>'),it=Ye.create('<div class="note-btn-group btn-group">'),rt=Ye.create('<div class="dropdown-menu">',function(t,n){var o=e.isArray(n.items)?n.items.map(function(e){var t="string"==typeof e?e:e.value||"",o=n.template?n.template(e):e,i="object"==typeof e?e.option:undefined;return'<li><a href="#" data-value="'+t+'"'+(i!==undefined?' data-option="'+i+'"':"")+">"+o+"</a></li>"}).join(""):n.items;t.html(o)}),st=function(e,t){return e+" "+ht(t.icons.caret,"span")},at=Ye.create('<div class="dropdown-menu note-check">',function(t,n){var o=e.isArray(n.items)?n.items.map(function(e){var t="string"==typeof e?e:e.value||"",o=n.template?n.template(e):e;return'<li><a href="#" data-value="'+t+'">'+ht(n.checkClassName)+" "+o+"</a></li>"}).join(""):n.items;t.html(o)}),lt=Ye.create('<div class="note-color-palette"/>',function(e,t){for(var n=[],o=0,i=t.colors.length;o<i;o++){for(var r=t.eventName,s=t.colors[o],a=[],l=0,c=s.length;l<c;l++){var u=s[l];a.push(['<button type="button" class="note-color-btn"','style="background-color:',u,'" ','data-event="',r,'" ','data-value="',u,'" ','title="',u,'" ','data-toggle="button" tabindex="-1"></button>'].join(""))}n.push('<div class="note-color-row">'+a.join("")+"</div>")}e.html(n.join("")),t.tooltip&&e.find(".note-color-btn").tooltip({container:t.container,trigger:"hover",placement:"bottom"})}),ct=Ye.create('<div class="modal" aria-hidden="false" tabindex="-1"/>',function(e,t){t.fade&&e.addClass("fade"),e.html(['<div class="modal-dialog">','  <div class="modal-content">',t.title?'    <div class="modal-header">      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>      <h4 class="modal-title">'+t.title+"</h4>    </div>":"",'    <div class="modal-body">'+t.body+"</div>",t.footer?'    <div class="modal-footer">'+t.footer+"</div>":"","  </div>","</div>"].join(""))}),ut=Ye.create(['<div class="note-popover popover in">','  <div class="arrow"/>','  <div class="popover-content note-children-container"/>',"</div>"].join(""),function(e,t){var n="undefined"!=typeof t.direction?t.direction:"bottom";e.addClass(n),t.hideArrow&&e.find(".arrow").hide()}),dt=Ye.create('<div class="checkbox"></div>',function(e,t){e.html([" <label"+(t.id?' for="'+t.id+'"':"")+">",' <input type="checkbox"'+(t.id?' id="'+t.id+'"':""),(t.checked?" checked":"")+"/>",t.text?t.text:"","</label>"].join(""))}),ht=function(e,t){return"<"+(t=t||"i")+' class="'+e+'"/>'},pt={editor:Qe,toolbar:Je,editingArea:Xe,codable:Ze,editable:et,statusbar:tt,airEditor:nt,airEditable:ot,buttonGroup:it,dropdown:rt,dropdownButtonContents:st,dropdownCheck:at,palette:lt,dialog:ct,popover:ut,checkbox:dt,icon:ht,options:{},button:function(e,t){return Ye.create('<button type="button" class="note-btn btn btn-default btn-sm" tabindex="-1">',function(e,t){t&&t.tooltip&&e.attr({title:t.tooltip}).tooltip({container:t.container,trigger:"hover",placement:"bottom"})})(e,t)},toggleBtn:function(e,t){e.toggleClass("disabled",!t),e.attr("disabled",!t)},toggleBtnActive:function(e,t){e.toggleClass("active",t)},onDialogShown:function(e,t){e.one("shown.bs.modal",t)},onDialogHidden:function(e,t){e.one("hidden.bs.modal",t)},showDialog:function(e){e.modal("show")},hideDialog:function(e){e.modal("hide")},createLayout:function(e,t){var n=(t.airMode?pt.airEditor([pt.editingArea([pt.airEditable()])]):pt.editor([pt.toolbar(),pt.editingArea([pt.codable(),pt.editable()]),pt.statusbar()])).render();return n.insertAfter(e),{note:e,editor:n,toolbar:n.find(".note-toolbar"),editingArea:n.find(".note-editing-area"),editable:n.find(".note-editable"),codable:n.find(".note-codable"),statusbar:n.find(".note-statusbar")}},removeLayout:function(e,t){e.html(t.editable.html()),t.editor.remove(),e.show()}},ft=0,mt={eq:t,eq2:n,peq2:o,ok:i,fail:r,self:l,not:s,and:a,invoke:c,uniqueId:u,rect2bnd:d,invertObject:h,namespaceToCamel:p,debounce:f},gt={head:m,last:g,initial:v,tail:y,prev:I,next:M,find:b,contains:k,all:w,sum:_,from:S,isEmpty:x,clusterBy:T,compact:E,unique:A},vt="function"==typeof define&&define.amd,yt=navigator.userAgent,bt=/MSIE|Trident/i.test(yt);if(bt){var wt=/MSIE (\d+[.]\d+)/.exec(yt);wt&&(Ve=parseFloat(wt[1])),wt=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/.exec(yt),wt&&(Ve=parseFloat(wt[1]))}var Ct=/Edge\/\d+/.test(yt),kt=!!window.CodeMirror;if(!kt&&vt)if("function"==typeof __webpack_require__)try{require.resolve("codemirror"),kt=!0}catch(e){}else if("undefined"!=typeof require)if("undefined"!=typeof require.resolve)try{require.resolve("codemirror"),kt=!0}catch(e){}else"undefined"!=typeof require.specified&&(kt=require.specified("codemirror"));var _t="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,St=bt||Ct?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input",xt={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:bt,isEdge:Ct,isFF:!Ct&&/firefox/i.test(yt),isPhantom:/PhantomJS/i.test(yt),isWebkit:!Ct&&/webkit/i.test(yt),isChrome:!Ct&&/chrome/i.test(yt),isSafari:!Ct&&/safari/i.test(yt),browserVersion:Ve,jqueryVersion:parseFloat(e.fn.jquery),isSupportAmd:vt,isSupportTouch:_t,hasCodeMirror:kt,isFontInstalled:O,isW3CRangeSupport:!!document.createRange,inputEventName:St},$t=String.fromCharCode(160),Tt="\ufeff",Et=P("PRE"),At=P("LI"),Mt=P("TABLE"),It=P("DATA"),Ot=P("HR"),Rt=P("BLOCKQUOTE"),Lt=P("A"),Pt=P("BODY"),Dt=xt.isMSIE&&xt.browserVersion<11?"&nbsp;":"<br>",Nt=P("TEXTAREA"),Ht={NBSP_CHAR:$t,ZERO_WIDTH_NBSP_CHAR:Tt,blank:Dt,emptyPara:"<p>"+Dt+"</p>",makePredByNodeName:P,isEditable:R,isControlSizing:L,isText:D,isElement:N,isVoid:H,isPara:B,isPurePara:j,isHeading:F,isInline:U,isBlock:mt.not(U),isBodyInline:V,isBody:Pt,isParaInline:W,isPre:Et,isList:q,isTable:Mt,isData:It,isCell:z,isBlockquote:Rt,isBodyContainer:K,isAnchor:Lt,isDiv:P("DIV"),isLi:At,isBR:P("BR"),isSpan:P("SPAN"),isB:P("B"),isU:P("U"),isS:P("S"),isI:P("I"),isImg:P("IMG"),isTextarea:Nt,isEmpty:J,isEmptyAnchor:mt.and(Lt,J),isClosestSibling:G,withClosestSiblings:Y,nodeLength:Q,isLeftEdgePoint:ue,isRightEdgePoint:de,isEdgePoint:he,isLeftEdgeOf:pe,isRightEdgeOf:fe,isLeftEdgePointOf:me,isRightEdgePointOf:ge,prevPoint:be,nextPoint:we,isSamePoint:Ce,isVisiblePoint:ke,prevPointUntil:_e,nextPointUntil:Se,isCharPoint:xe,walkPoint:$e,ancestor:Z,singleChildAncestor:ee,listAncestor:te,lastAncestor:ne,listNext:re,listPrev:ie,listDescendant:se,commonAncestor:oe,wrap:ae,insertAfter:le,appendChildNodes:ce,position:ve,hasChildren:ye,makeOffsetPath:Te,fromOffsetPath:Ee,splitTree:Me,splitPoint:Ie,create:Oe,createText:Re,remove:Le,removeWhile:Pe,replace:De,html:He,value:Ne,posFromPlaceholder:Be,attachEvents:Fe,detachEvents:je,isCustomStyleTag:Ue};e.summernote=e.summernote||{lang:{}},e.extend(e.summernote.lang,{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image",original:"Original"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table",addRowAbove:"Add row above",addRowBelow:"Add row below",addColLeft:"Add column left",addColRight:"Add column right",delRow:"Delete row",delCol:"Delete column",delTable:"Delete table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",p:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},help:{insertParagraph:"Insert Paragraph",undo:"Undoes the last command",redo:"Redoes the last command",tab:"Tab",untab:"Untab",bold:"Set a bold style",italic:"Set a italic style",underline:"Set a underline style",strikethrough:"Set a strikethrough style",removeFormat:"Clean a style",justifyLeft:"Set left align",justifyCenter:"Set center align",justifyRight:"Set right align",justifyFull:"Set full align",insertUnorderedList:"Toggle unordered list",insertOrderedList:"Toggle ordered list",outdent:"Outdent on current paragraph",indent:"Indent on current paragraph",formatPara:"Change current block's format as a paragraph(P tag)",formatH1:"Change current block's format as H1",formatH2:"Change current block's format as H2",formatH3:"Change current block's format as H3",formatH4:"Change current block's format as H4",formatH5:"Change current block's format as H5",formatH6:"Change current block's format as H6",insertHorizontalRule:"Insert horizontal rule","linkDialog.show":"Show Link Dialog"},history:{undo:"Undo",redo:"Redo"},specialChar:{specialChar:"SPECIAL CHARACTERS",select:"Select Special characters"}}});var Bt={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,DELETE:46,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221},Ft={isEdit:function(e){return gt.contains([Bt.BACKSPACE,Bt.TAB,Bt.ENTER,Bt.SPACE,Bt.DELETE],e)},isMove:function(e){return gt.contains([Bt.LEFT,Bt.UP,Bt.RIGHT,Bt.DOWN],e)},nameFromCode:mt.invertObject(Bt),code:Bt},jt=function(){function t(e,t,n,o){this.sc=e,this.so=t,this.ec=n,this.eo=o,this.isOnEditable=this.makeIsOn(Ht.isEditable),this.isOnList=this.makeIsOn(Ht.isList),this.isOnAnchor=this.makeIsOn(Ht.isAnchor),this.isOnCell=this.makeIsOn(Ht.isCell),this.isOnData=this.makeIsOn(Ht.isData)}return t.prototype.nativeRange=function(){if(xt.isW3CRangeSupport){var e=document.createRange();return e.setStart(this.sc,this.so),e.setEnd(this.ec,this.eo),e}var t=ze({node:this.sc,offset:this.so});return t.setEndPoint("EndToEnd",ze({node:this.ec,offset:this.eo})),t},t.prototype.getPoints=function(){return{sc:this.sc,so:this.so,ec:this.ec,eo:this.eo}},t.prototype.getStartPoint=function(){return{node:this.sc,offset:this.so}},t.prototype.getEndPoint=function(){return{node:this.ec,offset:this.eo}},t.prototype.select=function(){var e=this.nativeRange();if(xt.isW3CRangeSupport){var t=document.getSelection();t.rangeCount>0&&t.removeAllRanges(),t.addRange(e)}else e.select();return this},t.prototype.scrollIntoView=function(t){var n=e(t).height();return t.scrollTop+n<this.sc.offsetTop&&(t.scrollTop+=Math.abs(t.scrollTop+n-this.sc.offsetTop)),this},t.prototype.normalize=function(){var e=function(e,t){if(Ht.isVisiblePoint(e)&&!Ht.isEdgePoint(e)||Ht.isVisiblePoint(e)&&Ht.isRightEdgePoint(e)&&!t||Ht.isVisiblePoint(e)&&Ht.isLeftEdgePoint(e)&&t||Ht.isVisiblePoint(e)&&Ht.isBlock(e.node)&&Ht.isEmpty(e.node))return e;var n=Ht.ancestor(e.node,Ht.isBlock);if((Ht.isLeftEdgePointOf(e,n)||Ht.isVoid(Ht.prevPoint(e).node))&&!t||(Ht.isRightEdgePointOf(e,n)||Ht.isVoid(Ht.nextPoint(e).node))&&t){if(Ht.isVisiblePoint(e))return e;t=!t}return(t?Ht.nextPointUntil(Ht.nextPoint(e),Ht.isVisiblePoint):Ht.prevPointUntil(Ht.prevPoint(e),Ht.isVisiblePoint))||e},n=e(this.getEndPoint(),!1),o=this.isCollapsed()?n:e(this.getStartPoint(),!0);return new t(o.node,o.offset,n.node,n.offset)},t.prototype.nodes=function(e,t){e=e||mt.ok;var n=t&&t.includeAncestor,o=t&&t.fullyContains,i=this.getStartPoint(),r=this.getEndPoint(),s=[],a=[];return Ht.walkPoint(i,r,function(t){if(!Ht.isEditable(t.node)){var i;o?(Ht.isLeftEdgePoint(t)&&a.push(t.node),Ht.isRightEdgePoint(t)&&gt.contains(a,t.node)&&(i=t.node)):i=n?Ht.ancestor(t.node,e):t.node,i&&e(i)&&s.push(i)}},!0),gt.unique(s)},t.prototype.commonAncestor=function(){return Ht.commonAncestor(this.sc,this.ec)},t.prototype.expand=function(e){var n=Ht.ancestor(this.sc,e),o=Ht.ancestor(this.ec,e);if(!n&&!o)return new t(this.sc,this.so,this.ec,this.eo);var i=this.getPoints();return n&&(i.sc=n,i.so=0),o&&(i.ec=o,i.eo=Ht.nodeLength(o)),new t(i.sc,i.so,i.ec,i.eo)},t.prototype.collapse=function(e){return e?new t(this.sc,this.so,this.sc,this.so):new t(this.ec,this.eo,this.ec,this.eo)},t.prototype.splitText=function(){var e=this.sc===this.ec,n=this.getPoints();return Ht.isText(this.ec)&&!Ht.isEdgePoint(this.getEndPoint())&&this.ec.splitText(this.eo),Ht.isText(this.sc)&&!Ht.isEdgePoint(this.getStartPoint())&&(n.sc=this.sc.splitText(this.so),n.so=0,e&&(n.ec=n.sc,n.eo=this.eo-this.so)),new t(n.sc,n.so,n.ec,n.eo)},t.prototype.deleteContents=function(){if(this.isCollapsed())return this;var n=this.splitText(),o=n.nodes(null,{fullyContains:!0}),i=Ht.prevPointUntil(n.getStartPoint(),function(e){return!gt.contains(o,e.node)}),r=[];return e.each(o,function(e,t){var n=t.parentNode;i.node!==n&&1===Ht.nodeLength(n)&&r.push(n),Ht.remove(t,!1)}),e.each(r,function(e,t){Ht.remove(t,!1)}),new t(i.node,i.offset,i.node,i.offset).normalize()},t.prototype.makeIsOn=function(e){return function(){var t=Ht.ancestor(this.sc,e);return!!t&&t===Ht.ancestor(this.ec,e)}},t.prototype.isLeftEdgeOf=function(e){if(!Ht.isLeftEdgePoint(this.getStartPoint()))return!1;var t=Ht.ancestor(this.sc,e);return t&&Ht.isLeftEdgeOf(this.sc,t)},t.prototype.isCollapsed=function(){return this.sc===this.ec&&this.so===this.eo},t.prototype.wrapBodyInlineWithPara=function(){if(Ht.isBodyContainer(this.sc)&&Ht.isEmpty(this.sc))return this.sc.innerHTML=Ht.emptyPara,new t(this.sc.firstChild,0,this.sc.firstChild,0);var e=this.normalize();if(Ht.isParaInline(this.sc)||Ht.isPara(this.sc))return e;var n;if(Ht.isInline(e.sc)){var o=Ht.listAncestor(e.sc,mt.not(Ht.isInline));n=gt.last(o),Ht.isInline(n)||(n=o[o.length-2]||e.sc.childNodes[e.so])}else n=e.sc.childNodes[e.so>0?e.so-1:0];var i=Ht.listPrev(n,Ht.isParaInline).reverse();if(i=i.concat(Ht.listNext(n.nextSibling,Ht.isParaInline)),i.length){var r=Ht.wrap(gt.head(i),"p");Ht.appendChildNodes(r,gt.tail(i))}return this.normalize()},t.prototype.insertNode=function(e){var t=this.wrapBodyInlineWithPara().deleteContents(),n=Ht.splitPoint(t.getStartPoint(),Ht.isInline(e));return n.rightNode?n.rightNode.parentNode.insertBefore(e,n.rightNode):n.container.appendChild(e),e},t.prototype.pasteHTML=function(t){var n=e("<div></div>").html(t)[0],o=gt.from(n.childNodes),i=this.wrapBodyInlineWithPara().deleteContents();return o.reverse().map(function(e){return i.insertNode(e)}).reverse()},t.prototype.toString=function(){var e=this.nativeRange();return xt.isW3CRangeSupport?e.toString():e.text},t.prototype.getWordRange=function(e){var n=this.getEndPoint();if(!Ht.isCharPoint(n))return this;var o=Ht.prevPointUntil(n,function(e){return!Ht.isCharPoint(e)});return e&&(n=Ht.nextPointUntil(n,function(e){return!Ht.isCharPoint(e)})),new t(o.node,o.offset,n.node,n.offset)},t.prototype.bookmark=function(e){return{s:{path:Ht.makeOffsetPath(e,this.sc),offset:this.so},e:{path:Ht.makeOffsetPath(e,this.ec),offset:this.eo}}},t.prototype.paraBookmark=function(e){return{s:{path:gt.tail(Ht.makeOffsetPath(gt.head(e),this.sc)),offset:this.so},e:{path:gt.tail(Ht.makeOffsetPath(gt.last(e),this.ec)),offset:this.eo}}},t.prototype.getClientRects=function(){return this.nativeRange().getClientRects()},t}(),Ut={create:function(e,t,n,o){if(4===arguments.length)return new jt(e,t,n,o);if(2===arguments.length)return n=e,o=t,new jt(e,t,n,o);var i=this.createFromSelection();return i||1!==arguments.length?i:(i=this.createFromNode(arguments[0]),i.collapse(Ht.emptyPara===arguments[0].innerHTML))},createFromSelection:function(){var e,t,n,o;if(xt.isW3CRangeSupport){var i=document.getSelection();if(!i||0===i.rangeCount)return null;if(Ht.isBody(i.anchorNode))return null;var r=i.getRangeAt(0);e=r.startContainer,t=r.startOffset,n=r.endContainer,o=r.endOffset}else{var s=document.selection.createRange(),a=s.duplicate();a.collapse(!1);var l=s;l.collapse(!0);var c=qe(l,!0),u=qe(a,!1);Ht.isText(c.node)&&Ht.isLeftEdgePoint(c)&&Ht.isTextNode(u.node)&&Ht.isRightEdgePoint(u)&&u.node.nextSibling===c.node&&(c=u),e=c.cont,t=c.offset,n=u.cont,o=u.offset}return new jt(e,t,n,o)},createFromNode:function(e){var t=e,n=0,o=e,i=Ht.nodeLength(o);return Ht.isVoid(t)&&(n=Ht.listPrev(t).length-1,t=t.parentNode),Ht.isBR(o)?(i=Ht.listPrev(o).length-1,o=o.parentNode):Ht.isVoid(o)&&(i=Ht.listPrev(o).length,o=o.parentNode),this.create(t,n,o,i)},createFromNodeBefore:function(e){return this.createFromNode(e).collapse(!0)},createFromNodeAfter:function(e){return this.createFromNode(e).collapse()},createFromBookmark:function(e,t){var n=Ht.fromOffsetPath(e,t.s.path),o=t.s.offset,i=Ht.fromOffsetPath(e,t.e.path),r=t.e.offset;return new jt(n,o,i,r)},createFromParaBookmark:function(e,t){var n=e.s.offset,o=e.e.offset,i=Ht.fromOffsetPath(gt.head(t),e.s.path),r=Ht.fromOffsetPath(gt.last(t),e.e.path);return new jt(i,n,r,o)}},qt=function(){function e(e){this.stack=[],this.stackOffset=-1,this.$editable=e,this.editable=e[0]}return e.prototype.makeSnapshot=function(){var e=Ut.create(this.editable),t={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:this.$editable.html(),bookmark:e?e.bookmark(this.editable):t}},e.prototype.applySnapshot=function(e){null!==e.contents&&this.$editable.html(e.contents),null!==e.bookmark&&Ut.createFromBookmark(this.editable,e.bookmark).select()},e.prototype.rewind=function(){this.$editable.html()!==this.stack[this.stackOffset].contents&&this.recordUndo(),this.stackOffset=0,this.applySnapshot(this.stack[this.stackOffset])},e.prototype.reset=function(){this.stack=[],this.stackOffset=-1,this.$editable.html(""),this.recordUndo()},e.prototype.undo=function(){this.$editable.html()!==this.stack[this.stackOffset].contents&&this.recordUndo(),this.stackOffset>0&&(this.stackOffset--,this.applySnapshot(this.stack[this.stackOffset]))},e.prototype.redo=function(){this.stack.length-1>this.stackOffset&&(this.stackOffset++,this.applySnapshot(this.stack[this.stackOffset]))},e.prototype.recordUndo=function(){this.stackOffset++,this.stack.length>this.stackOffset&&(this.stack=this.stack.slice(0,this.stackOffset)),this.stack.push(this.makeSnapshot())},e}(),zt=function(){function t(){}return t.prototype.jQueryCSS=function(t,n){if(xt.jqueryVersion<1.9){var o={};return e.each(n,function(e,n){o[n]=t.css(n)}),o}return t.css(n)},t.prototype.fromNode=function(e){var t=["font-family","font-size","text-align","list-style-type","line-height"],n=this.jQueryCSS(e,t)||{};return n["font-size"]=parseInt(n["font-size"],10),n},t.prototype.stylePara=function(t,n){e.each(t.nodes(Ht.isPara,{includeAncestor:!0}),function(t,o){e(o).css(n)})},t.prototype.styleNodes=function(t,n){t=t.splitText();var o=n&&n.nodeName||"SPAN",i=!(!n||!n.expandClosestSibling),r=!(!n||!n.onlyPartialContains);if(t.isCollapsed())return[t.insertNode(Ht.create(o))];var s=Ht.makePredByNodeName(o),a=t.nodes(Ht.isText,{fullyContains:!0}).map(function(e){return Ht.singleChildAncestor(e,s)||Ht.wrap(e,o)});if(i){if(r){var l=t.nodes();s=mt.and(s,function(e){return gt.contains(l,e)})}return a.map(function(t){var n=Ht.withClosestSiblings(t,s),o=gt.head(n),i=gt.tail(n);return e.each(i,function(e,t){Ht.appendChildNodes(o,t.childNodes),Ht.remove(t)}),gt.head(n)})}return a},t.prototype.current=function(t){var n=e(Ht.isElement(t.sc)?t.sc:t.sc.parentNode),o=this.fromNode(n);try{o=e.extend(o,{"font-bold":document.queryCommandState("bold")?"bold":"normal","font-italic":document.queryCommandState("italic")?"italic":"normal","font-underline":document.queryCommandState("underline")?"underline":"normal","font-subscript":document.queryCommandState("subscript")?"subscript":"normal","font-superscript":document.queryCommandState("superscript")?"superscript":"normal","font-strikethrough":document.queryCommandState("strikethrough")?"strikethrough":"normal","font-family":document.queryCommandValue("fontname")||o["font-family"]})}catch(e){}if(t.isOnList()){var i=["circle","disc","disc-leading-zero","square"],r=e.inArray(o["list-style-type"],i)>-1;o["list-style"]=r?"unordered":"ordered"}else o["list-style"]="none";var s=Ht.ancestor(t.sc,Ht.isPara)
;if(s&&s.style["line-height"])o["line-height"]=s.style.lineHeight;else{var a=parseInt(o["line-height"],10)/parseInt(o["font-size"],10);o["line-height"]=a.toFixed(1)}return o.anchor=t.isOnAnchor()&&Ht.ancestor(t.sc,Ht.isAnchor),o.ancestors=Ht.listAncestor(t.sc,Ht.isEditable),o.range=t,o},t}(),Kt=function(){function t(){}return t.prototype.insertOrderedList=function(e){this.toggleList("OL",e)},t.prototype.insertUnorderedList=function(e){this.toggleList("UL",e)},t.prototype.indent=function(t){var n=this,o=Ut.create(t).wrapBodyInlineWithPara(),i=o.nodes(Ht.isPara,{includeAncestor:!0}),r=gt.clusterBy(i,mt.peq2("parentNode"));e.each(r,function(t,o){var i=gt.head(o);Ht.isLi(i)?n.wrapList(o,i.parentNode.nodeName):e.each(o,function(t,n){e(n).css("marginLeft",function(e,t){return(parseInt(t,10)||0)+25})})}),o.select()},t.prototype.outdent=function(t){var n=this,o=Ut.create(t).wrapBodyInlineWithPara(),i=o.nodes(Ht.isPara,{includeAncestor:!0}),r=gt.clusterBy(i,mt.peq2("parentNode"));e.each(r,function(t,o){var i=gt.head(o);Ht.isLi(i)?n.releaseList([o]):e.each(o,function(t,n){e(n).css("marginLeft",function(e,t){return t=parseInt(t,10)||0,t>25?t-25:""})})}),o.select()},t.prototype.toggleList=function(t,n){var o=this,i=Ut.create(n).wrapBodyInlineWithPara(),r=i.nodes(Ht.isPara,{includeAncestor:!0}),s=i.paraBookmark(r),a=gt.clusterBy(r,mt.peq2("parentNode"));if(gt.find(r,Ht.isPurePara)){var l=[];e.each(a,function(e,n){l=l.concat(o.wrapList(n,t))}),r=l}else{var c=i.nodes(Ht.isList,{includeAncestor:!0}).filter(function(n){return!e.nodeName(n,t)});c.length?e.each(c,function(e,n){Ht.replace(n,t)}):r=this.releaseList(a,!0)}Ut.createFromParaBookmark(s,r).select()},t.prototype.wrapList=function(e,t){var n=gt.head(e),o=gt.last(e),i=Ht.isList(n.previousSibling)&&n.previousSibling,r=Ht.isList(o.nextSibling)&&o.nextSibling,s=i||Ht.insertAfter(Ht.create(t||"UL"),o);return e=e.map(function(e){return Ht.isPurePara(e)?Ht.replace(e,"LI"):e}),Ht.appendChildNodes(s,e),r&&(Ht.appendChildNodes(s,gt.from(r.childNodes)),Ht.remove(r)),e},t.prototype.releaseList=function(t,n){var o=[];return e.each(t,function(t,i){var r=gt.head(i),s=gt.last(i),a=n?Ht.lastAncestor(r,Ht.isList):r.parentNode,l=a.childNodes.length>1?Ht.splitTree(a,{node:s.parentNode,offset:Ht.position(s)+1},{isSkipPaddingBlankHTML:!0}):null,c=Ht.splitTree(a,{node:r.parentNode,offset:Ht.position(r)},{isSkipPaddingBlankHTML:!0});i=n?Ht.listDescendant(c,Ht.isLi):gt.from(c.childNodes).filter(Ht.isLi),!n&&Ht.isList(a.parentNode)||(i=i.map(function(e){return Ht.replace(e,"P")})),e.each(gt.from(i).reverse(),function(e,t){Ht.insertAfter(t,a)});var u=gt.compact([a,c,l]);e.each(u,function(t,n){var o=[n].concat(Ht.listDescendant(n,Ht.isList));e.each(o.reverse(),function(e,t){Ht.nodeLength(t)||Ht.remove(t,!0)})}),o=o.concat(i)}),o},t}(),Wt=function(){function t(){this.bullet=new Kt}return t.prototype.insertTab=function(e,t){var n=Ht.createText(new Array(t+1).join(Ht.NBSP_CHAR));e=e.deleteContents(),e.insertNode(n,!0),e=Ut.create(n,t),e.select()},t.prototype.insertParagraph=function(t){var n=Ut.create(t);n=n.deleteContents(),n=n.wrapBodyInlineWithPara();var o,i=Ht.ancestor(n.sc,Ht.isPara);if(i){if(Ht.isEmpty(i)&&Ht.isLi(i))return void this.bullet.toggleList(i.parentNode.nodeName);if(Ht.isEmpty(i)&&Ht.isPara(i)&&Ht.isBlockquote(i.parentNode))Ht.insertAfter(i,i.parentNode),o=i;else{o=Ht.splitTree(i,n.getStartPoint());var r=Ht.listDescendant(i,Ht.isEmptyAnchor);r=r.concat(Ht.listDescendant(o,Ht.isEmptyAnchor)),e.each(r,function(e,t){Ht.remove(t)}),(Ht.isHeading(o)||Ht.isPre(o)||Ht.isCustomStyleTag(o))&&Ht.isEmpty(o)&&(o=Ht.replace(o,"p"))}}else{var s=n.sc.childNodes[n.so];o=e(Ht.emptyPara)[0],s?n.sc.insertBefore(o,s):n.sc.appendChild(o)}Ut.create(o,0).normalize().select().scrollIntoView(t)},t}(),Vt=function(e,t,n,o){function i(){return!e||!e.tagName||"td"!==e.tagName.toLowerCase()&&"th"!==e.tagName.toLowerCase()?void console.error("Impossible to identify start Cell point.",e):(f.colPos=e.cellIndex,e.parentElement&&e.parentElement.tagName&&"tr"===e.parentElement.tagName.toLowerCase()?void(f.rowPos=e.parentElement.rowIndex):void console.error("Impossible to identify start Row point.",e))}function r(e,t,n,o,i,r,s){var a={baseRow:n,baseCell:o,isRowSpan:i,isColSpan:r,isVirtual:s};m[e]||(m[e]=[]),m[e][t]=a}function s(e,t,n,o){return{baseCell:e.baseCell,action:t,virtualTable:{rowIndex:n,cellIndex:o}}}function a(e,t){if(!m[e])return t;if(!m[e][t])return t;for(var n=t;m[e][n];)if(n++,!m[e][n])return n}function l(e,t){var n=a(e.rowIndex,t.cellIndex),o=t.colSpan>1,i=t.rowSpan>1,s=e.rowIndex===f.rowPos&&t.cellIndex===f.colPos;r(e.rowIndex,n,e,t,i,o,!1);var l=t.attributes.rowSpan?parseInt(t.attributes.rowSpan.value,10):0;if(l>1)for(var u=1;u<l;u++){var d=e.rowIndex+u;c(d,n,t,s),r(d,n,e,t,!0,o,!0)}var h=t.attributes.colSpan?parseInt(t.attributes.colSpan.value,10):0;if(h>1)for(var p=1;p<h;p++){var m=a(e.rowIndex,n+p);c(e.rowIndex,m,t,s),r(e.rowIndex,m,e,t,i,!0,!0)}}function c(e,t,n,o){e===f.rowPos&&f.colPos>=n.cellIndex&&n.cellIndex<=t&&!o&&f.colPos++}function u(){for(var e=o.rows,t=0;t<e.length;t++)for(var n=e[t].cells,i=0;i<n.length;i++)l(e[t],n[i])}function d(e){switch(t){case Vt.where.Column:if(e.isColSpan)return Vt.resultAction.SubtractSpanCount;break;case Vt.where.Row:if(!e.isVirtual&&e.isRowSpan)return Vt.resultAction.AddCell;if(e.isRowSpan)return Vt.resultAction.SubtractSpanCount}return Vt.resultAction.RemoveCell}function h(e){switch(t){case Vt.where.Column:if(e.isColSpan)return Vt.resultAction.SumSpanCount;if(e.isRowSpan&&e.isVirtual)return Vt.resultAction.Ignore;break;case Vt.where.Row:if(e.isRowSpan)return Vt.resultAction.SumSpanCount;if(e.isColSpan&&e.isVirtual)return Vt.resultAction.Ignore}return Vt.resultAction.AddCell}function p(){i(),u()}var f={colPos:0,rowPos:0},m=[],g=[];this.getActionList=function(){for(var e=t===Vt.where.Row?f.rowPos:-1,o=t===Vt.where.Column?f.colPos:-1,i=0,r=!0;r;){var a=e>=0?e:i,l=o>=0?o:i,c=m[a];if(!c)return r=!1,g;var u=c[l];if(!u)return r=!1,g;var p=Vt.resultAction.Ignore;switch(n){case Vt.requestAction.Add:p=h(u);break;case Vt.requestAction.Delete:p=d(u)}g.push(s(u,p,a,l)),i++}return g},p()};Vt.where={Row:0,Column:1},Vt.requestAction={Add:0,Delete:1},Vt.resultAction={Ignore:0,SubtractSpanCount:1,RemoveCell:2,AddCell:3,SumSpanCount:4};var Gt,Yt=function(){function t(){}return t.prototype.tab=function(e,t){var n=Ht.ancestor(e.commonAncestor(),Ht.isCell),o=Ht.ancestor(n,Ht.isTable),i=Ht.listDescendant(o,Ht.isCell),r=gt[t?"prev":"next"](i,n);r&&Ut.create(r,0).select()},t.prototype.addRow=function(t,n){for(var o=Ht.ancestor(t.commonAncestor(),Ht.isCell),i=e(o).closest("tr"),r=this.recoverAttributes(i),s=e("<tr"+r+"></tr>"),a=new Vt(o,Vt.where.Row,Vt.requestAction.Add,e(i).closest("table")[0]),l=a.getActionList(),c=0;c<l.length;c++){var u=l[c],d=this.recoverAttributes(u.baseCell);switch(u.action){case Vt.resultAction.AddCell:s.append("<td"+d+">"+Ht.blank+"</td>");break;case Vt.resultAction.SumSpanCount:if("top"===n){if((u.baseCell.parent?u.baseCell.closest("tr").rowIndex:0)<=i[0].rowIndex){var h=e("<div></div>").append(e("<td"+d+">"+Ht.blank+"</td>").removeAttr("rowspan")).html();s.append(h);break}}var p=parseInt(u.baseCell.rowSpan,10);p++,u.baseCell.setAttribute("rowSpan",p)}}if("top"===n)i.before(s);else{if(o.rowSpan>1){var f=i[0].rowIndex+(o.rowSpan-2);return void e(e(i).parent().find("tr")[f]).after(e(s))}i.after(s)}},t.prototype.addCol=function(t,n){var o=Ht.ancestor(t.commonAncestor(),Ht.isCell),i=e(o).closest("tr");e(i).siblings().push(i);for(var r=new Vt(o,Vt.where.Column,Vt.requestAction.Add,e(i).closest("table")[0]),s=r.getActionList(),a=0;a<s.length;a++){var l=s[a],c=this.recoverAttributes(l.baseCell);switch(l.action){case Vt.resultAction.AddCell:"right"===n?e(l.baseCell).after("<td"+c+">"+Ht.blank+"</td>"):e(l.baseCell).before("<td"+c+">"+Ht.blank+"</td>");break;case Vt.resultAction.SumSpanCount:if("right"===n){var u=parseInt(l.baseCell.colSpan,10);u++,l.baseCell.setAttribute("colSpan",u)}else e(l.baseCell).before("<td"+c+">"+Ht.blank+"</td>")}}},t.prototype.recoverAttributes=function(e){var t="";if(!e)return t;for(var n=e.attributes||[],o=0;o<n.length;o++)"id"!==n[o].name.toLowerCase()&&n[o].specified&&(t+=" "+n[o].name+"='"+n[o].value+"'");return t},t.prototype.deleteRow=function(t){for(var n=Ht.ancestor(t.commonAncestor(),Ht.isCell),o=e(n).closest("tr"),i=o.children("td, th").index(e(n)),r=o[0].rowIndex,s=new Vt(n,Vt.where.Row,Vt.requestAction.Delete,e(o).closest("table")[0]),a=s.getActionList(),l=0;l<a.length;l++)if(a[l]){var c=a[l].baseCell,u=a[l].virtualTable,d=c.rowSpan&&c.rowSpan>1,h=d?parseInt(c.rowSpan,10):0;switch(a[l].action){case Vt.resultAction.Ignore:continue;case Vt.resultAction.AddCell:var p=o.next("tr")[0];if(!p)continue;var f=o[0].cells[i];d&&(h>2?(h--,p.insertBefore(f,p.cells[i]),p.cells[i].setAttribute("rowSpan",h),p.cells[i].innerHTML=""):2===h&&(p.insertBefore(f,p.cells[i]),p.cells[i].removeAttribute("rowSpan"),p.cells[i].innerHTML=""));continue;case Vt.resultAction.SubtractSpanCount:d&&(h>2?(h--,c.setAttribute("rowSpan",h),u.rowIndex!==r&&c.cellIndex===i&&(c.innerHTML="")):2===h&&(c.removeAttribute("rowSpan"),u.rowIndex!==r&&c.cellIndex===i&&(c.innerHTML="")));continue;case Vt.resultAction.RemoveCell:continue}}o.remove()},t.prototype.deleteCol=function(t){for(var n=Ht.ancestor(t.commonAncestor(),Ht.isCell),o=e(n).closest("tr"),i=o.children("td, th").index(e(n)),r=new Vt(n,Vt.where.Column,Vt.requestAction.Delete,e(o).closest("table")[0]),s=r.getActionList(),a=0;a<s.length;a++)if(s[a])switch(s[a].action){case Vt.resultAction.Ignore:continue;case Vt.resultAction.SubtractSpanCount:var l=s[a].baseCell,c=l.colSpan&&l.colSpan>1;if(c){var u=l.colSpan?parseInt(l.colSpan,10):0;u>2?(u--,l.setAttribute("colSpan",u),l.cellIndex===i&&(l.innerHTML="")):2===u&&(l.removeAttribute("colSpan"),l.cellIndex===i&&(l.innerHTML=""))}continue;case Vt.resultAction.RemoveCell:Ht.remove(s[a].baseCell,!0);continue}},t.prototype.createTable=function(t,n,o){for(var i,r=[],s=0;s<t;s++)r.push("<td>"+Ht.blank+"</td>");i=r.join("");for(var a,l=[],c=0;c<n;c++)l.push("<tr>"+i+"</tr>");a=l.join("");var u=e("<table>"+a+"</table>");return o&&o.tableClassName&&u.addClass(o.tableClassName),u[0]},t.prototype.deleteTable=function(t){var n=Ht.ancestor(t.commonAncestor(),Ht.isCell);e(n).closest("table").remove()},t}(),Qt="bogus",Jt=function(){function t(t){var n=this;this.context=t,this.$note=t.layoutInfo.note,this.$editor=t.layoutInfo.editor,this.$editable=t.layoutInfo.editable,this.options=t.options,this.lang=this.options.langInfo,this.editable=this.$editable[0],this.lastRange=null,this.style=new zt,this.table=new Yt,this.typing=new Wt,this.bullet=new Kt,this.history=new qt(this.$editable),this.context.memo("help.undo",this.lang.help.undo),this.context.memo("help.redo",this.lang.help.redo),this.context.memo("help.tab",this.lang.help.tab),this.context.memo("help.untab",this.lang.help.untab),this.context.memo("help.insertParagraph",this.lang.help.insertParagraph),this.context.memo("help.insertOrderedList",this.lang.help.insertOrderedList),this.context.memo("help.insertUnorderedList",this.lang.help.insertUnorderedList),this.context.memo("help.indent",this.lang.help.indent),this.context.memo("help.outdent",this.lang.help.outdent),this.context.memo("help.formatPara",this.lang.help.formatPara),this.context.memo("help.insertHorizontalRule",this.lang.help.insertHorizontalRule),this.context.memo("help.fontName",this.lang.help.fontName);for(var o=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor"],i=0,r=o.length;i<r;i++)this[o[i]]=function(e){return function(t){n.beforeCommand(),document.execCommand(e,!1,t),n.afterCommand(!0)}}(o[i]),this.context.memo("help."+o[i],this.lang.help[o[i]]);this.fontName=this.wrapCommand(function(e){return n.fontStyling("font-family","'"+e+"'")}),this.fontSize=this.wrapCommand(function(e){return n.fontStyling("font-size",e+"px")});for(var i=1;i<=6;i++)this["formatH"+i]=function(e){return function(){n.formatBlock("H"+e)}}(i),this.context.memo("help.formatH"+i,this.lang.help["formatH"+i]);this.insertParagraph=this.wrapCommand(function(){n.typing.insertParagraph(n.editable)}),this.insertOrderedList=this.wrapCommand(function(){n.bullet.insertOrderedList(n.editable)}),this.insertUnorderedList=this.wrapCommand(function(){n.bullet.insertUnorderedList(n.editable)}),this.indent=this.wrapCommand(function(){n.bullet.indent(n.editable)}),this.outdent=this.wrapCommand(function(){n.bullet.outdent(n.editable)}),this.insertNode=this.wrapCommand(function(t){if(!n.isLimited(e(t).text().length)){n.createRange().insertNode(t),Ut.createFromNodeAfter(t).select()}}),this.insertText=this.wrapCommand(function(e){if(!n.isLimited(e.length)){var t=n.createRange(),o=t.insertNode(Ht.createText(e));Ut.create(o,Ht.nodeLength(o)).select()}}),this.pasteHTML=this.wrapCommand(function(e){if(!n.isLimited(e.length)){var t=n.createRange().pasteHTML(e);Ut.createFromNodeAfter(gt.last(t)).select()}}),this.formatBlock=this.wrapCommand(function(e,t){var o=n.options.callbacks.onApplyCustomStyle;o?o.call(n,t,n.context,n.onFormatBlock):n.onFormatBlock(e,t)}),this.insertHorizontalRule=this.wrapCommand(function(){var e=n.createRange().insertNode(Ht.create("HR"));e.nextSibling&&Ut.create(e.nextSibling,0).normalize().select()}),this.lineHeight=this.wrapCommand(function(e){n.style.stylePara(n.createRange(),{lineHeight:e})}),this.createLink=this.wrapCommand(function(t){var o=t.url,i=t.text,r=t.isNewWindow,s=t.range||n.createRange(),a=s.toString()!==i;"string"==typeof o&&(o=o.trim()),o=n.options.onCreateLink?n.options.onCreateLink(o):/^[A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?/.test(o)?o:"http://"+o;var l=[];if(a){s=s.deleteContents();var c=s.insertNode(e("<A>"+i+"</A>")[0]);l.push(c)}else l=n.style.styleNodes(s,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});e.each(l,function(t,n){e(n).attr("href",o),r?e(n).attr("target","_blank"):e(n).removeAttr("target")});var u=Ut.createFromNodeBefore(gt.head(l)),d=u.getStartPoint(),h=Ut.createFromNodeAfter(gt.last(l)),p=h.getEndPoint();Ut.create(d.node,d.offset,p.node,p.offset).select()}),this.color=this.wrapCommand(function(e){var t=e.foreColor,n=e.backColor;t&&document.execCommand("foreColor",!1,t),n&&document.execCommand("backColor",!1,n)}),this.foreColor=this.wrapCommand(function(e){document.execCommand("styleWithCSS",!1,!0),document.execCommand("foreColor",!1,e)}),this.insertTable=this.wrapCommand(function(e){var t=e.split("x");n.createRange().deleteContents().insertNode(n.table.createTable(t[0],t[1],n.options))}),this.removeMedia=this.wrapCommand(function(){var t=e(n.restoreTarget()).parent();t.parent("figure").length?t.parent("figure").remove():t=e(n.restoreTarget()).detach(),n.context.triggerEvent("media.delete",t,n.$editable)}),this.floatMe=this.wrapCommand(function(t){var o=e(n.restoreTarget());o.toggleClass("note-float-left","left"===t),o.toggleClass("note-float-right","right"===t),o.css("float",t)}),this.resize=this.wrapCommand(function(t){e(n.restoreTarget()).css({width:100*t+"%",height:""})})}return t.prototype.initialize=function(){var e=this;this.$editable.on("keydown",function(t){if(t.keyCode===Ft.code.ENTER&&e.context.triggerEvent("enter",t),e.context.triggerEvent("keydown",t),t.isDefaultPrevented()||(e.options.shortcuts?e.handleKeyMap(t):e.preventDefaultEditableShortCuts(t)),e.isLimited(1,t))return!1}).on("keyup",function(t){e.context.triggerEvent("keyup",t)}).on("focus",function(t){e.context.triggerEvent("focus",t)}).on("blur",function(t){e.context.triggerEvent("blur",t)}).on("mousedown",function(t){e.context.triggerEvent("mousedown",t)}).on("mouseup",function(t){e.context.triggerEvent("mouseup",t)}).on("scroll",function(t){e.context.triggerEvent("scroll",t)}).on("paste",function(t){e.context.triggerEvent("paste",t)}),this.$editable.html(Ht.html(this.$note)||Ht.emptyPara),this.$editable.on(xt.inputEventName,mt.debounce(function(){e.context.triggerEvent("change",e.$editable.html())},100)),this.$editor.on("focusin",function(t){e.context.triggerEvent("focusin",t)}).on("focusout",function(t){e.context.triggerEvent("focusout",t)}),this.options.airMode||(this.options.width&&this.$editor.outerWidth(this.options.width),this.options.height&&this.$editable.outerHeight(this.options.height),this.options.maxHeight&&this.$editable.css("max-height",this.options.maxHeight),this.options.minHeight&&this.$editable.css("min-height",this.options.minHeight)),this.history.recordUndo()},t.prototype.destroy=function(){this.$editable.off()},t.prototype.handleKeyMap=function(e){var t=this.options.keyMap[xt.isMac?"mac":"pc"],n=[];e.metaKey&&n.push("CMD"),e.ctrlKey&&!e.altKey&&n.push("CTRL"),e.shiftKey&&n.push("SHIFT");var o=Ft.nameFromCode[e.keyCode];o&&n.push(o);var i=t[n.join("+")];i?!1!==this.context.invoke(i)&&e.preventDefault():Ft.isEdit(e.keyCode)&&this.afterCommand()},t.prototype.preventDefaultEditableShortCuts=function(e){(e.ctrlKey||e.metaKey)&&gt.contains([66,73,85],e.keyCode)&&e.preventDefault()},t.prototype.isLimited=function(e,t){return e=e||0,(void 0===t||!(Ft.isMove(t.keyCode)||t.ctrlKey||t.metaKey||gt.contains([Ft.code.BACKSPACE,Ft.code.DELETE],t.keyCode)))&&(this.options.maxTextLength>0&&this.$editable.text().length+e>=this.options.maxTextLength)},t.prototype.createRange=function(){return this.focus(),Ut.create(this.editable)},t.prototype.saveRange=function(e){this.lastRange=this.createRange(),e&&this.lastRange.collapse().select()},t.prototype.restoreRange=function(){this.lastRange&&(this.lastRange.select(),this.focus())},t.prototype.saveTarget=function(e){this.$editable.data("target",e)},t.prototype.clearTarget=function(){this.$editable.removeData("target")},t.prototype.restoreTarget=function(){return this.$editable.data("target")},t.prototype.currentStyle=function(){var e=Ut.create();return e&&(e=e.normalize()),e?this.style.current(e):this.style.fromNode(this.$editable)},t.prototype.styleFromNode=function(e){return this.style.fromNode(e)},t.prototype.undo=function(){this.context.triggerEvent("before.command",this.$editable.html()),this.history.undo(),this.context.triggerEvent("change",this.$editable.html())},t.prototype.redo=function(){this.context.triggerEvent("before.command",this.$editable.html()),this.history.redo(),this.context.triggerEvent("change",this.$editable.html())},t.prototype.beforeCommand=function(){this.context.triggerEvent("before.command",this.$editable.html()),this.focus()},t.prototype.afterCommand=function(e){this.history.recordUndo(),e||this.context.triggerEvent("change",this.$editable.html())},t.prototype.tab=function(){var e=this.createRange();if(e.isCollapsed()&&e.isOnCell())this.table.tab(e);else{if(0===this.options.tabSize)return!1;this.isLimited(this.options.tabSize)||(this.beforeCommand(),this.typing.insertTab(e,this.options.tabSize),this.afterCommand())}},t.prototype.untab=function(){var e=this.createRange();if(e.isCollapsed()&&e.isOnCell())this.table.tab(e,!0);else if(0===this.options.tabSize)return!1},t.prototype.wrapCommand=function(e){var t=this;return function(){t.beforeCommand(),e.apply(t,arguments),t.afterCommand()}},t.prototype.insertImage=function(e,t){var n=this;return We(e,t).then(function(e){n.beforeCommand(),"function"==typeof t?t(e):("string"==typeof t&&e.attr("data-filename",t),e.css("width",Math.min(n.$editable.width(),e.width()))),e.show(),Ut.create(n.editable).insertNode(e[0]),Ut.createFromNodeAfter(e[0]).select(),n.afterCommand()}).fail(function(e){n.context.triggerEvent("image.upload.error",e)})},t.prototype.insertImages=function(t){var n=this;e.each(t,function(e,t){var o=t.name;n.options.maximumImageFileSize&&n.options.maximumImageFileSize<t.size?n.context.triggerEvent("image.upload.error",n.lang.image.maximumFileSizeError):Ke(t).then(function(e){return n.insertImage(e,o)}).fail(function(){n.context.triggerEvent("image.upload.error")})})},t.prototype.insertImagesOrCallback=function(e){this.options.callbacks.onImageUpload?this.context.triggerEvent("image.upload",e):this.insertImages(e)},t.prototype.getSelectedText=function(){var e=this.createRange();return e.isOnAnchor()&&(e=Ut.createFromNode(Ht.ancestor(e.sc,Ht.isAnchor))),e.toString()},t.prototype.onFormatBlock=function(t,n){if(t=xt.isMSIE?"<"+t+">":t,document.execCommand("FormatBlock",!1,t),n&&n.length){var o=n[0].className||"";if(o){var i=this.createRange();e([i.sc,i.ec]).closest(t).addClass(o)}}},t.prototype.formatPara=function(){this.formatBlock("P")},t.prototype.fontStyling=function(t,n){var o=this.createRange();if(o){var i=this.style.styleNodes(o);if(e(i).css(t,n),o.isCollapsed()){var r=gt.head(i);r&&!Ht.nodeLength(r)&&(r.innerHTML=Ht.ZERO_WIDTH_NBSP_CHAR,Ut.createFromNodeAfter(r.firstChild).select(),this.$editable.data(Qt,r))}}},t.prototype.unlink=function(){var e=this.createRange();if(e.isOnAnchor()){var t=Ht.ancestor(e.sc,Ht.isAnchor);e=Ut.createFromNode(t),e.select(),this.beforeCommand(),document.execCommand("unlink"),this.afterCommand()}},t.prototype.getLinkInfo=function(){var t=this.createRange().expand(Ht.isAnchor),n=e(gt.head(t.nodes(Ht.isAnchor))),o={range:t,text:t.toString(),url:n.length?n.attr("href"):""};return n.length&&(o.isNewWindow="_blank"===n.attr("target")),o},t.prototype.addRow=function(e){var t=this.createRange(this.$editable);t.isCollapsed()&&t.isOnCell()&&(this.beforeCommand(),this.table.addRow(t,e),this.afterCommand())},t.prototype.addCol=function(e){var t=this.createRange(this.$editable);t.isCollapsed()&&t.isOnCell()&&(this.beforeCommand(),this.table.addCol(t,e),this.afterCommand())},t.prototype.deleteRow=function(){var e=this.createRange(this.$editable);e.isCollapsed()&&e.isOnCell()&&(this.beforeCommand(),this.table.deleteRow(e),this.afterCommand())},t.prototype.deleteCol=function(){var e=this.createRange(this.$editable);e.isCollapsed()&&e.isOnCell()&&(this.beforeCommand(),this.table.deleteCol(e),this.afterCommand())},t.prototype.deleteTable=function(){var e=this.createRange(this.$editable);e.isCollapsed()&&e.isOnCell()&&(this.beforeCommand(),this.table.deleteTable(e),this.afterCommand())},t.prototype.resizeTo=function(e,t,n){var o;if(n){var i=e.y/e.x,r=t.data("ratio");o={width:r>i?e.x:e.y/r,height:r>i?e.x*r:e.y}}else o={width:e.x,height:e.y};t.css(o)},t.prototype.hasFocus=function(){return this.$editable.is(":focus")},t.prototype.focus=function(){this.hasFocus()||this.$editable.focus()},t.prototype.isEmpty=function(){return Ht.isEmpty(this.$editable[0])||Ht.emptyPara===this.$editable.html()},t.prototype.empty=function(){this.context.invoke("code",Ht.emptyPara)},t}(),Xt=function(){function e(e){this.context=e,this.$editable=e.layoutInfo.editable}return e.prototype.initialize=function(){this.$editable.on("paste",this.pasteByEvent.bind(this))},e.prototype.pasteByEvent=function(e){var t=e.originalEvent.clipboardData;if(t&&t.items&&t.items.length){var n=gt.head(t.items);"file"===n.kind&&-1!==n.type.indexOf("image/")&&this.context.invoke("editor.insertImagesOrCallback",[n.getAsFile()]),this.context.invoke("editor.afterCommand")}},e}(),Zt=function(){function t(t){this.context=t,this.$eventListener=e(document),this.$editor=t.layoutInfo.editor,this.$editable=t.layoutInfo.editable,this.options=t.options,this.lang=this.options.langInfo,this.documentEventHandlers={},this.$dropzone=e(['<div class="note-dropzone">','  <div class="note-dropzone-message"/>',"</div>"].join("")).prependTo(this.$editor)}return t.prototype.initialize=function(){this.options.disableDragAndDrop?(this.documentEventHandlers.onDrop=function(e){e.preventDefault()},this.$eventListener=this.$dropzone,this.$eventListener.on("drop",this.documentEventHandlers.onDrop)):this.attachDragAndDropEvent()},t.prototype.attachDragAndDropEvent=function(){var t=this,n=e(),o=this.$dropzone.find(".note-dropzone-message");this.documentEventHandlers.onDragenter=function(e){var i=t.context.invoke("codeview.isActivated"),r=t.$editor.width()>0&&t.$editor.height()>0;i||n.length||!r||(t.$editor.addClass("dragover"),t.$dropzone.width(t.$editor.width()),t.$dropzone.height(t.$editor.height()),o.text(t.lang.image.dragImageHere)),n=n.add(e.target)},this.documentEventHandlers.onDragleave=function(e){n=n.not(e.target),n.length||t.$editor.removeClass("dragover")},this.documentEventHandlers.onDrop=function(){n=e(),t.$editor.removeClass("dragover")},this.$eventListener.on("dragenter",this.documentEventHandlers.onDragenter).on("dragleave",this.documentEventHandlers.onDragleave).on("drop",this.documentEventHandlers.onDrop),this.$dropzone.on("dragenter",function(){t.$dropzone.addClass("hover"),o.text(t.lang.image.dropImage)}).on("dragleave",function(){t.$dropzone.removeClass("hover"),o.text(t.lang.image.dragImageHere)}),this.$dropzone.on("drop",function(n){var o=n.originalEvent.dataTransfer;n.preventDefault(),o&&o.files&&o.files.length?(t.$editable.focus(),t.context.invoke("editor.insertImagesOrCallback",o.files)):e.each(o.types,function(n,i){var r=o.getData(i);i.toLowerCase().indexOf("text")>-1?t.context.invoke("editor.pasteHTML",r):e(r).each(function(e,n){t.context.invoke("editor.insertNode",n)})})}).on("dragover",!1)},t.prototype.destroy=function(){var e=this;Object.keys(this.documentEventHandlers).forEach(function(t){e.$eventListener.off(t.substr(2).toLowerCase(),e.documentEventHandlers[t])}),this.documentEventHandlers={}},t}();xt.hasCodeMirror&&(xt.isSupportAmd?require(["codemirror"],function(e){Gt=e}):Gt=window.CodeMirror);var en=function(){function e(e){this.context=e,this.$editor=e.layoutInfo.editor,this.$editable=e.layoutInfo.editable,this.$codable=e.layoutInfo.codable,this.options=e.options}return e.prototype.sync=function(){this.isActivated()&&xt.hasCodeMirror&&this.$codable.data("cmEditor").save()},e.prototype.isActivated=function(){return this.$editor.hasClass("codeview")},e.prototype.toggle=function(){this.isActivated()?this.deactivate():this.activate(),this.context.triggerEvent("codeview.toggled")},e.prototype.activate=function(){var e=this;if(this.$codable.val(Ht.html(this.$editable,this.options.prettifyHtml)),this.$codable.height(this.$editable.height()),this.context.invoke("toolbar.updateCodeview",!0),this.$editor.addClass("codeview"),this.$codable.focus(),xt.hasCodeMirror){var t=Gt.fromTextArea(this.$codable[0],this.options.codemirror);if(this.options.codemirror.tern){var n=new Gt.TernServer(this.options.codemirror.tern);t.ternServer=n,t.on("cursorActivity",function(e){n.updateArgHints(e)})}t.on("blur",function(n){e.context.triggerEvent("blur.codeview",t.getValue(),n)}),t.setSize(null,this.$editable.outerHeight()),this.$codable.data("cmEditor",t)}else this.$codable.on("blur",function(t){e.context.triggerEvent("blur.codeview",e.$codable.val(),t)})},e.prototype.deactivate=function(){if(xt.hasCodeMirror){var e=this.$codable.data("cmEditor");this.$codable.val(e.getValue()),e.toTextArea()}var t=Ht.value(this.$codable,this.options.prettifyHtml)||Ht.emptyPara,n=this.$editable.html()!==t;this.$editable.html(t),this.$editable.height(this.options.height?this.$codable.height():"auto"),this.$editor.removeClass("codeview"),n&&this.context.triggerEvent("change",this.$editable.html(),this.$editable),this.$editable.focus(),this.context.invoke("toolbar.updateCodeview",!1)},e.prototype.destroy=function(){this.isActivated()&&this.deactivate()},e}(),tn=24,nn=function(){function t(t){this.$document=e(document),this.$statusbar=t.layoutInfo.statusbar,this.$editable=t.layoutInfo.editable,this.options=t.options}return t.prototype.initialize=function(){var e=this;if(this.options.airMode||this.options.disableResizeEditor)return void this.destroy();this.$statusbar.on("mousedown",function(t){t.preventDefault(),t.stopPropagation();var n=e.$editable.offset().top-e.$document.scrollTop(),o=function(t){var o=t.clientY-(n+tn);o=e.options.minheight>0?Math.max(o,e.options.minheight):o,o=e.options.maxHeight>0?Math.min(o,e.options.maxHeight):o,e.$editable.height(o)};e.$document.on("mousemove",o).one("mouseup",function(){e.$document.off("mousemove",o)})})},t.prototype.destroy=function(){this.$statusbar.off()},t}(),on=function(){function t(t){var n=this;this.context=t,this.$editor=t.layoutInfo.editor,this.$toolbar=t.layoutInfo.toolbar,this.$editable=t.layoutInfo.editable,this.$codable=t.layoutInfo.codable,this.$window=e(window),this.$scrollbar=e("html, body"),this.onResize=function(){n.resizeTo({h:n.$window.height()-n.$toolbar.outerHeight()})}}return t.prototype.resizeTo=function(e){this.$editable.css("height",e.h),this.$codable.css("height",e.h),this.$codable.data("cmeditor")&&this.$codable.data("cmeditor").setsize(null,e.h)},t.prototype.toggle=function(){this.$editor.toggleClass("fullscreen"),this.isFullscreen()?(this.$editable.data("orgHeight",this.$editable.css("height")),this.$window.on("resize",this.onResize).trigger("resize"),this.$scrollbar.css("overflow","hidden")):(this.$window.off("resize",this.onResize),this.resizeTo({h:this.$editable.data("orgHeight")}),this.$scrollbar.css("overflow","visible")),this.context.invoke("toolbar.updateFullscreen",this.isFullscreen())},t.prototype.isFullscreen=function(){return this.$editor.hasClass("fullscreen")},t}(),rn=function(){function t(t){var n=this;this.context=t,this.$document=e(document),this.$editingArea=t.layoutInfo.editingArea,this.options=t.options,this.lang=this.options.langInfo,this.events={"summernote.mousedown":function(e,t){n.update(t.target)&&t.preventDefault()},"summernote.keyup summernote.scroll summernote.change summernote.dialog.shown":function(){n.update()},"summernote.disable":function(){n.hide()},"summernote.codeview.toggled":function(){n.update()}}}return t.prototype.initialize=function(){var t=this;this.$handle=e(['<div class="note-handle">','<div class="note-control-selection">','<div class="note-control-selection-bg"></div>','<div class="note-control-holder note-control-nw"></div>','<div class="note-control-holder note-control-ne"></div>','<div class="note-control-holder note-control-sw"></div>','<div class="',this.options.disableResizeImage?"note-control-holder":"note-control-sizing",' note-control-se"></div>',this.options.disableResizeImage?"":'<div class="note-control-selection-info"></div>',"</div>","</div>"].join("")).prependTo(this.$editingArea),this.$handle.on("mousedown",function(e){if(Ht.isControlSizing(e.target)){e.preventDefault(),e.stopPropagation();var n=t.$handle.find(".note-control-selection").data("target"),o=n.offset(),i=t.$document.scrollTop(),r=function(e){t.context.invoke("editor.resizeTo",{x:e.clientX-o.left,y:e.clientY-(o.top-i)},n,!e.shiftKey),t.update(n[0])};t.$document.on("mousemove",r).one("mouseup",function(e){e.preventDefault(),t.$document.off("mousemove",r),t.context.invoke("editor.afterCommand")}),n.data("ratio")||n.data("ratio",n.height()/n.width())}}),this.$handle.on("wheel",function(e){e.preventDefault(),t.update()})},t.prototype.destroy=function(){this.$handle.remove()},t.prototype.update=function(t){if(this.context.isDisabled())return!1;var n=Ht.isImg(t),o=this.$handle.find(".note-control-selection");if(this.context.invoke("imagePopover.update",t),n){var i=e(t),r=i.position(),s={left:r.left+parseInt(i.css("marginLeft"),10),top:r.top+parseInt(i.css("marginTop"),10)},a={w:i.outerWidth(!1),h:i.outerHeight(!1)};o.css({display:"block",left:s.left,top:s.top,width:a.w,height:a.h}).data("target",i);var l=new Image;l.src=i.attr("src");var c=a.w+"x"+a.h+" ("+this.lang.image.original+": "+l.width+"x"+l.height+")";o.find(".note-control-selection-info").text(c),this.context.invoke("editor.saveTarget",t)}else this.hide();return n},t.prototype.hide=function(){this.context.invoke("editor.clearTarget"),this.$handle.children().hide()},t}(),sn="http://",an=/^([A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?|mailto:[A-Z0-9._%+-]+@)?(www\.)?(.+)$/i,ln=function(){function t(e){var t=this;this.context=e,this.events={"summernote.keyup":function(e,n){n.isDefaultPrevented()||t.handleKeyup(n)},"summernote.keydown":function(e,n){t.handleKeydown(n)}}}return t.prototype.initialize=function(){this.lastWordRange=null},t.prototype.destroy=function(){this.lastWordRange=null},t.prototype.replace=function(){if(this.lastWordRange){var t=this.lastWordRange.toString(),n=t.match(an);if(n&&(n[1]||n[2])){var o=n[1]?t:sn+t,i=e("<a />").html(t).attr("href",o)[0];this.lastWordRange.insertNode(i),this.lastWordRange=null,this.context.invoke("editor.focus")}}},t.prototype.handleKeydown=function(e){if(gt.contains([Ft.code.ENTER,Ft.code.SPACE],e.keyCode)){var t=this.context.invoke("editor.createRange").getWordRange();this.lastWordRange=t}},t.prototype.handleKeyup=function(e){gt.contains([Ft.code.ENTER,Ft.code.SPACE],e.keyCode)&&this.replace()},t}(),cn=function(){function e(e){var t=this;this.$note=e.layoutInfo.note,this.events={"summernote.change":function(){t.$note.val(e.invoke("code"))}}}
return e.prototype.shouldInitialize=function(){return Ht.isTextarea(this.$note[0])},e}(),un=function(){function t(e){var t=this;this.context=e,this.$editingArea=e.layoutInfo.editingArea,this.options=e.options,this.events={"summernote.init summernote.change":function(){t.update()},"summernote.codeview.toggled":function(){t.update()}}}return t.prototype.shouldInitialize=function(){return!!this.options.placeholder},t.prototype.initialize=function(){var t=this;this.$placeholder=e('<div class="note-placeholder">'),this.$placeholder.on("click",function(){t.context.invoke("focus")}).text(this.options.placeholder).prependTo(this.$editingArea),this.update()},t.prototype.destroy=function(){this.$placeholder.remove()},t.prototype.update=function(){var e=!this.context.invoke("codeview.isActivated")&&this.context.invoke("editor.isEmpty");this.$placeholder.toggle(e)},t}(),dn=function(){function t(t){this.ui=e.summernote.ui,this.context=t,this.$toolbar=t.layoutInfo.toolbar,this.options=t.options,this.lang=this.options.langInfo,this.invertedKeyMap=mt.invertObject(this.options.keyMap[xt.isMac?"mac":"pc"])}return t.prototype.representShortcut=function(e){var t=this.invertedKeyMap[e];return this.options.shortcuts&&t?(xt.isMac&&(t=t.replace("CMD","\u2318").replace("SHIFT","\u21e7"))," ("+(t=t.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]"))+")"):""},t.prototype.button=function(e){return!this.options.tooltip&&e.tooltip&&delete e.tooltip,e.container=this.options.container,this.ui.button(e)},t.prototype.initialize=function(){this.addToolbarButtons(),this.addImagePopoverButtons(),this.addLinkPopoverButtons(),this.addTablePopoverButtons(),this.fontInstalledMap={}},t.prototype.destroy=function(){delete this.fontInstalledMap},t.prototype.isFontInstalled=function(e){return this.fontInstalledMap.hasOwnProperty(e)||(this.fontInstalledMap[e]=xt.isFontInstalled(e)||gt.contains(this.options.fontNamesIgnoreCheck,e)),this.fontInstalledMap[e]},t.prototype.isFontDeservedToAdd=function(t){var n=["sans-serif","serif","monospace","cursive","fantasy"];return""!==(t=t.toLowerCase())&&this.isFontInstalled(t)&&-1===e.inArray(t,n)},t.prototype.addToolbarButtons=function(){var t=this;this.context.memo("button.style",function(){return t.ui.buttonGroup([t.button({className:"dropdown-toggle",contents:t.ui.dropdownButtonContents(t.ui.icon(t.options.icons.magic),t.options),tooltip:t.lang.style.style,data:{toggle:"dropdown"}}),t.ui.dropdown({className:"dropdown-style",items:t.options.styleTags,template:function(e){"string"==typeof e&&(e={tag:e,title:t.lang.style.hasOwnProperty(e)?t.lang.style[e]:e});var n=e.tag,o=e.title;return"<"+n+(e.style?' style="'+e.style+'" ':"")+(e.className?' class="'+e.className+'"':"")+">"+o+"</"+n+">"},click:t.context.createInvokeHandler("editor.formatBlock")})]).render()});for(var n=function(e){var n=o.options.styleTags[e];o.context.memo("button.style."+n,function(){return t.button({className:"note-btn-style-"+n,contents:'<div data-value="'+n+'">'+n.toUpperCase()+"</div>",tooltip:n.toUpperCase(),click:t.context.createInvokeHandler("editor.formatBlock")}).render()})},o=this,i=0,r=this.options.styleTags.length;i<r;i++)n(i,r);this.context.memo("button.bold",function(){return t.button({className:"note-btn-bold",contents:t.ui.icon(t.options.icons.bold),tooltip:t.lang.font.bold+t.representShortcut("bold"),click:t.context.createInvokeHandlerAndUpdateState("editor.bold")}).render()}),this.context.memo("button.italic",function(){return t.button({className:"note-btn-italic",contents:t.ui.icon(t.options.icons.italic),tooltip:t.lang.font.italic+t.representShortcut("italic"),click:t.context.createInvokeHandlerAndUpdateState("editor.italic")}).render()}),this.context.memo("button.underline",function(){return t.button({className:"note-btn-underline",contents:t.ui.icon(t.options.icons.underline),tooltip:t.lang.font.underline+t.representShortcut("underline"),click:t.context.createInvokeHandlerAndUpdateState("editor.underline")}).render()}),this.context.memo("button.clear",function(){return t.button({contents:t.ui.icon(t.options.icons.eraser),tooltip:t.lang.font.clear+t.representShortcut("removeFormat"),click:t.context.createInvokeHandler("editor.removeFormat")}).render()}),this.context.memo("button.strikethrough",function(){return t.button({className:"note-btn-strikethrough",contents:t.ui.icon(t.options.icons.strikethrough),tooltip:t.lang.font.strikethrough+t.representShortcut("strikethrough"),click:t.context.createInvokeHandlerAndUpdateState("editor.strikethrough")}).render()}),this.context.memo("button.superscript",function(){return t.button({className:"note-btn-superscript",contents:t.ui.icon(t.options.icons.superscript),tooltip:t.lang.font.superscript,click:t.context.createInvokeHandlerAndUpdateState("editor.superscript")}).render()}),this.context.memo("button.subscript",function(){return t.button({className:"note-btn-subscript",contents:t.ui.icon(t.options.icons.subscript),tooltip:t.lang.font.subscript,click:t.context.createInvokeHandlerAndUpdateState("editor.subscript")}).render()}),this.context.memo("button.fontname",function(){var n=t.context.invoke("editor.currentStyle");return e.each(n["font-family"].split(","),function(n,o){o=o.trim().replace(/['"]+/g,""),t.isFontDeservedToAdd(o)&&-1===e.inArray(o,t.options.fontNames)&&t.options.fontNames.push(o)}),t.ui.buttonGroup([t.button({className:"dropdown-toggle",contents:t.ui.dropdownButtonContents('<span class="note-current-fontname"/>',t.options),tooltip:t.lang.font.name,data:{toggle:"dropdown"}}),t.ui.dropdownCheck({className:"dropdown-fontname",checkClassName:t.options.icons.menuCheck,items:t.options.fontNames.filter(t.isFontInstalled.bind(t)),template:function(e){return"<span style=\"font-family: '"+e+"'\">"+e+"</span>"},click:t.context.createInvokeHandlerAndUpdateState("editor.fontName")})]).render()}),this.context.memo("button.fontsize",function(){return t.ui.buttonGroup([t.button({className:"dropdown-toggle",contents:t.ui.dropdownButtonContents('<span class="note-current-fontsize"/>',t.options),tooltip:t.lang.font.size,data:{toggle:"dropdown"}}),t.ui.dropdownCheck({className:"dropdown-fontsize",checkClassName:t.options.icons.menuCheck,items:t.options.fontSizes,click:t.context.createInvokeHandlerAndUpdateState("editor.fontSize")})]).render()}),this.context.memo("button.color",function(){return t.ui.buttonGroup({className:"note-color",children:[t.button({className:"note-current-color-button",contents:t.ui.icon(t.options.icons.font+" note-recent-color"),tooltip:t.lang.color.recent,click:function(n){var o=e(n.currentTarget);t.context.invoke("editor.color",{backColor:o.attr("data-backColor"),foreColor:o.attr("data-foreColor")})},callback:function(e){e.find(".note-recent-color").css("background-color","#FFFF00"),e.attr("data-backColor","#FFFF00")}}),t.button({className:"dropdown-toggle",contents:t.ui.dropdownButtonContents("",t.options),tooltip:t.lang.color.more,data:{toggle:"dropdown"}}),t.ui.dropdown({items:['<div class="note-palette">','  <div class="note-palette-title">'+t.lang.color.background+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-light" data-event="backColor" data-value="inherit">',t.lang.color.transparent,"    </button>","  </div>",'  <div class="note-holder" data-event="backColor"/>',"</div>",'<div class="note-palette">','  <div class="note-palette-title">'+t.lang.color.foreground+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-light" data-event="removeFormat" data-value="foreColor">',t.lang.color.resetToDefault,"    </button>","  </div>",'  <div class="note-holder" data-event="foreColor"/>',"</div>"].join(""),callback:function(n){n.find(".note-holder").each(function(n,o){var i=e(o);i.append(t.ui.palette({colors:t.options.colors,eventName:i.data("event"),container:t.options.container,tooltip:t.options.tooltip}).render())})},click:function(n){var o=e(n.target),i=o.data("event"),r=o.data("value");if(i&&r){var s="backColor"===i?"background-color":"color",a=o.closest(".note-color").find(".note-recent-color"),l=o.closest(".note-color").find(".note-current-color-button");a.css(s,r),l.attr("data-"+i,r),t.context.invoke("editor."+i,r)}}})]}).render()}),this.context.memo("button.ul",function(){return t.button({contents:t.ui.icon(t.options.icons.unorderedlist),tooltip:t.lang.lists.unordered+t.representShortcut("insertUnorderedList"),click:t.context.createInvokeHandler("editor.insertUnorderedList")}).render()}),this.context.memo("button.ol",function(){return t.button({contents:t.ui.icon(t.options.icons.orderedlist),tooltip:t.lang.lists.ordered+t.representShortcut("insertOrderedList"),click:t.context.createInvokeHandler("editor.insertOrderedList")}).render()});var s=this.button({contents:this.ui.icon(this.options.icons.alignLeft),tooltip:this.lang.paragraph.left+this.representShortcut("justifyLeft"),click:this.context.createInvokeHandler("editor.justifyLeft")}),a=this.button({contents:this.ui.icon(this.options.icons.alignCenter),tooltip:this.lang.paragraph.center+this.representShortcut("justifyCenter"),click:this.context.createInvokeHandler("editor.justifyCenter")}),l=this.button({contents:this.ui.icon(this.options.icons.alignRight),tooltip:this.lang.paragraph.right+this.representShortcut("justifyRight"),click:this.context.createInvokeHandler("editor.justifyRight")}),c=this.button({contents:this.ui.icon(this.options.icons.alignJustify),tooltip:this.lang.paragraph.justify+this.representShortcut("justifyFull"),click:this.context.createInvokeHandler("editor.justifyFull")}),u=this.button({contents:this.ui.icon(this.options.icons.outdent),tooltip:this.lang.paragraph.outdent+this.representShortcut("outdent"),click:this.context.createInvokeHandler("editor.outdent")}),d=this.button({contents:this.ui.icon(this.options.icons.indent),tooltip:this.lang.paragraph.indent+this.representShortcut("indent"),click:this.context.createInvokeHandler("editor.indent")});this.context.memo("button.justifyLeft",mt.invoke(s,"render")),this.context.memo("button.justifyCenter",mt.invoke(a,"render")),this.context.memo("button.justifyRight",mt.invoke(l,"render")),this.context.memo("button.justifyFull",mt.invoke(c,"render")),this.context.memo("button.outdent",mt.invoke(u,"render")),this.context.memo("button.indent",mt.invoke(d,"render")),this.context.memo("button.paragraph",function(){return t.ui.buttonGroup([t.button({className:"dropdown-toggle",contents:t.ui.dropdownButtonContents(t.ui.icon(t.options.icons.alignLeft),t.options),tooltip:t.lang.paragraph.paragraph,data:{toggle:"dropdown"}}),t.ui.dropdown([t.ui.buttonGroup({className:"note-align",children:[s,a,l,c,u,d]})])]).render()}),this.context.memo("button.height",function(){return t.ui.buttonGroup([t.button({className:"dropdown-toggle",contents:t.ui.dropdownButtonContents(t.ui.icon(t.options.icons.textHeight),t.options),tooltip:t.lang.font.height,data:{toggle:"dropdown"}}),t.ui.dropdownCheck({items:t.options.lineHeights,checkClassName:t.options.icons.menuCheck,className:"dropdown-line-height",click:t.context.createInvokeHandler("editor.lineHeight")})]).render()}),this.context.memo("button.table",function(){return t.ui.buttonGroup([t.button({className:"dropdown-toggle",contents:t.ui.dropdownButtonContents(t.ui.icon(t.options.icons.table),t.options),tooltip:t.lang.table.table,data:{toggle:"dropdown"}}),t.ui.dropdown({className:"note-table",items:['<div class="note-dimension-picker">','  <div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"/>','  <div class="note-dimension-picker-highlighted"/>','  <div class="note-dimension-picker-unhighlighted"/>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:function(e){e.find(".note-dimension-picker-mousecatcher").css({width:t.options.insertTableMaxSize.col+"em",height:t.options.insertTableMaxSize.row+"em"}).mousedown(t.context.createInvokeHandler("editor.insertTable")).on("mousemove",t.tableMoveHandler.bind(t))}}).render()}),this.context.memo("button.link",function(){return t.button({contents:t.ui.icon(t.options.icons.link),tooltip:t.lang.link.link+t.representShortcut("linkDialog.show"),click:t.context.createInvokeHandler("linkDialog.show")}).render()}),this.context.memo("button.picture",function(){return t.button({contents:t.ui.icon(t.options.icons.picture),tooltip:t.lang.image.image,click:t.context.createInvokeHandler("imageDialog.show")}).render()}),this.context.memo("button.video",function(){return t.button({contents:t.ui.icon(t.options.icons.video),tooltip:t.lang.video.video,click:t.context.createInvokeHandler("videoDialog.show")}).render()}),this.context.memo("button.hr",function(){return t.button({contents:t.ui.icon(t.options.icons.minus),tooltip:t.lang.hr.insert+t.representShortcut("insertHorizontalRule"),click:t.context.createInvokeHandler("editor.insertHorizontalRule")}).render()}),this.context.memo("button.fullscreen",function(){return t.button({className:"btn-fullscreen",contents:t.ui.icon(t.options.icons.arrowsAlt),tooltip:t.options.fullscreen,click:t.context.createInvokeHandler("fullscreen.toggle")}).render()}),this.context.memo("button.codeview",function(){return t.button({className:"btn-codeview",contents:t.ui.icon(t.options.icons.code),tooltip:t.options.codeview,click:t.context.createInvokeHandler("codeview.toggle")}).render()}),this.context.memo("button.redo",function(){return t.button({contents:t.ui.icon(t.options.icons.redo),tooltip:t.lang.history.redo+t.representShortcut("redo"),click:t.context.createInvokeHandler("editor.redo")}).render()}),this.context.memo("button.undo",function(){return t.button({contents:t.ui.icon(t.options.icons.undo),tooltip:t.lang.history.undo+t.representShortcut("undo"),click:t.context.createInvokeHandler("editor.undo")}).render()}),this.context.memo("button.help",function(){return t.button({contents:t.ui.icon(t.options.icons.question),tooltip:t.options.help,click:t.context.createInvokeHandler("helpDialog.show")}).render()})},t.prototype.addImagePopoverButtons=function(){var e=this;this.context.memo("button.imageSize100",function(){return e.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:e.lang.image.resizeFull,click:e.context.createInvokeHandler("editor.resize","1")}).render()}),this.context.memo("button.imageSize50",function(){return e.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:e.lang.image.resizeHalf,click:e.context.createInvokeHandler("editor.resize","0.5")}).render()}),this.context.memo("button.imageSize25",function(){return e.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:e.lang.image.resizeQuarter,click:e.context.createInvokeHandler("editor.resize","0.25")}).render()}),this.context.memo("button.floatLeft",function(){return e.button({contents:e.ui.icon(e.options.icons.alignLeft),tooltip:e.lang.image.floatLeft,click:e.context.createInvokeHandler("editor.floatMe","left")}).render()}),this.context.memo("button.floatRight",function(){return e.button({contents:e.ui.icon(e.options.icons.alignRight),tooltip:e.lang.image.floatRight,click:e.context.createInvokeHandler("editor.floatMe","right")}).render()}),this.context.memo("button.floatNone",function(){return e.button({contents:e.ui.icon(e.options.icons.alignJustify),tooltip:e.lang.image.floatNone,click:e.context.createInvokeHandler("editor.floatMe","none")}).render()}),this.context.memo("button.removeMedia",function(){return e.button({contents:e.ui.icon(e.options.icons.trash),tooltip:e.lang.image.remove,click:e.context.createInvokeHandler("editor.removeMedia")}).render()})},t.prototype.addLinkPopoverButtons=function(){var e=this;this.context.memo("button.linkDialogShow",function(){return e.button({contents:e.ui.icon(e.options.icons.link),tooltip:e.lang.link.edit,click:e.context.createInvokeHandler("linkDialog.show")}).render()}),this.context.memo("button.unlink",function(){return e.button({contents:e.ui.icon(e.options.icons.unlink),tooltip:e.lang.link.unlink,click:e.context.createInvokeHandler("editor.unlink")}).render()})},t.prototype.addTablePopoverButtons=function(){var e=this;this.context.memo("button.addRowUp",function(){return e.button({className:"btn-md",contents:e.ui.icon(e.options.icons.rowAbove),tooltip:e.lang.table.addRowAbove,click:e.context.createInvokeHandler("editor.addRow","top")}).render()}),this.context.memo("button.addRowDown",function(){return e.button({className:"btn-md",contents:e.ui.icon(e.options.icons.rowBelow),tooltip:e.lang.table.addRowBelow,click:e.context.createInvokeHandler("editor.addRow","bottom")}).render()}),this.context.memo("button.addColLeft",function(){return e.button({className:"btn-md",contents:e.ui.icon(e.options.icons.colBefore),tooltip:e.lang.table.addColLeft,click:e.context.createInvokeHandler("editor.addCol","left")}).render()}),this.context.memo("button.addColRight",function(){return e.button({className:"btn-md",contents:e.ui.icon(e.options.icons.colAfter),tooltip:e.lang.table.addColRight,click:e.context.createInvokeHandler("editor.addCol","right")}).render()}),this.context.memo("button.deleteRow",function(){return e.button({className:"btn-md",contents:e.ui.icon(e.options.icons.rowRemove),tooltip:e.lang.table.delRow,click:e.context.createInvokeHandler("editor.deleteRow")}).render()}),this.context.memo("button.deleteCol",function(){return e.button({className:"btn-md",contents:e.ui.icon(e.options.icons.colRemove),tooltip:e.lang.table.delCol,click:e.context.createInvokeHandler("editor.deleteCol")}).render()}),this.context.memo("button.deleteTable",function(){return e.button({className:"btn-md",contents:e.ui.icon(e.options.icons.trash),tooltip:e.lang.table.delTable,click:e.context.createInvokeHandler("editor.deleteTable")}).render()})},t.prototype.build=function(t,n){for(var o=0,i=n.length;o<i;o++){for(var r=n[o],s=e.isArray(r)?r[0]:r,a=e.isArray(r)?1===r.length?[r[0]]:r[1]:[r],l=this.ui.buttonGroup({className:"note-"+s}).render(),c=0,u=a.length;c<u;c++){var d=this.context.memo("button."+a[c]);d&&l.append("function"==typeof d?d(this.context):d)}l.appendTo(t)}},t.prototype.updateCurrentStyle=function(t){var n=this,o=t||this.$toolbar,i=this.context.invoke("editor.currentStyle");if(this.updateBtnStates(o,{".note-btn-bold":function(){return"bold"===i["font-bold"]},".note-btn-italic":function(){return"italic"===i["font-italic"]},".note-btn-underline":function(){return"underline"===i["font-underline"]},".note-btn-subscript":function(){return"subscript"===i["font-subscript"]},".note-btn-superscript":function(){return"superscript"===i["font-superscript"]},".note-btn-strikethrough":function(){return"strikethrough"===i["font-strikethrough"]}}),i["font-family"]){var r=i["font-family"].split(",").map(function(e){return e.replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,"")}),s=gt.find(r,this.isFontInstalled.bind(this));o.find(".dropdown-fontname a").each(function(t,n){var o=e(n),i=o.data("value")+""==s+"";o.toggleClass("checked",i)}),o.find(".note-current-fontname").text(s).css("font-family",s)}if(i["font-size"]){var a=i["font-size"];o.find(".dropdown-fontsize a").each(function(t,n){var o=e(n),i=o.data("value")+""==a+"";o.toggleClass("checked",i)}),o.find(".note-current-fontsize").text(a)}if(i["line-height"]){var l=i["line-height"];o.find(".dropdown-line-height li a").each(function(t,o){var i=e(o).data("value")+""==l+"";n.className=i?"checked":""})}},t.prototype.updateBtnStates=function(t,n){var o=this;e.each(n,function(e,n){o.ui.toggleBtnActive(t.find(e),n())})},t.prototype.tableMoveHandler=function(t){var n,o=18,i=e(t.target.parentNode),r=i.next(),s=i.find(".note-dimension-picker-mousecatcher"),a=i.find(".note-dimension-picker-highlighted"),l=i.find(".note-dimension-picker-unhighlighted");if(t.offsetX===undefined){var c=e(t.target).offset();n={x:t.pageX-c.left,y:t.pageY-c.top}}else n={x:t.offsetX,y:t.offsetY};var u={c:Math.ceil(n.x/o)||1,r:Math.ceil(n.y/o)||1};a.css({width:u.c+"em",height:u.r+"em"}),s.data("value",u.c+"x"+u.r),u.c>3&&u.c<this.options.insertTableMaxSize.col&&l.css({width:u.c+1+"em"}),u.r>3&&u.r<this.options.insertTableMaxSize.row&&l.css({height:u.r+1+"em"}),r.html(u.c+" x "+u.r)},t}(),hn=function(){function t(t){this.context=t,this.$window=e(window),this.$document=e(document),this.ui=e.summernote.ui,this.$note=t.layoutInfo.note,this.$editor=t.layoutInfo.editor,this.$toolbar=t.layoutInfo.toolbar,this.options=t.options,this.followScroll=this.followScroll.bind(this)}return t.prototype.shouldInitialize=function(){return!this.options.airMode},t.prototype.initialize=function(){var e=this;this.options.toolbar=this.options.toolbar||[],this.options.toolbar.length?this.context.invoke("buttons.build",this.$toolbar,this.options.toolbar):this.$toolbar.hide(),this.options.toolbarContainer&&this.$toolbar.appendTo(this.options.toolbarContainer),this.changeContainer(!1),this.$note.on("summernote.keyup summernote.mouseup summernote.change",function(){e.context.invoke("buttons.updateCurrentStyle")}),this.context.invoke("buttons.updateCurrentStyle"),this.options.followingToolbar&&this.$window.on("scroll resize",this.followScroll)},t.prototype.destroy=function(){this.$toolbar.children().remove(),this.options.followingToolbar&&this.$window.off("scroll resize",this.followScroll)},t.prototype.followScroll=function(){if(this.$editor.hasClass("fullscreen"))return!1;var t=this.$toolbar.parent(".note-toolbar-wrapper"),n=this.$editor.outerHeight(),o=this.$editor.width(),i=this.$toolbar.height();t.css({height:i});var r=0;this.options.otherStaticBar&&(r=e(this.options.otherStaticBar).outerHeight());var s=this.$document.scrollTop(),a=this.$editor.offset().top,l=a+n,c=a-r,u=l-r-i;s>c&&s<u?this.$toolbar.css({position:"fixed",top:r,width:o}):this.$toolbar.css({position:"relative",top:0,width:"100%"})},t.prototype.changeContainer=function(e){e?this.$toolbar.prependTo(this.$editor):this.options.toolbarContainer&&this.$toolbar.appendTo(this.options.toolbarContainer)},t.prototype.updateFullscreen=function(e){this.ui.toggleBtnActive(this.$toolbar.find(".btn-fullscreen"),e),this.changeContainer(e)},t.prototype.updateCodeview=function(e){this.ui.toggleBtnActive(this.$toolbar.find(".btn-codeview"),e),e?this.deactivate():this.activate()},t.prototype.activate=function(e){var t=this.$toolbar.find("button");e||(t=t.not(".btn-codeview")),this.ui.toggleBtn(t,!0)},t.prototype.deactivate=function(e){var t=this.$toolbar.find("button");e||(t=t.not(".btn-codeview")),this.ui.toggleBtn(t,!1)},t}(),pn=function(){function t(t){this.context=t,this.ui=e.summernote.ui,this.$body=e(document.body),this.$editor=t.layoutInfo.editor,this.options=t.options,this.lang=this.options.langInfo,t.memo("help.linkDialog.show",this.options.langInfo.help["linkDialog.show"])}return t.prototype.initialize=function(){var t=this.options.dialogsInBody?this.$body:this.$editor,n=['<div class="form-group note-form-group">','<label class="note-form-label">'+this.lang.link.textToDisplay+"</label>",'<input class="note-link-text form-control note-form-control  note-input" type="text" />',"</div>",'<div class="form-group note-form-group">','<label class="note-form-label">'+this.lang.link.url+"</label>",'<input class="note-link-url form-control note-form-control note-input" type="text" value="http://" />',"</div>",this.options.disableLinkTarget?"":e("<div/>").append(this.ui.checkbox({id:"sn-checkbox-open-in-new-window",text:this.lang.link.openInNewWindow,checked:!0}).render()).html()].join(""),o="btn btn-primary note-btn note-btn-primary note-link-btn",i='<button type="submit" href="#" class="'+o+'" disabled>'+this.lang.link.insert+"</button>";this.$dialog=this.ui.dialog({className:"link-dialog",title:this.lang.link.insert,fade:this.options.dialogsFade,body:n,footer:i}).render().appendTo(t)},t.prototype.destroy=function(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()},t.prototype.bindEnterKey=function(e,t){e.on("keypress",function(e){e.keyCode===Ft.code.ENTER&&(e.preventDefault(),t.trigger("click"))})},t.prototype.toggleLinkBtn=function(e,t,n){this.ui.toggleBtn(e,t.val()&&n.val())},t.prototype.showLinkDialog=function(t){var n=this;return e.Deferred(function(e){var o=n.$dialog.find(".note-link-text"),i=n.$dialog.find(".note-link-url"),r=n.$dialog.find(".note-link-btn"),s=n.$dialog.find("input[type=checkbox]");n.ui.onDialogShown(n.$dialog,function(){n.context.triggerEvent("dialog.shown"),t.url||(t.url=t.text),o.val(t.text);var a=function(){n.toggleLinkBtn(r,o,i),t.text=o.val()};o.on("input",a).on("paste",function(){setTimeout(a,0)});var l=function(){n.toggleLinkBtn(r,o,i),t.text||o.val(i.val())};i.on("input",l).on("paste",function(){setTimeout(l,0)}).val(t.url),xt.isSupportTouch||i.trigger("focus"),n.toggleLinkBtn(r,o,i),n.bindEnterKey(i,r),n.bindEnterKey(o,r);var c=t.isNewWindow!==undefined?t.isNewWindow:n.context.options.linkTargetBlank;s.prop("checked",c),r.one("click",function(r){r.preventDefault(),e.resolve({range:t.range,url:i.val(),text:o.val(),isNewWindow:s.is(":checked")}),n.ui.hideDialog(n.$dialog)})}),n.ui.onDialogHidden(n.$dialog,function(){o.off("input paste keypress"),i.off("input paste keypress"),r.off("click"),"pending"===e.state()&&e.reject()}),n.ui.showDialog(n.$dialog)}).promise()},t.prototype.show=function(){var e=this,t=this.context.invoke("editor.getLinkInfo");this.context.invoke("editor.saveRange"),this.showLinkDialog(t).then(function(t){e.context.invoke("editor.restoreRange"),e.context.invoke("editor.createLink",t)}).fail(function(){e.context.invoke("editor.restoreRange")})},t}(),fn=function(){function t(t){var n=this;this.context=t,this.ui=e.summernote.ui,this.options=t.options,this.events={"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){n.update()},"summernote.disable summernote.dialog.shown":function(){n.hide()}}}return t.prototype.shouldInitialize=function(){return!gt.isEmpty(this.options.popover.link)},t.prototype.initialize=function(){this.$popover=this.ui.popover({className:"note-link-popover",callback:function(e){e.find(".popover-content,.note-popover-content").prepend('<span><a target="_blank"></a>&nbsp;</span>')}}).render().appendTo(this.options.container);var e=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",e,this.options.popover.link)},t.prototype.destroy=function(){this.$popover.remove()},t.prototype.update=function(){if(!this.context.invoke("editor.hasFocus"))return void this.hide();var t=this.context.invoke("editor.createRange");if(t.isCollapsed()&&t.isOnAnchor()){var n=Ht.ancestor(t.sc,Ht.isAnchor),o=e(n).attr("href");this.$popover.find("a").attr("href",o).html(o);var i=Ht.posFromPlaceholder(n);this.$popover.css({display:"block",left:i.left,top:i.top})}else this.hide()},t.prototype.hide=function(){this.$popover.hide()},t}(),mn=function(){function t(t){this.context=t,this.ui=e.summernote.ui,this.$body=e(document.body),this.$editor=t.layoutInfo.editor,this.options=t.options,this.lang=this.options.langInfo}return t.prototype.initialize=function(){var e=this.options.dialogsInBody?this.$body:this.$editor,t="";if(this.options.maximumImageFileSize){var n=Math.floor(Math.log(this.options.maximumImageFileSize)/Math.log(1024)),o=1*(this.options.maximumImageFileSize/Math.pow(1024,n)).toFixed(2)+" "+" KMGTP"[n]+"B";t="<small>"+this.lang.image.maximumFileSize+" : "+o+"</small>"}var i=['<div class="form-group note-form-group note-group-select-from-files">','<label class="note-form-label">'+this.lang.image.selectFromFiles+"</label>",'<input class="note-image-input note-form-control note-input" ',' type="file" name="files" accept="image/*" multiple="multiple" />',t,"</div>",'<div class="form-group note-group-image-url" style="overflow:auto;">','<label class="note-form-label">'+this.lang.image.url+"</label>",'<input class="note-image-url form-control note-form-control note-input ',' col-md-12" type="text" />',"</div>"].join(""),r="btn btn-primary note-btn note-btn-primary note-image-btn",s='<button type="submit" href="#" class="'+r+'" disabled>'+this.lang.image.insert+"</button>";this.$dialog=this.ui.dialog({title:this.lang.image.insert,fade:this.options.dialogsFade,body:i,footer:s}).render().appendTo(e)},t.prototype.destroy=function(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()},t.prototype.bindEnterKey=function(e,t){e.on("keypress",function(e){e.keyCode===Ft.code.ENTER&&(e.preventDefault(),t.trigger("click"))})},t.prototype.show=function(){var e=this;this.context.invoke("editor.saveRange"),this.showImageDialog().then(function(t){e.ui.hideDialog(e.$dialog),e.context.invoke("editor.restoreRange"),"string"==typeof t?e.context.invoke("editor.insertImage",t):e.context.invoke("editor.insertImagesOrCallback",t)}).fail(function(){e.context.invoke("editor.restoreRange")})},t.prototype.showImageDialog=function(){var t=this;return e.Deferred(function(e){var n=t.$dialog.find(".note-image-input"),o=t.$dialog.find(".note-image-url"),i=t.$dialog.find(".note-image-btn");t.ui.onDialogShown(t.$dialog,function(){t.context.triggerEvent("dialog.shown"),n.replaceWith(n.clone().on("change",function(t){e.resolve(t.target.files||t.target.value)}).val("")),i.click(function(t){t.preventDefault(),e.resolve(o.val())}),o.on("keyup paste",function(){var e=o.val();t.ui.toggleBtn(i,e)}).val(""),xt.isSupportTouch||o.trigger("focus"),t.bindEnterKey(o,i)}),t.ui.onDialogHidden(t.$dialog,function(){n.off("change"),o.off("keyup paste keypress"),i.off("click"),"pending"===e.state()&&e.reject()}),t.ui.showDialog(t.$dialog)})},t}(),gn=function(){function t(t){var n=this;this.context=t,this.ui=e.summernote.ui,this.editable=t.layoutInfo.editable[0],this.options=t.options,this.events={"summernote.disable":function(){n.hide()}}}return t.prototype.shouldInitialize=function(){return!gt.isEmpty(this.options.popover.image)},t.prototype.initialize=function(){this.$popover=this.ui.popover({className:"note-image-popover"}).render().appendTo(this.options.container);var e=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",e,this.options.popover.image)},t.prototype.destroy=function(){this.$popover.remove()},t.prototype.update=function(e){if(Ht.isImg(e)){var t=Ht.posFromPlaceholder(e),n=Ht.posFromPlaceholder(this.editable);this.$popover.css({display:"block",left:this.options.popatmouse?event.pageX-20:t.left,top:this.options.popatmouse?event.pageY:Math.min(t.top,n.top)})}else this.hide()},t.prototype.hide=function(){this.$popover.hide()},t}(),vn=function(){function t(t){var n=this;this.context=t,this.ui=e.summernote.ui,this.options=t.options,this.events={"summernote.mousedown":function(e,t){n.update(t.target)},"summernote.keyup summernote.scroll summernote.change":function(){n.update()},"summernote.disable":function(){n.hide()}}}return t.prototype.shouldInitialize=function(){return!gt.isEmpty(this.options.popover.table)},t.prototype.initialize=function(){this.$popover=this.ui.popover({className:"note-table-popover"}).render().appendTo(this.options.container);var e=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",e,this.options.popover.table),xt.isFF&&document.execCommand("enableInlineTableEditing",!1,!1)},t.prototype.destroy=function(){this.$popover.remove()},t.prototype.update=function(e){if(this.context.isDisabled())return!1;var t=Ht.isCell(e);if(t){var n=Ht.posFromPlaceholder(e);this.$popover.css({display:"block",left:n.left,top:n.top})}else this.hide();return t},t.prototype.hide=function(){this.$popover.hide()},t}(),yn=function(){function t(t){this.context=t,this.ui=e.summernote.ui,this.$body=e(document.body),this.$editor=t.layoutInfo.editor,this.options=t.options,this.lang=this.options.langInfo}return t.prototype.initialize=function(){var e=this.options.dialogsInBody?this.$body:this.$editor,t=['<div class="form-group note-form-group row-fluid">','<label class="note-form-label">'+this.lang.video.url+' <small class="text-muted">'+this.lang.video.providers+"</small></label>",'<input class="note-video-url form-control note-form-control note-input" type="text" />',"</div>"].join(""),n="btn btn-primary note-btn note-btn-primary note-video-btn",o='<button type="submit" href="#" class="'+n+'" disabled>'+this.lang.video.insert+"</button>";this.$dialog=this.ui.dialog({title:this.lang.video.insert,fade:this.options.dialogsFade,body:t,footer:o}).render().appendTo(e)},t.prototype.destroy=function(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()},t.prototype.bindEnterKey=function(e,t){e.on("keypress",function(e){e.keyCode===Ft.code.ENTER&&(e.preventDefault(),t.trigger("click"))})},t.prototype.createVideoNode=function(t){
var n,o=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,i=t.match(o),r=/(?:www\.|\/\/)instagram\.com\/p\/(.[a-zA-Z0-9_-]*)/,s=t.match(r),a=/\/\/vine\.co\/v\/([a-zA-Z0-9]+)/,l=t.match(a),c=/\/\/(player\.)?vimeo\.com\/([a-z]*\/)*(\d+)[?]?.*/,u=t.match(c),d=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,h=t.match(d),p=/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/,f=t.match(p),m=/\/\/v\.qq\.com.*?vid=(.+)/,g=t.match(m),v=/\/\/v\.qq\.com\/x?\/?(page|cover).*?\/([^\/]+)\.html\??.*/,y=t.match(v),b=/^.+.(mp4|m4v)$/,w=t.match(b),C=/^.+.(ogg|ogv)$/,k=t.match(C),_=/^.+.(webm)$/,S=t.match(_);if(i&&11===i[1].length){var x=i[1];n=e("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+x).attr("width","640").attr("height","360")}else if(s&&s[0].length)n=e("<iframe>").attr("frameborder",0).attr("src","https://instagram.com/p/"+s[1]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true");else if(l&&l[0].length)n=e("<iframe>").attr("frameborder",0).attr("src",l[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed");else if(u&&u[3].length)n=e("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+u[3]).attr("width","640").attr("height","360");else if(h&&h[2].length)n=e("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+h[2]).attr("width","640").attr("height","360");else if(f&&f[1].length)n=e("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+f[1]);else if(g&&g[1].length||y&&y[2].length){var $=g&&g[1].length?g[1]:y[2];n=e("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","310").attr("width","500").attr("src","http://v.qq.com/iframe/player.html?vid="+$+"&amp;auto=0")}else{if(!(w||k||S))return!1;n=e("<video controls>").attr("src",t).attr("width","640").attr("height","360")}return n.addClass("note-video-clip"),n[0]},t.prototype.show=function(){var e=this,t=this.context.invoke("editor.getSelectedText");this.context.invoke("editor.saveRange"),this.showVideoDialog(t).then(function(t){e.ui.hideDialog(e.$dialog),e.context.invoke("editor.restoreRange");var n=e.createVideoNode(t);n&&e.context.invoke("editor.insertNode",n)}).fail(function(){e.context.invoke("editor.restoreRange")})},t.prototype.showVideoDialog=function(t){var n=this;return e.Deferred(function(e){var o=n.$dialog.find(".note-video-url"),i=n.$dialog.find(".note-video-btn");n.ui.onDialogShown(n.$dialog,function(){n.context.triggerEvent("dialog.shown"),o.val(t).on("input",function(){n.ui.toggleBtn(i,o.val())}),xt.isSupportTouch||o.trigger("focus"),i.click(function(t){t.preventDefault(),e.resolve(o.val())}),n.bindEnterKey(o,i)}),n.ui.onDialogHidden(n.$dialog,function(){o.off("input"),i.off("click"),"pending"===e.state()&&e.reject()}),n.ui.showDialog(n.$dialog)})},t}(),bn=function(){function t(t){this.context=t,this.ui=e.summernote.ui,this.$body=e(document.body),this.$editor=t.layoutInfo.editor,this.options=t.options,this.lang=this.options.langInfo}return t.prototype.initialize=function(){var e=this.options.dialogsInBody?this.$body:this.$editor,t=['<p class="text-center">','<a href="http://summernote.org/" target="_blank">Summernote 0.8.9</a> \xb7 ','<a href="https://github.com/summernote/summernote" target="_blank">Project</a> \xb7 ','<a href="https://github.com/summernote/summernote/issues" target="_blank">Issues</a>',"</p>"].join("");this.$dialog=this.ui.dialog({title:this.lang.options.help,fade:this.options.dialogsFade,body:this.createShortcutList(),footer:t,callback:function(e){e.find(".modal-body,.note-modal-body").css({"max-height":300,overflow:"scroll"})}}).render().appendTo(e)},t.prototype.destroy=function(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()},t.prototype.createShortcutList=function(){var t=this,n=this.options.keyMap[xt.isMac?"mac":"pc"];return Object.keys(n).map(function(o){var i=n[o],r=e('<div><div class="help-list-item"/></div>');return r.append(e("<label><kbd>"+o+"</kdb></label>").css({width:180,"margin-right":10})).append(e("<span/>").html(t.context.memo("help."+i)||i)),r.html()}).join("")},t.prototype.showHelpDialog=function(){var t=this;return e.Deferred(function(e){t.ui.onDialogShown(t.$dialog,function(){t.context.triggerEvent("dialog.shown"),e.resolve()}),t.ui.showDialog(t.$dialog)}).promise()},t.prototype.show=function(){var e=this;this.context.invoke("editor.saveRange"),this.showHelpDialog().then(function(){e.context.invoke("editor.restoreRange")})},t}(),wn=20,Cn=function(){function t(t){var n=this;this.context=t,this.ui=e.summernote.ui,this.options=t.options,this.events={"summernote.keyup summernote.mouseup summernote.scroll":function(){n.update()},"summernote.disable summernote.change summernote.dialog.shown":function(){n.hide()},"summernote.focusout":function(e,t){xt.isFF||t.relatedTarget&&Ht.ancestor(t.relatedTarget,mt.eq(n.$popover[0]))||n.hide()}}}return t.prototype.shouldInitialize=function(){return this.options.airMode&&!gt.isEmpty(this.options.popover.air)},t.prototype.initialize=function(){this.$popover=this.ui.popover({className:"note-air-popover"}).render().appendTo(this.options.container);var e=this.$popover.find(".popover-content");this.context.invoke("buttons.build",e,this.options.popover.air)},t.prototype.destroy=function(){this.$popover.remove()},t.prototype.update=function(){var e=this.context.invoke("editor.currentStyle");if(e.range&&!e.range.isCollapsed()){var t=gt.last(e.range.getClientRects());if(t){var n=mt.rect2bnd(t);this.$popover.css({display:"block",left:Math.max(n.left+n.width/2,0)-wn,top:n.top+n.height}),this.context.invoke("buttons.updateCurrentStyle",this.$popover)}}else this.hide()},t.prototype.hide=function(){this.$popover.hide()},t}(),kn=5,_n=function(){function t(t){var n=this;this.context=t,this.ui=e.summernote.ui,this.$editable=t.layoutInfo.editable,this.options=t.options,this.hint=this.options.hint||[],this.direction=this.options.hintDirection||"bottom",this.hints=e.isArray(this.hint)?this.hint:[this.hint],this.events={"summernote.keyup":function(e,t){t.isDefaultPrevented()||n.handleKeyup(t)},"summernote.keydown":function(e,t){n.handleKeydown(t)},"summernote.disable summernote.dialog.shown":function(){n.hide()}}}return t.prototype.shouldInitialize=function(){return this.hints.length>0},t.prototype.initialize=function(){var t=this;this.lastWordRange=null,this.$popover=this.ui.popover({className:"note-hint-popover",hideArrow:!0,direction:""}).render().appendTo(this.options.container),this.$popover.hide(),this.$content=this.$popover.find(".popover-content,.note-popover-content"),this.$content.on("click",".note-hint-item",function(){t.$content.find(".active").removeClass("active"),e(t).addClass("active"),t.replace()})},t.prototype.destroy=function(){this.$popover.remove()},t.prototype.selectItem=function(e){this.$content.find(".active").removeClass("active"),e.addClass("active"),this.$content[0].scrollTop=e[0].offsetTop-this.$content.innerHeight()/2},t.prototype.moveDown=function(){var e=this.$content.find(".note-hint-item.active"),t=e.next();if(t.length)this.selectItem(t);else{var n=e.parent().next();n.length||(n=this.$content.find(".note-hint-group").first()),this.selectItem(n.find(".note-hint-item").first())}},t.prototype.moveUp=function(){var e=this.$content.find(".note-hint-item.active"),t=e.prev();if(t.length)this.selectItem(t);else{var n=e.parent().prev();n.length||(n=this.$content.find(".note-hint-group").last()),this.selectItem(n.find(".note-hint-item").last())}},t.prototype.replace=function(){var e=this.$content.find(".note-hint-item.active");if(e.length){var t=this.nodeFromItem(e);this.lastWordRange.insertNode(t),Ut.createFromNode(t).collapse().select(),this.lastWordRange=null,this.hide(),this.context.triggerEvent("change",this.$editable.html(),this.$editable[0]),this.context.invoke("editor.focus")}},t.prototype.nodeFromItem=function(e){var t=this.hints[e.data("index")],n=e.data("item"),o=t.content?t.content(n):n;return"string"==typeof o&&(o=Ht.createText(o)),o},t.prototype.createItemTemplates=function(t,n){var o=this.hints[t];return n.map(function(n){var i=e('<div class="note-hint-item"/>');return i.append(o.template?o.template(n):n+""),i.data({index:t,item:n}),i})},t.prototype.handleKeydown=function(e){this.$popover.is(":visible")&&(e.keyCode===Ft.code.ENTER?(e.preventDefault(),this.replace()):e.keyCode===Ft.code.UP?(e.preventDefault(),this.moveUp()):e.keyCode===Ft.code.DOWN&&(e.preventDefault(),this.moveDown()))},t.prototype.searchKeyword=function(e,t,n){var o=this.hints[e];if(o&&o.match.test(t)&&o.search){var i=o.match.exec(t);o.search(i[1],n)}else n()},t.prototype.createGroup=function(t,n){var o=this,i=e('<div class="note-hint-group note-hint-group-'+t+'"/>');return this.searchKeyword(t,n,function(e){e=e||[],e.length&&(i.html(o.createItemTemplates(t,e)),o.show())}),i},t.prototype.handleKeyup=function(e){var t=this;if(!gt.contains([Ft.code.ENTER,Ft.code.UP,Ft.code.DOWN],e.keyCode)){var n=this.context.invoke("editor.createRange").getWordRange(),o=n.toString();if(this.hints.length&&o){this.$content.empty();var i=mt.rect2bnd(gt.last(n.getClientRects()));i&&(this.$popover.hide(),this.lastWordRange=n,this.hints.forEach(function(e,n){e.match.test(o)&&t.createGroup(n,o).appendTo(t.$content)}),this.$content.find(".note-hint-item:first").addClass("active"),"top"===this.direction?this.$popover.css({left:i.left,top:i.top-this.$popover.outerHeight()-kn}):this.$popover.css({left:i.left,top:i.top+i.height+kn}))}else this.hide()}},t.prototype.show=function(){this.$popover.show()},t.prototype.hide=function(){this.$popover.hide()},t}(),Sn=function(){function t(t,n){this.ui=e.summernote.ui,this.$note=t,this.memos={},this.modules={},this.layoutInfo={},this.options=n,this.initialize()}return t.prototype.initialize=function(){return this.layoutInfo=this.ui.createLayout(this.$note,this.options),this._initialize(),this.$note.hide(),this},t.prototype.destroy=function(){this._destroy(),this.$note.removeData("summernote"),this.ui.removeLayout(this.$note,this.layoutInfo)},t.prototype.reset=function(){var e=this.isDisabled();this.code(Ht.emptyPara),this._destroy(),this._initialize(),e&&this.disable()},t.prototype._initialize=function(){var t=this,n=e.extend({},this.options.buttons);Object.keys(n).forEach(function(e){t.memo("button."+e,n[e])});var o=e.extend({},this.options.modules,e.summernote.plugins||{});Object.keys(o).forEach(function(e){t.module(e,o[e],!0)}),Object.keys(this.modules).forEach(function(e){t.initializeModule(e)})},t.prototype._destroy=function(){var e=this;Object.keys(this.modules).reverse().forEach(function(t){e.removeModule(t)}),Object.keys(this.memos).forEach(function(t){e.removeMemo(t)}),this.triggerEvent("destroy",this)},t.prototype.code=function(e){var t=this.invoke("codeview.isActivated");if(e===undefined)return this.invoke("codeview.sync"),t?this.layoutInfo.codable.val():this.layoutInfo.editable.html();t?this.layoutInfo.codable.val(e):this.layoutInfo.editable.html(e),this.$note.val(e),this.triggerEvent("change",e)},t.prototype.isDisabled=function(){return"false"===this.layoutInfo.editable.attr("contenteditable")},t.prototype.enable=function(){this.layoutInfo.editable.attr("contenteditable",!0),this.invoke("toolbar.activate",!0),this.triggerEvent("disable",!1)},t.prototype.disable=function(){this.invoke("codeview.isActivated")&&this.invoke("codeview.deactivate"),this.layoutInfo.editable.attr("contenteditable",!1),this.invoke("toolbar.deactivate",!0),this.triggerEvent("disable",!0)},t.prototype.triggerEvent=function(){var e=gt.head(arguments),t=gt.tail(gt.from(arguments)),n=this.options.callbacks[mt.namespaceToCamel(e,"on")];n&&n.apply(this.$note[0],t),this.$note.trigger("summernote."+e,t)},t.prototype.initializeModule=function(e){var t=this.modules[e];t.shouldInitialize=t.shouldInitialize||mt.ok,t.shouldInitialize()&&(t.initialize&&t.initialize(),t.events&&Ht.attachEvents(this.$note,t.events))},t.prototype.module=function(e,t,n){if(1===arguments.length)return this.modules[e];this.modules[e]=new t(this),n||this.initializeModule(e)},t.prototype.removeModule=function(e){var t=this.modules[e];t.shouldInitialize()&&(t.events&&Ht.detachEvents(this.$note,t.events),t.destroy&&t.destroy()),delete this.modules[e]},t.prototype.memo=function(e,t){if(1===arguments.length)return this.memos[e];this.memos[e]=t},t.prototype.removeMemo=function(e){this.memos[e]&&this.memos[e].destroy&&this.memos[e].destroy(),delete this.memos[e]},t.prototype.createInvokeHandlerAndUpdateState=function(e,t){var n=this;return function(o){n.createInvokeHandler(e,t)(o),n.invoke("buttons.updateCurrentStyle")}},t.prototype.createInvokeHandler=function(t,n){var o=this;return function(i){i.preventDefault();var r=e(i.target);o.invoke(t,n||r.closest("[data-value]").data("value"),r)}},t.prototype.invoke=function(){var e=gt.head(arguments),t=gt.tail(gt.from(arguments)),n=e.split("."),o=n.length>1,i=o&&gt.head(n),r=o?gt.last(n):gt.head(n),s=this.modules[i||"editor"];return!i&&this[r]?this[r].apply(this,t):s&&s[r]&&s.shouldInitialize()?s[r].apply(s,t):void 0},t}();e.fn.extend({summernote:function(){var t=e.type(gt.head(arguments)),n="string"===t,o="object"===t,i=e.extend({},e.summernote.options,o?gt.head(arguments):{});i.langInfo=e.extend(!0,{},e.summernote.lang["en-US"],e.summernote.lang[i.lang]),i.icons=e.extend(!0,{},e.summernote.options.icons,i.icons),i.tooltip="auto"===i.tooltip?!xt.isSupportTouch:i.tooltip,this.each(function(t,n){var o=e(n);if(!o.data("summernote")){var r=new Sn(o,i);o.data("summernote",r),o.data("summernote").triggerEvent("init",r.layoutInfo)}});var r=this.first();if(r.length){var s=r.data("summernote");if(n)return s.invoke.apply(s,gt.from(arguments));i.focus&&s.invoke("editor.focus")}return this}}),e.summernote=e.extend(e.summernote,{version:"0.8.9",ui:pt,dom:Ht,plugins:{},options:{modules:{editor:Jt,clipboard:Xt,dropzone:Zt,codeview:en,statusbar:nn,fullscreen:on,handle:rn,hintPopover:_n,autoLink:ln,autoSync:cn,placeholder:un,buttons:dn,toolbar:hn,linkDialog:pn,linkPopover:fn,imageDialog:mn,imagePopover:gn,tablePopover:vn,videoDialog:yn,helpDialog:bn,airPopover:Cn},buttons:{},lang:"en-US",followingToolbar:!0,otherStaticBar:"",toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],popatmouse:!0,popover:{image:[["imagesize",["imageSize100","imageSize50","imageSize25"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]],table:[["add",["addRowDown","addRowUp","addColLeft","addColRight"]],["delete",["deleteRow","deleteCol","deleteTable"]]],air:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]]},airMode:!1,width:null,height:null,linkTargetBlank:!0,focus:!1,tabSize:4,styleWithSpan:!0,shortcuts:!0,textareaAutoSync:!0,hintDirection:"bottom",tooltip:"auto",container:"body",maxTextLength:0,styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontSizes:["8","9","10","11","12","13","14","15","16","17","18","24","36","42","48","50"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],tableClassName:"table table-bordered",insertTableMaxSize:{col:10,row:10},dialogsInBody:!1,dialogsFade:!1,maximumImageFileSize:null,callbacks:{onInit:null,onFocus:null,onBlur:null,onBlurCodeview:null,onEnter:null,onKeyup:null,onKeydown:null,onImageUpload:null,onImageUploadError:null},codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"linkDialog.show"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"linkDialog.show"}},icons:{align:"note-icon-align",alignCenter:"note-icon-align-center",alignJustify:"note-icon-align-justify",alignLeft:"note-icon-align-left",alignRight:"note-icon-align-right",rowBelow:"note-icon-row-below",colBefore:"note-icon-col-before",colAfter:"note-icon-col-after",rowAbove:"note-icon-row-above",rowRemove:"note-icon-row-remove",colRemove:"note-icon-col-remove",indent:"note-icon-align-indent",outdent:"note-icon-align-outdent",arrowsAlt:"note-icon-arrows-alt",bold:"note-icon-bold",caret:"note-icon-caret",circle:"note-icon-circle",close:"note-icon-close",code:"note-icon-code",eraser:"note-icon-eraser",font:"note-icon-font",frame:"note-icon-frame",italic:"note-icon-italic",link:"note-icon-link",unlink:"note-icon-chain-broken",magic:"note-icon-magic",menuCheck:"note-icon-menu-check",minus:"note-icon-minus",orderedlist:"note-icon-orderedlist",pencil:"note-icon-pencil",picture:"note-icon-picture",question:"note-icon-question",redo:"note-icon-redo",square:"note-icon-square",strikethrough:"note-icon-strikethrough",subscript:"note-icon-subscript",superscript:"note-icon-superscript",table:"note-icon-table",textHeight:"note-icon-text-height",trash:"note-icon-trash",underline:"note-icon-underline",undo:"note-icon-undo",unorderedlist:"note-icon-unorderedlist",video:"note-icon-video"}}})}),angular.module("summernote",[]).controller("SummernoteController",["$scope","$attrs","$timeout",function(e,t,n){"use strict";var o,i=angular.copy(e.summernoteConfig)||{};if(angular.isDefined(t.height)&&(i.height=+t.height),angular.isDefined(t.minHeight)&&(i.minHeight=+t.minHeight),angular.isDefined(t.maxHeight)&&(i.maxHeight=+t.maxHeight),angular.isDefined(t.placeholder)&&(i.placeholder=t.placeholder),angular.isDefined(t.focus)&&(i.focus=!0),angular.isDefined(t.airmode)&&(i.airMode=!0),angular.isDefined(t.dialogsinbody)&&(i.dialogsInBody=!0),angular.isDefined(t.lang)){if(!angular.isDefined($.summernote.lang[t.lang]))throw new Error('"'+t.lang+'" lang file must be exist.');i.lang=t.lang}i.callbacks=i.callbacks||{},angular.isDefined(t.onInit)&&(i.callbacks.onInit=function(t){e.init({evt:t})}),angular.isDefined(t.onEnter)&&(i.callbacks.onEnter=function(t){e.enter({evt:t})}),angular.isDefined(t.onFocus)&&(i.callbacks.onFocus=function(t){e.focus({evt:t})}),angular.isDefined(t.onPaste)&&(i.callbacks.onPaste=function(t){e.paste({evt:t})}),angular.isDefined(t.onKeyup)&&(i.callbacks.onKeyup=function(t){e.keyup({evt:t})}),angular.isDefined(t.onKeydown)&&(i.callbacks.onKeydown=function(t){e.keydown({evt:t})}),angular.isDefined(t.onImageUpload)&&(i.callbacks.onImageUpload=function(t){e.imageUpload({files:t,editable:e.editable})}),angular.isDefined(t.onMediaDelete)&&(i.callbacks.onMediaDelete=function(t){var n={attrs:{}};n.tagName=t[0].tagName,angular.forEach(t[0].attributes,function(e){n.attrs[e.name]=e.value}),e.mediaDelete({target:n})}),this.activate=function(r,s,a){var l=function(){var e=s.summernote("code");s.summernote("isEmpty")&&(e=""),a&&a.$viewValue!==e&&n(function(){a.$setViewValue(e)},0)},c=i.callbacks.onChange;i.callbacks.onChange=function(o){n(function(){s.summernote("isEmpty")&&(o=""),l()},0),angular.isDefined(t.onChange)?e.change({contents:o,editable:e.editable}):angular.isFunction(c)&&c.apply(this,arguments)},angular.isDefined(t.onBlur)&&(i.callbacks.onBlur=function(t){!i.airMode&&s.blur(),e.blur({evt:t})}),s.summernote(i);var u,d=s.next(".note-editor");d.find(".note-toolbar").click(function(){l(),d.hasClass("codeview")?(d.on("keyup",l),a&&(u=r.$watch(function(){return a.$modelValue},function(e){d.find(".note-codable").val(e)}))):(d.off("keyup",l),angular.isFunction(u)&&u())}),a&&(a.$render=function(){a.$viewValue?s.summernote("code",a.$viewValue):s.summernote("empty")}),angular.isDefined(t.editable)&&(e.editable=d.find(".note-editable")),angular.isDefined(t.editor)&&(e.editor=s),o=s,s.on("$destroy",function(){s.summernote("destroy"),e.summernoteDestroyed=!0})},e.$on("$destroy",function(){e.summernoteDestroyed||o.summernote("destroy")})}]).directive("summernote",[function(){"use strict";return{restrict:"EA",transclude:"element",replace:!0,require:["summernote","?ngModel"],controller:"SummernoteController",scope:{summernoteConfig:"=config",editable:"=",editor:"=",init:"&onInit",enter:"&onEnter",focus:"&onFocus",blur:"&onBlur",paste:"&onPaste",keyup:"&onKeyup",keydown:"&onKeydown",change:"&onChange",imageUpload:"&onImageUpload",mediaDelete:"&onMediaDelete"},template:'<div class="summernote"></div>',link:function(e,t,n,o,i){var r=o[0],s=o[1];if(s)var a=e.$watch(function(){return s.$viewValue},function(n){a(),t.append(n),r.activate(e,t,s)},!0);else i(e,function(e){t.append(e.html())}),r.activate(e,t,s)}}}]),define("ace/keyboard/vim",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/dom","ace/lib/oop","ace/lib/keys","ace/lib/event","ace/search","ace/lib/useragent","ace/search_highlight","ace/commands/multi_select_commands","ace/mode/text","ace/multi_select"],function(e,t){"use strict";function n(e){return{row:e.line,column:e.ch}}function o(e){return new Tt(e.row,e.column)}function i(e){e.setOption("disableInput",!0),e.setOption("showCursorWhenSelecting",!1),St.signal(e,"vim-mode-change",{mode:"normal"}),e.on("cursorActivity",nt),_(e),St.on(e.getInputField(),"paste",u(e))}function r(e){e.setOption("disableInput",!1),e.off("cursorActivity",nt),St.off(e.getInputField(),"paste",u(e)),e.state.vim=null}function s(e,t){this==St.keyMap.vim&&St.rmClass(e.getWrapperElement(),"cm-fat-cursor"),t&&t.attach==a||r(e)}function a(e,t){this==St.keyMap.vim&&St.addClass(e.getWrapperElement(),"cm-fat-cursor"),t&&t.attach==a||i(e)}function l(e,t){if(!t)return undefined;var n=c(e);if(!n)return!1;var o=St.Vim.findKey(t,n);return"function"==typeof o&&St.signal(t,"vim-keypress",n),o}function c(e){if("'"==e.charAt(0))return e.charAt(1);var t=e.split(/-(?!$)/),n=t[t.length-1];if(1==t.length&&1==t[0].length)return!1;if(2==t.length&&"Shift"==t[0]&&1==n.length)return!1;for(var o=!1,i=0;i<t.length;i++){var r=t[i];r in At?t[i]=At[r]:o=!0,r in Mt&&(t[i]=Mt[r])}return!!o&&(g(n)&&(t[t.length-1]=n.toLowerCase()),"<"+t.join("-")+">")}function u(e){var t=e.state.vim;return t.onPasteFn||(t.onPasteFn=function(){t.insertMode||(e.setCursor(N(e.getCursor(),0,1)),Gt.enterInsertMode(e,{},t))}),t.onPasteFn}function d(e,t){for(var n=[],o=e;o<e+t;o++)n.push(String.fromCharCode(o));return n}function h(e,t){return t>=e.firstLine()&&t<=e.lastLine()}function p(e){return/^[a-z]$/.test(e)}function f(e){return-1!="()[]{}".indexOf(e)}function m(e){return It.test(e)}function g(e){return/^[A-Z]$/.test(e)}function v(e){return/^\s*$/.test(e)}function y(e,t){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1}function b(e,t,n,o,i){if(t===undefined&&!i)throw Error("defaultValue is required unless callback is provided");if(n||(n="string"),Bt[e]={type:n,defaultValue:t,callback:i},o)for(var r=0;r<o.length;r++)Bt[o[r]]=Bt[e];t&&w(e,t)}function w(e,t,n,o){var i=Bt[e];o=o||{};var r=o.scope;if(!i)throw Error("Unknown option: "+e);if("boolean"==i.type){if(t&&!0!==t)throw Error("Invalid argument: "+e+"="+t);!1!==t&&(t=!0)}i.callback?("local"!==r&&i.callback(t,undefined),"global"!==r&&n&&i.callback(t,n)):("local"!==r&&(i.value="boolean"==i.type?!!t:t),"global"!==r&&n&&(n.state.vim.options[e]={value:t}))}function C(e,t,n){var o=Bt[e];n=n||{};var i=n.scope;if(!o)throw Error("Unknown option: "+e);if(!o.callback){var r="global"!==i&&t&&t.state.vim.options[e];return(r||"local"!==i&&o||{}).value}var r=t&&o.callback(undefined,t);if("global"!==i&&r!==undefined)return r;if("local"!==i)return o.callback()}function k(){this.latestRegister=undefined,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=undefined,this.lastInsertModeChanges=jt()}function _(e){return e.state.vim||(e.state.vim={inputState:new x,lastEditInputState:undefined,lastEditActionCommand:undefined,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:!1,insertModeRepeat:undefined,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{}}),e.state.vim}function S(){Ut={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:undefined,jumpList:Ft(),macroModeState:new k,lastChararacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new A({}),searchHistoryController:new M,exCommandHistoryController:new M};for(var e in Bt){var t=Bt[e];t.value=t.defaultValue}}function x(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null}function $(e,t){e.state.vim.inputState=new x,St.signal(e,"vim-command-done",t)}function T(e,t,n){this.clear(),this.keyBuffer=[e||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!t,this.blockwise=!!n}function E(e,t){var n=Ut.registerController.registers[e];if(!e||1!=e.length)throw Error("Register name must be 1 character");n[e]=t,Ht.push(e)}function A(e){this.registers=e,this.unnamedRegister=e['"']=new T,e["."]=new T,e[":"]=new T,e["/"]=new T}function M(){this.historyBuffer=[],this.iterator,this.initialPrefix=null}function I(e,t){Wt[e]=t}function O(e,t){for(var n=[],o=0;o<t;o++)n.push(e);return n}function R(e,t){Vt[e]=t}function L(e,t){Gt[e]=t}function P(e,t,n){var o=Math.min(Math.max(e.firstLine(),t.line),e.lastLine()),i=Y(e,o)-1;i=n?i+1:i;var r=Math.min(Math.max(0,t.ch),i);return Tt(o,r)}function D(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function N(e,t,n){return"object"==typeof t&&(n=t.ch,t=t.line),Tt(e.line+t,e.ch+n)}function H(e,t){return{line:t.line-e.line,ch:t.line-e.line}}function B(e,t,n,o){for(var i,r=[],s=[],a=0;a<t.length;a++){var l=t[a];"insert"==n&&"insert"!=l.context||l.context&&l.context!=n||o.operator&&"action"==l.type||!(i=F(e,l.keys))||("partial"==i&&r.push(l),"full"==i&&s.push(l))}return{partial:r.length&&r,full:s.length&&s}}function F(e,t){if("<character>"==t.slice(-11)){var n=t.length-11,o=e.slice(0,n),i=t.slice(0,n);return o==i&&e.length>n?"full":0==i.indexOf(o)&&"partial"}return e==t?"full":0==t.indexOf(e)&&"partial"}function j(e){var t=/^.*(<[\w\-]+>)$/.exec(e),n=t?t[1]:e.slice(-1);if(n.length>1)switch(n){case"<CR>":n="\n";break;case"<Space>":n=" "}return n}function U(e,t,n){return function(){for(var o=0;o<n;o++)t(e)}}function q(e){return Tt(e.line,e.ch)}function z(e,t){return e.ch==t.ch&&e.line==t.line}function K(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function W(e,t){return arguments.length>2&&(t=W.apply(undefined,Array.prototype.slice.call(arguments,1))),K(e,t)?e:t}function V(e,t){return arguments.length>2&&(t=V.apply(undefined,Array.prototype.slice.call(arguments,1))),K(e,t)?t:e}function G(e,t,n){var o=K(e,t),i=K(t,n);return o&&i}function Y(e,t){return e.getLine(t).length}function Q(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function J(e){return e.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function X(e,t,n){var o=Y(e,t),i=new Array(n-o+1).join(" ");e.setCursor(Tt(t,o)),e.replaceRange(i,e.getCursor())}function Z(e,t){var n=[],o=e.listSelections(),i=q(e.clipPos(t)),r=!z(t,i),s=e.getCursor("head"),a=te(o,s),l=z(o[a].head,o[a].anchor),c=o.length-1,u=c-a>a?c:0,d=o[u].anchor,h=Math.min(d.line,i.line),p=Math.max(d.line,i.line),f=d.ch,m=i.ch,g=o[u].head.ch-f,v=m-f;g>0&&v<=0?(f++,r||m--):g<0&&v>=0?(f--,l||m++):g<0&&-1==v&&(f--,m++);for(var y=h;y<=p;y++){var b={anchor:new Tt(y,f),head:new Tt(y,m)};n.push(b)}return a=i.line==p?n.length-1:0,e.setSelections(n),t.ch=m,d.ch=f,d}function ee(e,t,n){for(var o=[],i=0;i<n;i++){var r=N(t,i,0);o.push({anchor:r,head:r})}e.setSelections(o,0)}function te(e,t,n){for(var o=0;o<e.length;o++){var i="head"!=n&&z(e[o].anchor,t),r="anchor"!=n&&z(e[o].head,t);if(i||r)return o}return-1}function ne(e,t){var n=t.lastSelection,o=function(){var t=e.listSelections(),n=t[0],o=t[t.length-1];return[K(n.anchor,n.head)?n.anchor:n.head,K(o.anchor,o.head)?o.head:o.anchor]},i=function(){var t=e.getCursor(),o=e.getCursor(),i=n.visualBlock;if(i){var r=i.width,s=i.height;o=Tt(t.line+s,t.ch+r);for(var a=[],l=t.line;l<o.line;l++){var c=Tt(l,t.ch),u=Tt(l,o.ch),d={anchor:c,head:u};a.push(d)}e.setSelections(a)}else{var h=n.anchorMark.find(),p=n.headMark.find(),f=p.line-h.line,m=p.ch-h.ch;o={line:o.line+f,ch:f?o.ch:m+o.ch},n.visualLine&&(t=Tt(t.line,0),o=Tt(o.line,Y(e,o.line))),e.setSelection(t,o)}return[t,o]};return t.visualMode?o():i()}function oe(e,t){var n=t.sel.anchor,o=t.sel.head;t.lastPastedText&&(o=e.posFromIndex(e.indexFromPos(n)+t.lastPastedText.length),t.lastPastedText=null),t.lastSelection={anchorMark:e.setBookmark(n),headMark:e.setBookmark(o),anchor:q(n),head:q(o),visualMode:t.visualMode,visualLine:t.visualLine,visualBlock:t.visualBlock}}function ie(e,t,n){var o,i=e.state.vim.sel,r=i.head,s=i.anchor;return K(n,t)&&(o=n,n=t,t=o),K(r,s)?(r=W(t,r),s=V(s,n)):(s=W(t,s),r=V(r,n),r=N(r,0,-1),-1==r.ch&&r.line!=e.firstLine()&&(r=Tt(r.line-1,Y(e,r.line-1)))),[s,r]}function re(e,t,n){var o=e.state.vim;t=t||o.sel;var n=n||o.visualLine?"line":o.visualBlock?"block":"char",i=se(e,t,n);e.setSelections(i.ranges,i.primary),ot(e)}function se(e,t,n,o){var i=q(t.head),r=q(t.anchor);if("char"==n){var s=o||K(t.head,t.anchor)?0:1,a=K(t.head,t.anchor)?1:0;return i=N(t.head,0,s),r=N(t.anchor,0,a),{ranges:[{anchor:r,head:i}],primary:0}}if("line"==n){if(K(t.head,t.anchor))i.ch=0,r.ch=Y(e,r.line);else{r.ch=0;var l=e.lastLine();i.line>l&&(i.line=l),i.ch=Y(e,i.line)}return{ranges:[{anchor:r,head:i}],primary:0}}if("block"==n){for(var c=Math.min(r.line,i.line),u=Math.min(r.ch,i.ch),d=Math.max(r.line,i.line),h=Math.max(r.ch,i.ch)+1,p=d-c+1,f=i.line==c?0:p-1,m=[],g=0;g<p;g++)m.push({anchor:Tt(c+g,u),head:Tt(c+g,h)});return{ranges:m,primary:f}}}function ae(e){var t=e.getCursor("head");return 1==e.getSelection().length&&(t=W(t,e.getCursor("anchor"))),t}function le(e,t){var n=e.state.vim;!1!==t&&e.setCursor(P(e,n.sel.head)),oe(e,n),n.visualMode=!1,n.visualLine=!1,n.visualBlock=!1,St.signal(e,"vim-mode-change",{mode:"normal"}),n.fakeCursor&&n.fakeCursor.clear()}function ce(e,t,n){var o=e.getRange(t,n);if(/\n\s*$/.test(o)){var i=o.split("\n");i.pop();for(var r,r=i.pop();i.length>0&&r&&v(r);r=i.pop())n.line--,n.ch=0;r?(n.line--,n.ch=Y(e,n.line)):n.ch=0}}function ue(e,t,n){t.ch=0,n.ch=0,n.line++}function de(e){if(!e)return 0;var t=e.search(/\S/);return-1==t?e.length:t}function he(e,t,n,o,i){for(var r=ae(e),s=e.getLine(r.line),a=r.ch,l=i?Ot[0]:Rt[0];!l(s.charAt(a));)if(++a>=s.length)return null;o?l=Rt[0]:(l=Ot[0])(s.charAt(a))||(l=Ot[1]);for(var c=a,u=a;l(s.charAt(c))&&c<s.length;)c++;for(;l(s.charAt(u))&&u>=0;)u--;if(u++,t){
for(var d=c;/\s/.test(s.charAt(c))&&c<s.length;)c++;if(d==c){for(var h=u;/\s/.test(s.charAt(u-1))&&u>0;)u--;u||(u=h)}}return{start:Tt(r.line,u),end:Tt(r.line,c)}}function pe(e,t,n){z(t,n)||Ut.jumpList.add(e,t,n)}function fe(e,t){Ut.lastChararacterSearch.increment=e,Ut.lastChararacterSearch.forward=t.forward,Ut.lastChararacterSearch.selectedCharacter=t.selectedCharacter}function me(e,t,n,o){var i=q(e.getCursor()),r=n?1:-1,s=n?e.lineCount():-1,a=i.ch,l=i.line,c=e.getLine(l),u={lineText:c,nextCh:c.charAt(a),lastCh:null,index:a,symb:o,reverseSymb:(n?{")":"(","}":"{"}:{"(":")","{":"}"})[o],forward:n,depth:0,curMoveThrough:!1},d=Yt[o];if(!d)return i;var h=Qt[d].init,p=Qt[d].isComplete;for(h&&h(u);l!==s&&t;){if(u.index+=r,u.nextCh=u.lineText.charAt(u.index),!u.nextCh){if(l+=r,u.lineText=e.getLine(l)||"",r>0)u.index=0;else{var f=u.lineText.length;u.index=f>0?f-1:0}u.nextCh=u.lineText.charAt(u.index)}p(u)&&(i.line=l,i.ch=u.index,t--)}return u.nextCh||u.curMoveThrough?Tt(l,u.index):i}function ge(e,t,n,o,i){var r=t.line,s=t.ch,a=e.getLine(r),l=n?1:-1,c=o?Rt:Ot;if(i&&""==a){if(r+=l,a=e.getLine(r),!h(e,r))return null;s=n?0:a.length}for(;;){if(i&&""==a)return{from:0,to:0,line:r};for(var u=l>0?a.length:-1,d=u,p=u;s!=u;){for(var f=!1,m=0;m<c.length&&!f;++m)if(c[m](a.charAt(s))){for(d=s;s!=u&&c[m](a.charAt(s));)s+=l;if(p=s,f=d!=p,d==t.ch&&r==t.line&&p==d+l)continue;return{from:Math.min(d,p+1),to:Math.max(d,p),line:r}}f||(s+=l)}if(r+=l,!h(e,r))return null;a=e.getLine(r),s=l>0?0:a.length}throw new Error("The impossible happened.")}function ve(e,t,n,o,i,r){var s=q(t),a=[];(o&&!i||!o&&i)&&n++;for(var l=!(o&&i),c=0;c<n;c++){var u=ge(e,t,o,r,l);if(!u){var d=Y(e,e.lastLine());a.push(o?{line:e.lastLine(),from:d,to:d}:{line:0,from:0,to:0});break}a.push(u),t=Tt(u.line,o?u.to-1:u.from)}var h=a.length!=n,p=a[0],f=a.pop();return o&&!i?(h||p.from==s.ch&&p.line==s.line||(f=a.pop()),Tt(f.line,f.from)):o&&i?Tt(f.line,f.to-1):!o&&i?(h||p.to==s.ch&&p.line==s.line||(f=a.pop()),Tt(f.line,f.to)):Tt(f.line,f.from)}function ye(e,t,n,o){for(var i,r=e.getCursor(),s=r.ch,a=0;a<t;a++){if(-1==(i=Ce(s,e.getLine(r.line),o,n,!0)))return null;s=i}return Tt(e.getCursor().line,i)}function be(e,t){var n=e.getCursor().line;return P(e,Tt(n,t-1))}function we(e,t,n,o){y(n,Nt)&&(t.marks[n]&&t.marks[n].clear(),t.marks[n]=e.setBookmark(o))}function Ce(e,t,n,o,i){var r;return o?-1==(r=t.indexOf(n,e+1))||i||(r-=1):-1==(r=t.lastIndexOf(n,e-1))||i||(r+=1),r}function ke(e,t,n,o,i){function r(t){return!/\S/.test(e.getLine(t))}function s(e,t,n){return n?r(e)!=r(e+t):!r(e)&&r(e+t)}function a(t){o=o>0?1:-1;var n=e.ace.session.getFoldLine(t);n&&t+o>n.start.row&&t+o<n.end.row&&(o=(o>0?n.end.row:n.start.row)-t)}var l,c,u=t.line,d=e.firstLine(),h=e.lastLine(),p=u;if(o){for(;d<=p&&p<=h&&n>0;)a(p),s(p,o)&&n--,p+=o;return new Tt(p,0)}var f=e.state.vim;if(f.visualLine&&s(u,1,!0)){var m=f.sel.anchor;s(m.line,-1,!0)&&(i&&m.line==u||(u+=1))}var g=r(u);for(p=u;p<=h&&n;p++)s(p,1,!0)&&(i&&r(p)==g||n--);for(c=new Tt(p,0),p>h&&!g?g=!0:i=!1,p=u;p>d&&(i&&r(p)!=g&&p!=u||!s(p,-1,!0));p--);return l=new Tt(p,0),{start:l,end:c}}function _e(e,t,n,o){var i,r,s=t,a={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/}[n],l={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{"}[n],c=e.getLine(s.line).charAt(s.ch),u=c===l?1:0;if(i=e.scanForBracket(Tt(s.line,s.ch+u),-1,null,{bracketRegex:a}),r=e.scanForBracket(Tt(s.line,s.ch+u),1,null,{bracketRegex:a}),!i||!r)return{start:s,end:s};if(i=i.pos,r=r.pos,i.line==r.line&&i.ch>r.ch||i.line>r.line){var d=i;i=r,r=d}return o?r.ch+=1:i.ch+=1,{start:i,end:r}}function Se(e,t,n,o){var i,r,s,a,l=q(t),c=e.getLine(l.line),u=c.split(""),d=u.indexOf(n);if(l.ch<d?l.ch=d:d<l.ch&&u[l.ch]==n&&(r=l.ch,--l.ch),u[l.ch]!=n||r)for(s=l.ch;s>-1&&!i;s--)u[s]==n&&(i=s+1);else i=l.ch+1;if(i&&!r)for(s=i,a=u.length;s<a&&!r;s++)u[s]==n&&(r=s);return i&&r?(o&&(--i,++r),{start:Tt(l.line,i),end:Tt(l.line,r)}):{start:l,end:l}}function xe(){}function $e(e){var t=e.state.vim;return t.searchState_||(t.searchState_=new xe)}function Te(e,t,n,o,i){e.openDialog?e.openDialog(t,o,{bottom:!0,value:i.value,onKeyDown:i.onKeyDown,onKeyUp:i.onKeyUp,selectValueOnOpen:!1}):o(prompt(n,""))}function Ee(e){return Me(e,"/")}function Ae(e){return Ie(e,"/")}function Me(e,t){var n=Ie(e,t)||[];if(!n.length)return[];var o=[];if(0===n[0]){for(var i=0;i<n.length;i++)"number"==typeof n[i]&&o.push(e.substring(n[i]+1,n[i+1]));return o}}function Ie(e,t){t||(t="/");for(var n=!1,o=[],i=0;i<e.length;i++){var r=e.charAt(i);n||r!=t||o.push(i),n=!n&&"\\"==r}return o}function Oe(e){for(var t="|(){",n="}",o=!1,i=[],r=-1;r<e.length;r++){var s=e.charAt(r)||"",a=e.charAt(r+1)||"",l=a&&-1!=t.indexOf(a);o?("\\"===s&&l||i.push(s),o=!1):"\\"===s?(o=!0,a&&-1!=n.indexOf(a)&&(l=!0),l&&"\\"!==a||i.push(s)):(i.push(s),l&&"\\"!==a&&i.push("\\"))}return i.join("")}function Re(e){for(var t=!1,n=[],o=-1;o<e.length;o++){var i=e.charAt(o)||"",r=e.charAt(o+1)||"";Jt[i+r]?(n.push(Jt[i+r]),o++):t?(n.push(i),t=!1):"\\"===i?(t=!0,m(r)||"$"===r?n.push("$"):"/"!==r&&"\\"!==r&&n.push("\\")):("$"===i&&n.push("$"),n.push(i),"/"===r&&n.push("\\"))}return n.join("")}function Le(e){for(var t=new St.StringStream(e),n=[];!t.eol();){for(;t.peek()&&"\\"!=t.peek();)n.push(t.next());var o=!1;for(var i in Xt)if(t.match(i,!0)){o=!0,n.push(Xt[i]);break}o||n.push(t.next())}return n.join("")}function Pe(e,t,n){if(Ut.registerController.getRegister("/").setText(e),e instanceof RegExp)return e;var o,i,r=Ae(e);if(r.length){o=e.substring(0,r[0]);i=-1!=e.substring(r[0]).indexOf("i")}else o=e;return o?(C("pcre")||(o=Oe(o)),n&&(t=/^[^A-Z]*$/.test(o)),new RegExp(o,t||i?"i":undefined)):null}function De(e,t){e.openNotification?e.openNotification('<span style="color: red">'+t+"</span>",{bottom:!0,duration:5e3}):alert(t)}function Ne(e,t){var n="";return e&&(n+='<span style="font-family: monospace">'+e+"</span>"),n+='<input type="text"/> <span style="color: #888">',t&&(n+='<span style="color: #888">',n+=t,n+="</span>"),n}function He(e,t){var n=(t.prefix||"")+" "+(t.desc||"");Te(e,Ne(t.prefix,t.desc),n,t.onClose,t)}function Be(e,t){if(e instanceof RegExp&&t instanceof RegExp){for(var n=["global","multiline","ignoreCase","source"],o=0;o<n.length;o++){var i=n[o];if(e[i]!==t[i])return!1}return!0}return!1}function Fe(e,t,n,o){if(t){var i=$e(e),r=Pe(t,!!n,!!o);if(r)return Ue(e,r),Be(r,i.getQuery())?r:(i.setQuery(r),r)}}function je(e){if("^"==e.source.charAt(0))var t=!0;return{token:function(n){if(t&&!n.sol())return void n.skipToEnd();var o=n.match(e,!1);if(o)return 0==o[0].length?(n.next(),"searching"):n.sol()||(n.backUp(1),e.exec(n.next()+o[0]))?(n.match(e),"searching"):(n.next(),null);for(;!n.eol()&&(n.next(),!n.match(e,!1)););},query:e}}function Ue(e,t){var n=$e(e),o=n.getOverlay();o&&t==o.query||(o&&e.removeOverlay(o),o=je(t),e.addOverlay(o),e.showMatchesOnScrollbar&&(n.getScrollbarAnnotate()&&n.getScrollbarAnnotate().clear(),n.setScrollbarAnnotate(e.showMatchesOnScrollbar(t))),n.setOverlay(o))}function qe(e,t,n,o){return o===undefined&&(o=1),e.operation(function(){for(var i=e.getCursor(),r=e.getSearchCursor(n,i),s=0;s<o;s++){var a=r.find(t);if(0==s&&a&&z(r.from(),i)&&(a=r.find(t)),!a&&(r=e.getSearchCursor(n,t?Tt(e.lastLine()):Tt(e.firstLine(),0)),!r.find(t)))return}return r.from()})}function ze(e){var t=$e(e);e.removeOverlay($e(e).getOverlay()),t.setOverlay(null),t.getScrollbarAnnotate()&&(t.getScrollbarAnnotate().clear(),t.setScrollbarAnnotate(null))}function Ke(e,t,n){return"number"!=typeof e&&(e=e.line),t instanceof Array?y(e,t):n?e>=t&&e<=n:e==t}function We(e){var t=e.ace.renderer;return{top:t.getFirstFullyVisibleRow(),bottom:t.getLastFullyVisibleRow()}}function Ve(e,t,n,o,i,r,s,a,l){function c(){e.operation(function(){for(;!f;)u(),d();h()})}function u(){var t=e.getRange(r.from(),r.to()),n=t.replace(s,a);r.replace(n)}function d(){for(;r.findNext()&&Ke(r.from(),o,i);)if(n||!m||r.from().line!=m.line)return e.scrollIntoView(r.from(),30),e.setSelection(r.from(),r.to()),m=r.from(),void(f=!1);f=!0}function h(t){if(t&&t(),e.focus(),m){e.setCursor(m);var n=e.state.vim;n.exMode=!1,n.lastHPos=n.lastHSPos=m.ch}l&&l()}function p(t,n,o){switch(St.e_stop(t),St.keyName(t)){case"Y":u(),d();break;case"N":d();break;case"A":var i=l;l=undefined,e.operation(c),l=i;break;case"L":u();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":h(o)}return f&&h(o),!0}e.state.vim.exMode=!0;var f=!1,m=r.from();return d(),f?void De(e,"No matches for "+s.source):t?void He(e,{prefix:"replace with <strong>"+a+"</strong> (y/n/a/q/l)",onKeyDown:p}):(c(),void(l&&l()))}function Ge(e){var t=e.state.vim,n=Ut.macroModeState,o=Ut.registerController.getRegister("."),i=n.isPlaying,r=n.lastInsertModeChanges,s=[];if(!i){for(var a=r.inVisualBlock?t.lastSelection.visualBlock.height:1,l=r.changes,s=[],c=0;c<l.length;)s.push(l[c]),l[c]instanceof rt?c++:c+=a;r.changes=s,e.off("change",tt),St.off(e.getInputField(),"keydown",st)}!i&&t.insertModeRepeat>1&&(at(e,t,t.insertModeRepeat-1,!0),t.lastEditInputState.repeatOverride=t.insertModeRepeat),delete t.insertModeRepeat,t.insertMode=!1,e.setCursor(e.getCursor().line,e.getCursor().ch-1),e.setOption("keyMap","vim"),e.setOption("disableInput",!0),r.overwrite=e.state.overwrite,e.toggleOverwrite(!1),o.setText(r.changes.join("")),St.signal(e,"vim-mode-change",{mode:"normal"}),n.isRecording&&Ze(n)}function Ye(e){xt.unshift(e)}function Qe(e,t,n,o,i){var r={keys:e,type:t};r[t]=n,r[t+"Args"]=o;for(var s in i)r[s]=i[s];Ye(r)}function Je(e,t,n,o){var i=Ut.registerController.getRegister(o);if(":"==o)return i.keyBuffer[0]&&nn.processCommand(e,i.keyBuffer[0]),void(n.isPlaying=!1);var r=i.keyBuffer,s=0;n.isPlaying=!0,n.replaySearchQueries=i.searchQueries.slice(0);for(var a=0;a<r.length;a++)for(var l,c,u=r[a];u;)if(l=/<\w+-.+?>|<\w+>|./.exec(u),c=l[0],u=u.substring(l.index+c.length),St.Vim.handleKey(e,c,"macro"),t.insertMode){var d=i.insertModeChanges[s++].changes;Ut.macroModeState.lastInsertModeChanges.changes=d,lt(e,d,1),Ge(e)}n.isPlaying=!1}function Xe(e,t){if(!e.isPlaying){var n=e.latestRegister,o=Ut.registerController.getRegister(n);o&&o.pushText(t)}}function Ze(e){if(!e.isPlaying){var t=e.latestRegister,n=Ut.registerController.getRegister(t);n&&n.pushInsertModeChanges&&n.pushInsertModeChanges(e.lastInsertModeChanges)}}function et(e,t){if(!e.isPlaying){var n=e.latestRegister,o=Ut.registerController.getRegister(n);o&&o.pushSearchQuery&&o.pushSearchQuery(t)}}function tt(e,t){var n=Ut.macroModeState,o=n.lastInsertModeChanges;if(!n.isPlaying)for(;t;){if(o.expectCursorActivityForChange=!0,"+input"==t.origin||"paste"==t.origin||t.origin===undefined){var i=t.text.join("\n");o.maybeReset&&(o.changes=[],o.maybeReset=!1),o.changes.push(i)}t=t.next}}function nt(e){var t=e.state.vim;if(t.insertMode){var n=Ut.macroModeState;if(n.isPlaying)return;var o=n.lastInsertModeChanges;o.expectCursorActivityForChange?o.expectCursorActivityForChange=!1:o.maybeReset=!0}else e.curOp.isVimOp||it(e,t);t.visualMode&&ot(e)}function ot(e){var t=e.state.vim,n=P(e,q(t.sel.head)),o=N(n,0,1);t.fakeCursor&&t.fakeCursor.clear(),t.fakeCursor=e.markText(n,o,{className:"cm-animate-fat-cursor"})}function it(e,t){var n=e.getCursor("anchor"),o=e.getCursor("head");if(t.visualMode&&!e.somethingSelected()?le(e,!1):t.visualMode||t.insertMode||!e.somethingSelected()||(t.visualMode=!0,t.visualLine=!1,St.signal(e,"vim-mode-change",{mode:"visual"})),t.visualMode){var i=K(o,n)?0:-1,r=K(o,n)?-1:0;o=N(o,0,i),n=N(n,0,r),t.sel={anchor:n,head:o},we(e,t,"<",W(o,n)),we(e,t,">",V(o,n))}else t.insertMode||(t.lastHPos=e.getCursor().ch)}function rt(e){this.keyName=e}function st(e){function t(){return o.maybeReset&&(o.changes=[],o.maybeReset=!1),o.changes.push(new rt(i)),!0}var n=Ut.macroModeState,o=n.lastInsertModeChanges,i=St.keyName(e);i&&(-1==i.indexOf("Delete")&&-1==i.indexOf("Backspace")||St.lookupKey(i,"vim-insert",t))}function at(e,t,n,o){function i(){a?Kt.processAction(e,t,t.lastEditActionCommand):Kt.evalInput(e,t)}function r(n){if(s.lastInsertModeChanges.changes.length>0){n=t.lastEditActionCommand?n:1;var o=s.lastInsertModeChanges;lt(e,o.changes,n,o.overwrite)}}var s=Ut.macroModeState;s.isPlaying=!0;var a=!!t.lastEditActionCommand,l=t.inputState;if(t.inputState=t.lastEditInputState,a&&t.lastEditActionCommand.interlaceInsertRepeat)for(var c=0;c<n;c++)i(),r(1);else o||i(),r(n);t.inputState=l,t.insertMode&&!o&&Ge(e),s.isPlaying=!1}function lt(e,t,n,o){function i(t){return"string"==typeof t?St.commands[t](e):t(e),!0}var r=e.getCursor("head"),s=Ut.macroModeState.lastInsertModeChanges.inVisualBlock;if(s){var a=e.state.vim,l=a.lastSelection,c=H(l.anchor,l.head);ee(e,r,c.line+1),n=e.listSelections().length,e.setCursor(r)}for(var u=0;u<n;u++){s&&e.setCursor(N(r,u,0));for(var d=0;d<t.length;d++){var h=t[d];if(h instanceof rt)St.lookupKey(h.keyName,"vim-insert",i);else{var p=e.getCursor(),f=p;o&&!/\n/.test(h)&&(f=N(p,0,h.length)),e.replaceRange(h,p,f)}}}s&&e.setCursor(N(r,0,1))}function ct(e,t,n){t.length>1&&"n"==t[0]&&(t=t.replace("numpad","")),t=on[t]||t;var o="";return n.ctrlKey&&(o+="C-"),n.altKey&&(o+="A-"),n.shiftKey&&(o+="S-"),o+=t,o.length>1&&(o="<"+o+">"),o}function ut(e){var t=new e.constructor;return Object.keys(e).forEach(function(n){var o=e[n];Array.isArray(o)?o=o.slice():o&&"object"==typeof o&&o.constructor!=Object&&(o=ut(o)),t[n]=o}),e.sel&&(t.sel={head:e.sel.head&&q(e.sel.head),anchor:e.sel.anchor&&q(e.sel.anchor)}),t}function dt(e,t,n){var o=!1,i=Et.maybeInitVimState_(e),r=i.visualBlock||i.wasInVisualBlock;if(i.wasInVisualBlock&&!e.ace.inMultiSelectMode?i.wasInVisualBlock=!1:e.ace.inMultiSelectMode&&i.visualBlock&&(i.wasInVisualBlock=!0),"<Esc>"!=t||i.insertMode||i.visualMode||!e.ace.inMultiSelectMode)if(r||!e.ace.inMultiSelectMode||e.ace.inVirtualSelectionMode)o=Et.handleKey(e,t,n);else{var s=ut(i);e.operation(function(){e.ace.forEachSelection(function(){var i=e.ace.selection;e.state.vim.lastHPos=null==i.$desiredColumn?i.lead.column:i.$desiredColumn;var r=e.getCursor("head"),a=e.getCursor("anchor"),l=K(r,a)?0:-1,c=K(r,a)?-1:0;r=N(r,0,l),a=N(a,0,c),e.state.vim.sel.head=r,e.state.vim.sel.anchor=a,o=rn(e,t,n),i.$desiredColumn=-1==e.state.vim.lastHPos?null:e.state.vim.lastHPos,e.virtualSelectionMode()&&(e.state.vim=ut(s))}),e.curOp.cursorActivity&&!o&&(e.curOp.cursorActivity=!1)},!0)}else e.ace.exitMultiSelectMode();return o}function ht(e,t){t.off("beforeEndOperation",ht);var n=t.state.cm.vimCmd;n&&t.execCommand(n.exec?n:n.name,n.args),t.curOp=t.prevOp}var pt=e("../range").Range,ft=e("../lib/event_emitter").EventEmitter,mt=e("../lib/dom"),gt=e("../lib/oop"),vt=e("../lib/keys"),yt=e("../lib/event"),bt=e("../search").Search,wt=e("../lib/useragent"),Ct=e("../search_highlight").SearchHighlight,kt=e("../commands/multi_select_commands"),_t=e("../mode/text").Mode.prototype.tokenRe;e("../multi_select");var St=function(e){this.ace=e,this.state={},this.marks={},this.$uid=0,this.onChange=this.onChange.bind(this),this.onSelectionChange=this.onSelectionChange.bind(this),this.onBeforeEndOperation=this.onBeforeEndOperation.bind(this),this.ace.on("change",this.onChange),this.ace.on("changeSelection",this.onSelectionChange),this.ace.on("beforeEndOperation",this.onBeforeEndOperation)};St.Pos=function(e,t){if(!(this instanceof Tt))return new Tt(e,t);this.line=e,this.ch=t},St.defineOption=function(){},St.commands={redo:function(e){e.ace.redo()},undo:function(e){e.ace.undo()},newlineAndIndent:function(e){e.ace.insert("\n")}},St.keyMap={},St.addClass=St.rmClass=St.e_stop=function(){},St.keyName=function(e){if(e.key)return e.key;var t=vt[e.keyCode]||"";return 1==t.length&&(t=t.toUpperCase()),t=yt.getModifierString(e).replace(/(^|-)\w/g,function(e){return e.toUpperCase()})+t},St.keyMap["default"]=function(e){return function(t){var n=t.ace.commands.commandKeyBinding[e.toLowerCase()];return n&&!1!==t.ace.execCommand(n)}},St.lookupKey=function e(t,n,o){"string"==typeof n&&(n=St.keyMap[n]);var i="function"==typeof n?n(t):n[t];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&o(i))return"handled";if(n.fallthrough){if(!Array.isArray(n.fallthrough))return e(t,n.fallthrough,o);for(var r=0;r<n.fallthrough.length;r++){var s=e(t,n.fallthrough[r],o);if(s)return s}}},St.signal=function(e,t,n){return e._signal(t,n)},St.on=yt.addListener,St.off=yt.removeListener,St.isWordChar=function(e){return e<"\x7f"?/^\w$/.test(e):(_t.lastIndex=0,_t.test(e))},function(){gt.implement(St.prototype,ft),this.destroy=function(){this.ace.off("change",this.onChange),this.ace.off("changeSelection",this.onSelectionChange),this.ace.off("beforeEndOperation",this.onBeforeEndOperation),this.removeOverlay()},this.virtualSelectionMode=function(){return this.ace.inVirtualSelectionMode&&this.ace.selection.index},this.onChange=function(e){var t={text:"i"==e.action[0]?e.lines:[]},n=this.curOp=this.curOp||{};n.changeHandlers||(n.changeHandlers=this._eventRegistry.change&&this._eventRegistry.change.slice()),this.virtualSelectionMode()||(n.lastChange?n.lastChange.next=n.lastChange=t:n.lastChange=n.change=t,this.$updateMarkers(e))},this.onSelectionChange=function(){var e=this.curOp=this.curOp||{};e.cursorActivityHandlers||(e.cursorActivityHandlers=this._eventRegistry.cursorActivity&&this._eventRegistry.cursorActivity.slice()),this.curOp.cursorActivity=!0,this.ace.inMultiSelectMode&&this.ace.keyBinding.removeKeyboardHandler(kt.keyboardHandler)},this.operation=function(e,t){if(!t&&this.curOp||t&&this.curOp&&this.curOp.force)return e();if(!t&&this.ace.curOp||this.curOp&&this.onBeforeEndOperation(),!this.ace.curOp){var n=this.ace.prevOp;this.ace.startOperation({command:{name:"vim",scrollIntoView:"cursor"}})}var o=this.curOp=this.curOp||{};this.curOp.force=t;var i=e();return this.ace.curOp&&"vim"==this.ace.curOp.command.name&&(this.ace.endOperation(),o.cursorActivity||o.lastChange||!n||(this.ace.prevOp=n)),!t&&this.ace.curOp||this.curOp&&this.onBeforeEndOperation(),i},this.onBeforeEndOperation=function(){var e=this.curOp;e&&(e.change&&this.signal("change",e.change,e),e&&e.cursorActivity&&this.signal("cursorActivity",null,e),this.curOp=null)},this.signal=function(e,t,n){var o=n?n[e+"Handlers"]:(this._eventRegistry||{})[e];if(o){o=o.slice();for(var i=0;i<o.length;i++)o[i](this,t)}},this.firstLine=function(){return 0},this.lastLine=function(){return this.ace.session.getLength()-1},this.lineCount=function(){return this.ace.session.getLength()},this.setCursor=function(e,t){"object"==typeof e&&(t=e.ch,e=e.line),this.ace.inVirtualSelectionMode||this.ace.exitMultiSelectMode(),this.ace.session.unfold({row:e,column:t}),this.ace.selection.moveTo(e,t)},this.getCursor=function(e){var t=this.ace.selection;return o("anchor"==e?t.isEmpty()?t.lead:t.anchor:"head"!=e&&e?t.getRange()[e]:t.lead)},this.listSelections=function(){var e=this.ace.multiSelect.rangeList.ranges;return!e.length||this.ace.inVirtualSelectionMode?[{anchor:this.getCursor("anchor"),head:this.getCursor("head")}]:e.map(function(e){return{anchor:this.clipPos(o(e.cursor==e.end?e.start:e.end)),head:this.clipPos(o(e.cursor))}},this)},this.setSelections=function(e,t){var o=this.ace.multiSelect,i=e.map(function(e){var t=n(e.anchor),o=n(e.head),i=pt.comparePoints(t,o)<0?new pt.fromPoints(t,o):new pt.fromPoints(o,t);return i.cursor=pt.comparePoints(i.start,o)?i.end:i.start,i});if(this.ace.inVirtualSelectionMode)return void this.ace.selection.fromOrientedRange(i[0]);t?i[t]&&i.push(i.splice(t,1)[0]):i=i.reverse(),o.toSingleRange(i[0].clone());for(var r=this.ace.session,s=0;s<i.length;s++){var a=r.$clipRangeToDocument(i[s]);o.addRange(a)}},this.setSelection=function(e,t,n){var o=this.ace.selection;o.moveTo(e.line,e.ch),o.selectTo(t.line,t.ch),n&&"*mouse"==n.origin&&this.onBeforeEndOperation()},this.somethingSelected=function(){return!this.ace.selection.isEmpty()},this.clipPos=function(e){return o(this.ace.session.$clipPositionToDocument(e.line,e.ch))},this.markText=function(){return{clear:function(){},find:function(){}}},this.$updateMarkers=function(e){var t="insert"==e.action,n=e.start,o=e.end,i=(o.row-n.row)*(t?1:-1),r=(o.column-n.column)*(t?1:-1);t&&(o=n);for(var s in this.marks){var a=this.marks[s],l=pt.comparePoints(a,n);if(!(l<0)){if(0===l&&t){if(1!=a.bias){a.bias=-1;continue}l=1}var c=t?l:pt.comparePoints(a,o);c>0?(a.row+=i,a.column+=a.row==o.row?r:0):!t&&c<=0&&(a.row=n.row,a.column=n.column,0===c&&(a.bias=1))}}};var e=function(e,t,n,o){this.cm=e,this.id=t,this.row=n,this.column=o,e.marks[this.id]=this};e.prototype.clear=function(){delete this.cm.marks[this.id]},e.prototype.find=function(){return o(this)},this.setBookmark=function(t,n){var o=new e(this,this.$uid++,t.line,t.ch);return n&&n.insertLeft||(o.$insertRight=!0),this.marks[o.id]=o,o},this.moveH=function(e,t){if("char"==t){var n=this.ace.selection;n.clearSelection(),n.moveCursorBy(0,e)}},this.findPosV=function(e,t,n,i){if("page"==n){var r=this.ace.renderer,s=r.layerConfig;t*=Math.floor(s.height/s.lineHeight),n="line"}if("line"==n){var a=this.ace.session.documentToScreenPosition(e.line,e.ch);null!=i&&(a.column=i),a.row+=t,a.row=Math.min(Math.max(0,a.row),this.ace.session.getScreenLength()-1);return o(this.ace.session.screenToDocumentPosition(a.row,a.column))}},this.charCoords=function(e,t){if("div"==t||!t){var n=this.ace.session.documentToScreenPosition(e.line,e.ch);return{left:n.column,top:n.row}}if("local"==t){var o=this.ace.renderer,n=this.ace.session.documentToScreenPosition(e.line,e.ch),i=o.layerConfig.lineHeight,r=o.layerConfig.characterWidth,s=i*n.row;return{left:n.column*r,top:s,bottom:s+i}}},this.coordsChar=function(e,t){var n=this.ace.renderer;if("local"==t){var i=Math.max(0,Math.floor(e.top/n.lineHeight)),r=Math.max(0,Math.floor(e.left/n.characterWidth));return o(n.session.screenToDocumentPosition(i,r))}if("div"==t)throw"not implemented"},this.getSearchCursor=function(e,t){var n=!1,i=!1;e instanceof RegExp&&!e.global&&(n=!e.ignoreCase,e=e.source,i=!0);var r=new bt;t.ch==undefined&&(t.ch=Number.MAX_VALUE);var s={row:t.line,column:t.ch},a=this,l=null;return{findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(t){r.setOptions({needle:e,caseSensitive:n,wrap:!1,backwards:t,regExp:i,start:l||s});var o=r.find(a.ace.session);return o&&o.isEmpty()&&a.getLine(o.start.row).length==o.start.column&&(r.$options.start=o,o=r.find(a.ace.session)),l=o},from:function(){return l&&o(l.start)},to:function(){return l&&o(l.end)},replace:function(e){l&&(l.end=a.ace.session.doc.replace(l,e))}}},this.scrollTo=function(e,t){var n=this.ace.renderer,o=n.layerConfig,i=o.maxHeight;i-=(n.$size.scrollerHeight-n.lineHeight)*n.$scrollPastEnd,null!=t&&this.ace.session.setScrollTop(Math.max(0,Math.min(t,i))),null!=e&&this.ace.session.setScrollLeft(Math.max(0,Math.min(e,o.width)))},this.scrollInfo=function(){return 0},this.scrollIntoView=function(e,t){if(e){var o=this.ace.renderer,i={top:0,bottom:t};o.scrollCursorIntoView(n(e),2*o.lineHeight/o.$size.scrollerHeight,i)}},this.getLine=function(e){return this.ace.session.getLine(e)},this.getRange=function(e,t){return this.ace.session.getTextRange(new pt(e.line,e.ch,t.line,t.ch))},this.replaceRange=function(e,t,n){return n||(n=t),this.ace.session.replace(new pt(t.line,t.ch,n.line,n.ch),e)},this.replaceSelections=function(e){var t=this.ace.selection;if(this.ace.inVirtualSelectionMode)return void this.ace.session.replace(t.getRange(),e[0]||"");t.inVirtualSelectionMode=!0;var n=t.rangeList.ranges;n.length||(n=[this.ace.multiSelect.getRange()]);for(var o=n.length;o--;)this.ace.session.replace(n[o],e[o]||"");t.inVirtualSelectionMode=!1},this.getSelection=function(){return this.ace.getSelectedText()},this.getSelections=function(){return this.listSelections().map(function(e){return this.getRange(e.anchor,e.head)},this)},this.getInputField=function(){return this.ace.textInput.getElement()},this.getWrapperElement=function(){return this.ace.containter};var t={indentWithTabs:"useSoftTabs",indentUnit:"tabSize",tabSize:"tabSize",firstLineNumber:"firstLineNumber",readOnly:"readOnly"};this.setOption=function(e,n){switch(this.state[e]=n,e){case"indentWithTabs":e=t[e],n=!n;break;default:e=t[e]}e&&this.ace.setOption(e,n)},this.getOption=function(e,n){var o=t[e];switch(o&&(n=this.ace.getOption(o)),e){case"indentWithTabs":return e=t[e],!n}return o?n:this.state[e]},this.toggleOverwrite=function(e){return this.state.overwrite=e,this.ace.setOverwrite(e)},this.addOverlay=function(e){if(!this.$searchHighlight||!this.$searchHighlight.session){var t=new Ct(null,"ace_highlight-marker","text"),n=this.ace.session.addDynamicMarker(t);t.id=n.id,t.session=this.ace.session,t.destroy=function(){t.session.off("change",t.updateOnChange),t.session.off("changeEditor",t.destroy),t.session.removeMarker(t.id),t.session=null},t.updateOnChange=function(e){var n=e.start.row;n==e.end.row?t.cache[n]=undefined:t.cache.splice(n,t.cache.length)},t.session.on("changeEditor",t.destroy),t.session.on("change",t.updateOnChange)}var o=new RegExp(e.query.source,"gmi");this.$searchHighlight=e.highlight=t,this.$searchHighlight.setRegexp(o),this.ace.renderer.updateBackMarkers()},this.removeOverlay=function(){this.$searchHighlight&&this.$searchHighlight.session&&this.$searchHighlight.destroy()},this.getScrollInfo=function(){var e=this.ace.renderer,t=e.layerConfig;return{left:e.scrollLeft,top:e.scrollTop,height:t.maxHeight,width:t.width,clientHeight:t.height,clientWidth:t.width}},this.getValue=function(){return this.ace.getValue()},this.setValue=function(e){return this.ace.setValue(e)},this.getTokenTypeAt=function(e){var t=this.ace.session.getTokenAt(e.line,e.ch);return t&&/comment|string/.test(t.type)?"string":""},this.findMatchingBracket=function(e){var t=this.ace.session.findMatchingBracket(n(e));return{to:t&&o(t)}},this.indentLine=function(e,t){!0===t?this.ace.session.indentRows(e,e,"\t"):!1===t&&this.ace.session.outdentRows(new pt(e,0,e,0))},this.indexFromPos=function(e){return this.ace.session.doc.positionToIndex(n(e))},this.posFromIndex=function(e){return o(this.ace.session.doc.indexToPosition(e))},this.focus=function(){return this.ace.focus()},this.blur=function(){return this.ace.blur()},this.defaultTextHeight=function(){return this.ace.renderer.layerConfig.lineHeight},this.scanForBracket=function(e,t,i,r){var s=r.bracketRegex.source;if(1==t)var a=this.ace.session.$findClosingBracket(s.slice(1,2),n(e),/paren|text/);else var a=this.ace.session.$findOpeningBracket(s.slice(-2,-1),{row:e.line,column:e.ch+1},/paren|text/);return a&&{pos:o(a)}},this.refresh=function(){return this.ace.resize(!0)},this.getMode=function(){return{name:this.getOption("mode")}}}.call(St.prototype),(St.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0}).prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else var n=t&&(e.test?e.test(t):e(t));if(n)return++this.pos,t},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},backUp:function(e){this.pos-=e},column:function(){throw"not implemented"},indentation:function(){throw"not implemented"},match:function(e,t,n){if("string"!=typeof e){var o=this.string.slice(this.pos).match(e);return o&&o.index>0?null:(o&&!1!==t&&(this.pos+=o[0].length),o)}var i=function(e){return n?e.toLowerCase():e};if(i(this.string.substr(this.pos,e.length))==i(e))return!1!==t&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}},St.defineExtension=function(e,t){St.prototype[e]=t},mt.importCssString(".normal-mode .ace_cursor{  border: 1px solid red;  background-color: red;  opacity: 0.5;}.normal-mode .ace_hidden-cursors .ace_cursor{  background-color: transparent;}.ace_dialog {  position: absolute;  left: 0; right: 0;  background: white;  z-index: 15;  padding: .1em .8em;  overflow: hidden;  color: #333;}.ace_dialog-top {  border-bottom: 1px solid #eee;  top: 0;}.ace_dialog-bottom {  border-top: 1px solid #eee;  bottom: 0;}.ace_dialog input {  border: none;  outline: none;  background: transparent;  width: 20em;  color: inherit;  font-family: monospace;}","vimMode"),function(){function e(e,t,n){var o;return o=e.ace.container.appendChild(document.createElement("div")),o.className=n?"ace_dialog ace_dialog-bottom":"ace_dialog ace_dialog-top","string"==typeof t?o.innerHTML=t:o.appendChild(t),o}function t(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}St.defineExtension("openDialog",function(n,o,i){function r(e){if("string"==typeof e)u.value=e;else{if(l)return;l=!0,a.parentNode.removeChild(a),c.focus(),i.onClose&&i.onClose(a)}}if(!this.virtualSelectionMode()){i||(i={}),t(this,null);var s,a=e(this,n,i.bottom),l=!1,c=this,u=a.getElementsByTagName("input")[0];return u?(i.value&&(u.value=i.value,!1!==i.select&&u.select()),i.onInput&&St.on(u,"input",function(e){i.onInput(e,u.value,r)}),i.onKeyUp&&St.on(u,"keyup",function(e){i.onKeyUp(e,u.value,r)}),St.on(u,"keydown",function(e){i&&i.onKeyDown&&i.onKeyDown(e,u.value,r)||((27==e.keyCode||!1!==i.closeOnEnter&&13==e.keyCode)&&(u.blur(),St.e_stop(e),r()),13==e.keyCode&&o(u.value))}),!1!==i.closeOnBlur&&St.on(u,"blur",r),u.focus()):(s=a.getElementsByTagName("button")[0])&&(St.on(s,"click",function(){r(),c.focus()}),!1!==i.closeOnBlur&&St.on(s,"blur",r),s.focus()),r}}),St.defineExtension("openNotification",function(n,o){function i(){a||(a=!0,clearTimeout(r),s.parentNode.removeChild(s))}if(!this.virtualSelectionMode()){t(this,i);var r,s=e(this,n,o&&o.bottom),a=!1,l=o&&"undefined"!=typeof o.duration?o.duration:5e3;return St.on(s,"click",function(e){St.e_preventDefault(e),i()}),l&&(r=setTimeout(i,l)),i}})}();var xt=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,
wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],$t=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}],Tt=St.Pos,Et=function(){return zt};St.defineOption("vimMode",!1,function(e,t,n){t&&"vim"!=e.getOption("keyMap")?e.setOption("keyMap","vim"):!t&&n!=St.Init&&/^vim/.test(e.getOption("keyMap"))&&e.setOption("keyMap","default")});var At={Shift:"S",Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"},Mt={Enter:"CR",Backspace:"BS",Delete:"Del"},It=/[\d]/,Ot=[St.isWordChar,function(e){return e&&!St.isWordChar(e)&&!/\s/.test(e)}],Rt=[function(e){return/\S/.test(e)}],Lt=d(65,26),Pt=d(97,26),Dt=d(48,10),Nt=[].concat(Lt,Pt,Dt,["<",">"]),Ht=[].concat(Lt,Pt,Dt,["-",'"',".",":","/"]),Bt={};b("filetype",undefined,"string",["ft"],function(e,t){if(t!==undefined){if(e===undefined){var n=t.getOption("mode");return"null"==n?"":n}var n=""==e?"null":e;t.setOption("mode",n)}});var Ft=function(){function e(e,t,a){function l(t){var i=++o%n,r=s[i];r&&r.clear(),s[i]=e.setBookmark(t)}var c=o%n,u=s[c];if(u){var d=u.find();d&&!z(d,t)&&l(t)}else l(t);l(a),i=o,(r=o-n+1)<0&&(r=0)}function t(e,t){o+=t,o>i?o=i:o<r&&(o=r);var a=s[(n+o)%n];if(a&&!a.find()){var l,c=t>0?1:-1,u=e.getCursor();do{if(o+=c,(a=s[(n+o)%n])&&(l=a.find())&&!z(u,l))break}while(o<i&&o>r)}return a}var n=100,o=-1,i=0,r=0,s=new Array(n);return{cachedCursor:undefined,add:e,move:t}},jt=function(e){return e?{changes:e.changes,expectCursorActivityForChange:e.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};k.prototype={exitMacroRecordMode:function(){var e=Ut.macroModeState;e.onRecordingDone&&e.onRecordingDone(),e.onRecordingDone=undefined,e.isRecording=!1},enterMacroRecordMode:function(e,t){var n=Ut.registerController.getRegister(t);n&&(n.clear(),this.latestRegister=t,e.openDialog&&(this.onRecordingDone=e.openDialog("(recording)["+t+"]",null,{bottom:!0})),this.isRecording=!0)}};var Ut,qt,zt={buildKeyMap:function(){},getRegisterController:function(){return Ut.registerController},resetVimGlobalState_:S,getVimGlobalState_:function(){return Ut},maybeInitVimState_:_,suppressErrorLogging:!1,InsertModeKey:rt,map:function(e,t,n){nn.map(e,t,n)},unmap:function(e,t){nn.unmap(e,t)},setOption:w,getOption:C,defineOption:b,defineEx:function(e,t,n){if(t){if(0!==e.indexOf(t))throw new Error('(Vim.defineEx) "'+t+'" is not a prefix of "'+e+'", command not registered')}else t=e;tn[e]=n,nn.commandMap_[t]={name:e,shortName:t,type:"api"}},handleKey:function(e,t,n){var o=this.findKey(e,t,n);if("function"==typeof o)return o()},findKey:function(e,t,n){function o(){var o=Ut.macroModeState;if(o.isRecording){if("q"==t)return o.exitMacroRecordMode(),$(e),!0;"mapping"!=n&&Xe(o,t)}}function i(){if("<Esc>"==t)return $(e),c.visualMode?le(e):c.insertMode&&Ge(e),!0}function r(n){for(var o;n;)o=/<\w+-.+?>|<\w+>|./.exec(n),t=o[0],n=n.substring(o.index+t.length),St.Vim.handleKey(e,t,"mapping")}function s(){if(i())return!0;for(var n=c.inputState.keyBuffer=c.inputState.keyBuffer+t,o=1==t.length,r=Kt.matchCommand(n,xt,c.inputState,"insert");n.length>1&&"full"!=r.type;){var n=c.inputState.keyBuffer=n.slice(1),s=Kt.matchCommand(n,xt,c.inputState,"insert");"none"!=s.type&&(r=s)}if("none"==r.type)return $(e),!1;if("partial"==r.type)return qt&&window.clearTimeout(qt),qt=window.setTimeout(function(){c.insertMode&&c.inputState.keyBuffer&&$(e)},C("insertModeEscKeysTimeout")),!o;if(qt&&window.clearTimeout(qt),o){for(var a=e.listSelections(),l=0;l<a.length;l++){var u=a[l].head;e.replaceRange("",N(u,0,-(n.length-1)),u,"+input")}Ut.macroModeState.lastInsertModeChanges.changes.pop()}return $(e),r.command}function a(){if(o()||i())return!0;var n=c.inputState.keyBuffer=c.inputState.keyBuffer+t;if(/^[1-9]\d*$/.test(n))return!0;var r=/^(\d*)(.*)$/.exec(n);if(!r)return $(e),!1;var s=c.visualMode?"visual":"normal",a=Kt.matchCommand(r[2]||r[1],xt,c.inputState,s);if("none"==a.type)return $(e),!1;if("partial"==a.type)return!0;c.inputState.keyBuffer="";var r=/^(\d*)(.*)$/.exec(n);return r[1]&&"0"!=r[1]&&c.inputState.pushRepeatDigit(r[1]),a.command}var l,c=_(e);return l=c.insertMode?s():a(),!1===l?undefined:!0===l?function(){return!0}:function(){if(!l.operator&&!l.isEdit||!e.getOption("readOnly"))return e.operation(function(){e.curOp.isVimOp=!0;try{"keyToKey"==l.type?r(l.toKeys):Kt.processCommand(e,c,l)}catch(t){throw e.state.vim=undefined,_(e),St.Vim.suppressErrorLogging||console.log(t),t}return!0})}},handleEx:function(e,t){nn.processCommand(e,t)},defineMotion:I,defineAction:L,defineOperator:R,mapCommand:Qe,_mapCommand:Ye,defineRegister:E,exitVisualMode:le,exitInsertMode:Ge};x.prototype.pushRepeatDigit=function(e){this.operator?this.motionRepeat=this.motionRepeat.concat(e):this.prefixRepeat=this.prefixRepeat.concat(e)},x.prototype.getRepeat=function(){var e=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(e=1,this.prefixRepeat.length>0&&(e*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(e*=parseInt(this.motionRepeat.join(""),10))),e},T.prototype={setText:function(e,t,n){this.keyBuffer=[e||""],this.linewise=!!t,this.blockwise=!!n},pushText:function(e,t){t&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0),this.keyBuffer.push(e)},pushInsertModeChanges:function(e){this.insertModeChanges.push(jt(e))},pushSearchQuery:function(e){this.searchQueries.push(e)},clear:function(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1},toString:function(){return this.keyBuffer.join("")}},A.prototype={pushText:function(e,t,n,o,i){o&&"\n"==n.charAt(0)&&(n=n.slice(1)+"\n"),o&&"\n"!==n.charAt(n.length-1)&&(n+="\n");var r=this.isValidRegister(e)?this.getRegister(e):null;if(!r){switch(t){case"yank":this.registers[0]=new T(n,o,i);break;case"delete":case"change":-1==n.indexOf("\n")?this.registers["-"]=new T(n,o):(this.shiftNumericRegisters_(),this.registers[1]=new T(n,o))}return void this.unnamedRegister.setText(n,o,i)}g(e)?r.pushText(n,o):r.setText(n,o,i),this.unnamedRegister.setText(r.toString(),o)},getRegister:function(e){return this.isValidRegister(e)?(e=e.toLowerCase(),this.registers[e]||(this.registers[e]=new T),this.registers[e]):this.unnamedRegister},isValidRegister:function(e){return e&&y(e,Ht)},shiftNumericRegisters_:function(){for(var e=9;e>=2;e--)this.registers[e]=this.getRegister(""+(e-1))}},M.prototype={nextMatch:function(e,t){var n=this.historyBuffer,o=t?-1:1;null===this.initialPrefix&&(this.initialPrefix=e);for(var i=this.iterator+o;t?i>=0:i<n.length;i+=o)for(var r=n[i],s=0;s<=r.length;s++)if(this.initialPrefix==r.substring(0,s))return this.iterator=i,r;return i>=n.length?(this.iterator=n.length,this.initialPrefix):i<0?e:void 0},pushInput:function(e){var t=this.historyBuffer.indexOf(e);t>-1&&this.historyBuffer.splice(t,1),e.length&&this.historyBuffer.push(e)},reset:function(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}};var Kt={matchCommand:function(e,t,n,o){var i=B(e,t,o,n);if(!i.full&&!i.partial)return{type:"none"};if(!i.full&&i.partial)return{type:"partial"};for(var r,s=0;s<i.full.length;s++){var a=i.full[s];r||(r=a)}if("<character>"==r.keys.slice(-11)){var l=j(e);if(/<C-.>/.test(l))return{type:"none"};n.selectedCharacter=l}return{type:"full",command:r}},processCommand:function(e,t,n){switch(t.inputState.repeatOverride=n.repeatOverride,n.type){case"motion":this.processMotion(e,t,n);break;case"operator":this.processOperator(e,t,n);break;case"operatorMotion":this.processOperatorMotion(e,t,n);break;case"action":this.processAction(e,t,n);break;case"search":this.processSearch(e,t,n);break;case"ex":case"keyToEx":this.processEx(e,t,n)}},processMotion:function(e,t,n){t.inputState.motion=n.motion,t.inputState.motionArgs=D(n.motionArgs),this.evalInput(e,t)},processOperator:function(e,t,n){var o=t.inputState;if(o.operator){if(o.operator==n.operator)return o.motion="expandToLine",o.motionArgs={linewise:!0},void this.evalInput(e,t);$(e)}o.operator=n.operator,o.operatorArgs=D(n.operatorArgs),t.visualMode&&this.evalInput(e,t)},processOperatorMotion:function(e,t,n){var o=t.visualMode,i=D(n.operatorMotionArgs);i&&o&&i.visualLine&&(t.visualLine=!0),this.processOperator(e,t,n),o||this.processMotion(e,t,n)},processAction:function(e,t,n){var o=t.inputState,i=o.getRepeat(),r=!!i,s=D(n.actionArgs)||{};o.selectedCharacter&&(s.selectedCharacter=o.selectedCharacter),n.operator&&this.processOperator(e,t,n),n.motion&&this.processMotion(e,t,n),(n.motion||n.operator)&&this.evalInput(e,t),s.repeat=i||1,s.repeatIsExplicit=r,s.registerName=o.registerName,$(e),t.lastMotion=null,n.isEdit&&this.recordLastEdit(t,o,n),Gt[n.action](e,s,t)},processSearch:function(e,t,n){function o(o,i,r){Ut.searchHistoryController.pushInput(o),Ut.searchHistoryController.reset();try{Fe(e,o,i,r)}catch(t){return De(e,"Invalid regex: "+o),void $(e)}Kt.processMotion(e,t,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:n.searchArgs.toJumplist}})}function i(t){e.scrollTo(d.left,d.top),o(t,!0,!0);var n=Ut.macroModeState;n.isRecording&&et(n,t)}function r(t,n,o){var i,r=St.keyName(t);"Up"==r||"Down"==r?(i="Up"==r,n=Ut.searchHistoryController.nextMatch(n,i)||"",o(n)):"Left"!=r&&"Right"!=r&&"Ctrl"!=r&&"Alt"!=r&&"Shift"!=r&&Ut.searchHistoryController.reset();var s;try{s=Fe(e,n,!0,!0)}catch(t){}s?e.scrollIntoView(qe(e,!a,s),30):(ze(e),e.scrollTo(d.left,d.top))}function s(t,n,o){var i=St.keyName(t);"Esc"==i||"Ctrl-C"==i||"Ctrl-["==i||"Backspace"==i&&""==n?(Ut.searchHistoryController.pushInput(n),Ut.searchHistoryController.reset(),Fe(e,u),ze(e),e.scrollTo(d.left,d.top),St.e_stop(t),$(e),o(),e.focus()):"Ctrl-U"==i&&(St.e_stop(t),o(""))}if(e.getSearchCursor){var a=n.searchArgs.forward,l=n.searchArgs.wholeWordOnly;$e(e).setReversed(!a);var c=a?"/":"?",u=$e(e).getQuery(),d=e.getScrollInfo();switch(n.searchArgs.querySrc){case"prompt":var h=Ut.macroModeState;if(h.isPlaying){var p=h.replaySearchQueries.shift();o(p,!0,!1)}else He(e,{onClose:i,prefix:c,desc:Zt,onKeyUp:r,onKeyDown:s});break;case"wordUnderCursor":var f=he(e,!1,!0,!1,!0),m=!0;if(f||(f=he(e,!1,!0,!1,!1),m=!1),!f)return;var p=e.getLine(f.start.line).substring(f.start.ch,f.end.ch);p=m&&l?"\\b"+p+"\\b":J(p),Ut.jumpList.cachedCursor=e.getCursor(),e.setCursor(f.start),o(p,!0,!1)}}},processEx:function(e,t,n){function o(t){Ut.exCommandHistoryController.pushInput(t),Ut.exCommandHistoryController.reset(),nn.processCommand(e,t)}function i(t,n,o){var i,r=St.keyName(t);("Esc"==r||"Ctrl-C"==r||"Ctrl-["==r||"Backspace"==r&&""==n)&&(Ut.exCommandHistoryController.pushInput(n),Ut.exCommandHistoryController.reset(),St.e_stop(t),$(e),o(),e.focus()),"Up"==r||"Down"==r?(i="Up"==r,n=Ut.exCommandHistoryController.nextMatch(n,i)||"",o(n)):"Ctrl-U"==r?(St.e_stop(t),o("")):"Left"!=r&&"Right"!=r&&"Ctrl"!=r&&"Alt"!=r&&"Shift"!=r&&Ut.exCommandHistoryController.reset()}"keyToEx"==n.type?nn.processCommand(e,n.exArgs.input):t.visualMode?He(e,{onClose:o,prefix:":",value:"'<,'>",onKeyDown:i}):He(e,{onClose:o,prefix:":",onKeyDown:i})},evalInput:function(e,t){var n,o,i,r=t.inputState,s=r.motion,a=r.motionArgs||{},l=r.operator,c=r.operatorArgs||{},u=r.registerName,d=t.sel,h=q(t.visualMode?P(e,d.head):e.getCursor("head")),p=q(t.visualMode?P(e,d.anchor):e.getCursor("anchor")),f=q(h),m=q(p);if(l&&this.recordLastEdit(t,r),i=r.repeatOverride!==undefined?r.repeatOverride:r.getRepeat(),i>0&&a.explicitRepeat?a.repeatIsExplicit=!0:(a.noRepeat||!a.explicitRepeat&&0===i)&&(i=1,a.repeatIsExplicit=!1),r.selectedCharacter&&(a.selectedCharacter=c.selectedCharacter=r.selectedCharacter),a.repeat=i,$(e),s){var g=Wt[s](e,h,a,t);if(t.lastMotion=Wt[s],!g)return;if(a.toJumplist){l||null==e.ace.curOp||(e.ace.curOp.command.scrollIntoView="center-animate");var v=Ut.jumpList,y=v.cachedCursor;y?(pe(e,y,g),delete v.cachedCursor):pe(e,h,g)}g instanceof Array?(o=g[0],n=g[1]):n=g,n||(n=q(h)),t.visualMode?(t.visualBlock&&n.ch===Infinity||(n=P(e,n,t.visualBlock)),o&&(o=P(e,o,!0)),o=o||m,d.anchor=o,d.head=n,re(e),we(e,t,"<",K(o,n)?o:n),we(e,t,">",K(o,n)?n:o)):l||(n=P(e,n),e.setCursor(n.line,n.ch))}if(l){if(c.lastSel){o=m;var b=c.lastSel,w=Math.abs(b.head.line-b.anchor.line),C=Math.abs(b.head.ch-b.anchor.ch);n=b.visualLine?Tt(m.line+w,m.ch):b.visualBlock?Tt(m.line+w,m.ch+C):b.head.line==b.anchor.line?Tt(m.line,m.ch+C):Tt(m.line+w,m.ch),t.visualMode=!0,t.visualLine=b.visualLine,t.visualBlock=b.visualBlock,d=t.sel={anchor:o,head:n},re(e)}else t.visualMode&&(c.lastSel={anchor:q(d.anchor),head:q(d.head),visualBlock:t.visualBlock,visualLine:t.visualLine});var k,_,S,x,T;if(t.visualMode){if(k=W(d.head,d.anchor),_=V(d.head,d.anchor),S=t.visualLine||c.linewise,x=t.visualBlock?"block":S?"line":"char",T=se(e,{anchor:k,head:_},x),S){var E=T.ranges;if("block"==x)for(var A=0;A<E.length;A++)E[A].head.ch=Y(e,E[A].head.line);else"line"==x&&(E[0].head=Tt(E[0].head.line+1,0))}}else{if(k=q(o||m),_=q(n||f),K(_,k)){var M=k;k=_,_=M}S=a.linewise||c.linewise,S?ue(e,k,_):a.forward&&ce(e,k,_),x="char";T=se(e,{anchor:k,head:_},x,!a.inclusive||S)}e.setSelections(T.ranges,T.primary),t.lastMotion=null,c.repeat=i,c.registerName=u,c.linewise=S;var I=Vt[l](e,c,T.ranges,m,n);t.visualMode&&le(e,null!=I),I&&e.setCursor(I)}},recordLastEdit:function(e,t,n){var o=Ut.macroModeState;o.isPlaying||(e.lastEditInputState=t,e.lastEditActionCommand=n,o.lastInsertModeChanges.changes=[],o.lastInsertModeChanges.expectCursorActivityForChange=!1)}},Wt={moveToTopLine:function(e,t,n){var o=We(e).top+n.repeat-1;return Tt(o,de(e.getLine(o)))},moveToMiddleLine:function(e){var t=We(e),n=Math.floor(.5*(t.top+t.bottom));return Tt(n,de(e.getLine(n)))},moveToBottomLine:function(e,t,n){var o=We(e).bottom-n.repeat+1;return Tt(o,de(e.getLine(o)))},expandToLine:function(e,t,n){return Tt(t.line+n.repeat-1,Infinity)},findNext:function(e,t,n){var o=$e(e),i=o.getQuery();if(i){var r=!n.forward;return r=o.isReversed()?!r:r,Ue(e,i),qe(e,r,i,n.repeat)}},goToMark:function(e,t,n,o){var i=o.marks[n.selectedCharacter];if(i){var r=i.find();return n.linewise?{line:r.line,ch:de(e.getLine(r.line))}:r}return null},moveToOtherHighlightedEnd:function(e,t,n,o){if(o.visualBlock&&n.sameLine){var i=o.sel;return[P(e,Tt(i.anchor.line,i.head.ch)),P(e,Tt(i.head.line,i.anchor.ch))]}return[o.sel.head,o.sel.anchor]},jumpToMark:function(e,t,n,o){for(var i=t,r=0;r<n.repeat;r++){var s=i;for(var a in o.marks)if(p(a)){var l=o.marks[a].find(),c=n.forward?K(l,s):K(s,l);if(!(c||n.linewise&&l.line==s.line)){var u=z(s,i),d=n.forward?G(s,l,i):G(i,l,s);(u||d)&&(i=l)}}}return n.linewise&&(i=Tt(i.line,de(e.getLine(i.line)))),i},moveByCharacters:function(e,t,n){var o=t,i=n.repeat,r=n.forward?o.ch+i:o.ch-i;return Tt(o.line,r)},moveByLines:function(e,t,n,o){var i=t,r=i.ch;switch(o.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:r=o.lastHPos;break;default:o.lastHPos=r}var s=n.repeat+(n.repeatOffset||0),a=n.forward?i.line+s:i.line-s,l=e.firstLine(),c=e.lastLine();if(!(a<l&&i.line==l||a>c&&i.line==c)){var u=e.ace.session.getFoldLine(a);return u&&(n.forward?a>u.start.row&&(a=u.end.row+1):a=u.start.row),n.toFirstChar&&(r=de(e.getLine(a)),o.lastHPos=r),o.lastHSPos=e.charCoords(Tt(a,r),"div").left,Tt(a,r)}},moveByDisplayLines:function(e,t,n,o){var i=t;switch(o.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:o.lastHSPos=e.charCoords(i,"div").left}var r=n.repeat,s=e.findPosV(i,n.forward?r:-r,"line",o.lastHSPos);if(s.hitSide)if(n.forward)var a=e.charCoords(s,"div"),l={top:a.top+8,left:o.lastHSPos},s=e.coordsChar(l,"div");else{var c=e.charCoords(Tt(e.firstLine(),0),"div");c.left=o.lastHSPos,s=e.coordsChar(c,"div")}return o.lastHPos=s.ch,s},moveByPage:function(e,t,n){var o=t,i=n.repeat;return e.findPosV(o,n.forward?i:-i,"page")},moveByParagraph:function(e,t,n){var o=n.forward?1:-1;return ke(e,t,n.repeat,o)},moveByScroll:function(e,t,n,o){var i=e.getScrollInfo(),r=null,s=n.repeat;s||(s=i.clientHeight/(2*e.defaultTextHeight()));var a=e.charCoords(t,"local");n.repeat=s;var r=Wt.moveByDisplayLines(e,t,n,o);if(!r)return null;var l=e.charCoords(r,"local");return e.scrollTo(null,i.top+l.top-a.top),r},moveByWords:function(e,t,n){return ve(e,t,n.repeat,!!n.forward,!!n.wordEnd,!!n.bigWord)},moveTillCharacter:function(e,t,n){var o=n.repeat,i=ye(e,o,n.forward,n.selectedCharacter),r=n.forward?-1:1;return fe(r,n),i?(i.ch+=r,i):null},moveToCharacter:function(e,t,n){var o=n.repeat;return fe(0,n),ye(e,o,n.forward,n.selectedCharacter)||t},moveToSymbol:function(e,t,n){return me(e,n.repeat,n.forward,n.selectedCharacter)||t},moveToColumn:function(e,t,n,o){var i=n.repeat;return o.lastHPos=i-1,o.lastHSPos=e.charCoords(t,"div").left,be(e,i)},moveToEol:function(e,t,n,o){var i=t;o.lastHPos=Infinity;var r=Tt(i.line+n.repeat-1,Infinity),s=e.clipPos(r);return s.ch--,o.lastHSPos=e.charCoords(s,"div").left,r},moveToFirstNonWhiteSpaceCharacter:function(e,t){var n=t;return Tt(n.line,de(e.getLine(n.line)))},moveToMatchedSymbol:function(e,t){var n,o=t,i=o.line,r=o.ch,s=e.getLine(i);do{if((n=s.charAt(r++))&&f(n)){var a=e.getTokenTypeAt(Tt(i,r));if("string"!==a&&"comment"!==a)break}}while(n);if(n){return e.findMatchingBracket(Tt(i,r)).to}return o},moveToStartOfLine:function(e,t){return Tt(t.line,0)},moveToLineOrEdgeOfDocument:function(e,t,n){var o=n.forward?e.lastLine():e.firstLine();return n.repeatIsExplicit&&(o=n.repeat-e.getOption("firstLineNumber")),Tt(o,de(e.getLine(o)))},textObjectManipulation:function(e,t,n,o){var i={"(":")",")":"(","{":"}","}":"{","[":"]","]":"["},r={"'":!0,'"':!0},s=n.selectedCharacter;"b"==s?s="(":"B"==s&&(s="{");var a,l=!n.textObjectInner;if(i[s])a=_e(e,t,s,l);else if(r[s])a=Se(e,t,s,l);else if("W"===s)a=he(e,l,!0,!0);else if("w"===s)a=he(e,l,!0,!1);else{if("p"!==s)return null;if(a=ke(e,t,n.repeat,0,l),n.linewise=!0,o.visualMode)o.visualLine||(o.visualLine=!0);else{var c=o.inputState.operatorArgs;c&&(c.linewise=!0),a.end.line--}}return e.state.vim.visualMode?ie(e,a.start,a.end):[a.start,a.end]},repeatLastCharacterSearch:function(e,t,n){var o=Ut.lastChararacterSearch,i=n.repeat,r=n.forward===o.forward,s=(o.increment?1:0)*(r?-1:1);e.moveH(-s,"char"),n.inclusive=!!r;var a=ye(e,i,r,o.selectedCharacter);return a?(a.ch+=s,a):(e.moveH(s,"char"),t)}},Vt={change:function(e,t,n){var o,i,r=e.state.vim;if(Ut.macroModeState.lastInsertModeChanges.inVisualBlock=r.visualBlock,r.visualMode){i=e.getSelection();var s=O("",n.length);e.replaceSelections(s),o=W(n[0].head,n[0].anchor)}else{var a=n[0].anchor,l=n[0].head;i=e.getRange(a,l);var c=r.lastEditInputState||{};if("moveByWords"==c.motion&&!v(i)){var u=/\s+$/.exec(i);u&&c.motionArgs&&c.motionArgs.forward&&(l=N(l,0,-u[0].length),i=i.slice(0,-u[0].length))}var d=new Tt(a.line-1,Number.MAX_VALUE),h=e.firstLine()==e.lastLine();l.line>e.lastLine()&&t.linewise&&!h?e.replaceRange("",d,l):e.replaceRange("",a,l),t.linewise&&(h||(e.setCursor(d),St.commands.newlineAndIndent(e)),a.ch=Number.MAX_VALUE),o=a}Ut.registerController.pushText(t.registerName,"change",i,t.linewise,n.length>1),Gt.enterInsertMode(e,{head:o},e.state.vim)},"delete":function(e,t,n){var o,i,r=e.state.vim;if(r.visualBlock){i=e.getSelection();var s=O("",n.length);e.replaceSelections(s),o=n[0].anchor}else{var a=n[0].anchor,l=n[0].head;t.linewise&&l.line!=e.firstLine()&&a.line==e.lastLine()&&a.line==l.line-1&&(a.line==e.firstLine()?a.ch=0:a=Tt(a.line-1,Y(e,a.line-1))),i=e.getRange(a,l),e.replaceRange("",a,l),o=a,t.linewise&&(o=Wt.moveToFirstNonWhiteSpaceCharacter(e,a))}return Ut.registerController.pushText(t.registerName,"delete",i,t.linewise,r.visualBlock),P(e,o)},indent:function(e,t,n){var o=e.state.vim,i=n[0].anchor.line,r=o.visualBlock?n[n.length-1].anchor.line:n[0].head.line,s=o.visualMode?t.repeat:1;t.linewise&&r--;for(var a=i;a<=r;a++)for(var l=0;l<s;l++)e.indentLine(a,t.indentRight);return Wt.moveToFirstNonWhiteSpaceCharacter(e,n[0].anchor)},changeCase:function(e,t,n,o,i){for(var r=e.getSelections(),s=[],a=t.toLower,l=0;l<r.length;l++){var c=r[l],u="";if(!0===a)u=c.toLowerCase();else if(!1===a)u=c.toUpperCase();else for(var d=0;d<c.length;d++){var h=c.charAt(d);u+=g(h)?h.toLowerCase():h.toUpperCase()}s.push(u)}return e.replaceSelections(s),t.shouldMoveCursor?i:!e.state.vim.visualMode&&t.linewise&&n[0].anchor.line+1==n[0].head.line?Wt.moveToFirstNonWhiteSpaceCharacter(e,o):t.linewise?o:W(n[0].anchor,n[0].head)},yank:function(e,t,n,o){var i=e.state.vim,r=e.getSelection(),s=i.visualMode?W(i.sel.anchor,i.sel.head,n[0].head,n[0].anchor):o;return Ut.registerController.pushText(t.registerName,"yank",r,t.linewise,i.visualBlock),s}},Gt={jumpListWalk:function(e,t,n){if(!n.visualMode){var o=t.repeat,i=t.forward,r=Ut.jumpList,s=r.move(e,i?o:-o),a=s?s.find():undefined;a=a||e.getCursor(),e.setCursor(a),e.ace.curOp.command.scrollIntoView="center-animate"}},scroll:function(e,t,n){if(!n.visualMode){var o=t.repeat||1,i=e.defaultTextHeight(),r=e.getScrollInfo().top,s=i*o,a=t.forward?r+s:r-s,l=q(e.getCursor()),c=e.charCoords(l,"local");if(t.forward)a>c.top?(l.line+=(a-c.top)/i,l.line=Math.ceil(l.line),e.setCursor(l),c=e.charCoords(l,"local"),e.scrollTo(null,c.top)):e.scrollTo(null,a);else{var u=a+e.getScrollInfo().clientHeight;u<c.bottom?(l.line-=(c.bottom-u)/i,l.line=Math.floor(l.line),e.setCursor(l),c=e.charCoords(l,"local"),e.scrollTo(null,c.bottom-e.getScrollInfo().clientHeight)):e.scrollTo(null,a)}}},scrollToCursor:function(e,t){var n=e.getCursor().line,o=e.charCoords(Tt(n,0),"local"),i=e.getScrollInfo().clientHeight,r=o.top,s=o.bottom-r;switch(t.position){case"center":r=r-i/2+s;break;case"bottom":r=r-i+1.4*s;break;case"top":r+=.4*s}e.scrollTo(null,r)},replayMacro:function(e,t,n){var o=t.selectedCharacter,i=t.repeat,r=Ut.macroModeState;for("@"==o&&(o=r.latestRegister);i--;)Je(e,n,r,o)},enterMacroRecordMode:function(e,t){var n=Ut.macroModeState,o=t.selectedCharacter;n.enterMacroRecordMode(e,o)},enterInsertMode:function(e,t,n){if(!e.getOption("readOnly")){n.insertMode=!0,n.insertModeRepeat=t&&t.repeat||1;var o=t?t.insertAt:null,i=n.sel,r=t.head||e.getCursor("head"),s=e.listSelections().length;if("eol"==o)r=Tt(r.line,Y(e,r.line));else if("charAfter"==o)r=N(r,0,1);else if("firstNonBlank"==o)r=Wt.moveToFirstNonWhiteSpaceCharacter(e,r);else if("startOfSelectedArea"==o)n.visualBlock?(r=Tt(Math.min(i.head.line,i.anchor.line),Math.min(i.head.ch,i.anchor.ch)),s=Math.abs(i.head.line-i.anchor.line)+1):r=i.head.line<i.anchor.line?i.head:Tt(i.anchor.line,0);else if("endOfSelectedArea"==o)n.visualBlock?(r=Tt(Math.min(i.head.line,i.anchor.line),Math.max(i.head.ch+1,i.anchor.ch)),s=Math.abs(i.head.line-i.anchor.line)+1):r=i.head.line>=i.anchor.line?N(i.head,0,1):Tt(i.anchor.line,0);else if("inplace"==o&&n.visualMode)return;e.setOption("keyMap","vim-insert"),e.setOption("disableInput",!1),t&&t.replace?(e.toggleOverwrite(!0),e.setOption("keyMap","vim-replace"),St.signal(e,"vim-mode-change",{mode:"replace"})):(e.setOption("keyMap","vim-insert"),St.signal(e,"vim-mode-change",{mode:"insert"})),Ut.macroModeState.isPlaying||(e.on("change",tt),St.on(e.getInputField(),"keydown",st)),n.visualMode&&le(e),ee(e,r,s)}},toggleVisualMode:function(e,t,n){var o,i=t.repeat,r=e.getCursor();n.visualMode?n.visualLine^t.linewise||n.visualBlock^t.blockwise?(n.visualLine=!!t.linewise,n.visualBlock=!!t.blockwise,
St.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""}),re(e)):le(e):(n.visualMode=!0,n.visualLine=!!t.linewise,n.visualBlock=!!t.blockwise,o=P(e,Tt(r.line,r.ch+i-1),!0),n.sel={anchor:r,head:o},St.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""}),re(e),we(e,n,"<",W(r,o)),we(e,n,">",V(r,o)))},reselectLastSelection:function(e,t,n){var o=n.lastSelection;if(n.visualMode&&oe(e,n),o){var i=o.anchorMark.find(),r=o.headMark.find();if(!i||!r)return;n.sel={anchor:i,head:r},n.visualMode=!0,n.visualLine=o.visualLine,n.visualBlock=o.visualBlock,re(e),we(e,n,"<",W(i,r)),we(e,n,">",V(i,r)),St.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""})}},joinLines:function(e,t,n){var o,i;if(n.visualMode){if(o=e.getCursor("anchor"),i=e.getCursor("head"),K(i,o)){var r=i;i=o,o=r}i.ch=Y(e,i.line)-1}else{var s=Math.max(t.repeat,2);o=e.getCursor(),i=P(e,Tt(o.line+s-1,Infinity))}for(var a=0,l=o.line;l<i.line;l++){a=Y(e,o.line);var r=Tt(o.line+1,Y(e,o.line+1)),c=e.getRange(o,r);c=c.replace(/\n\s*/g," "),e.replaceRange(c,o,r)}var u=Tt(o.line,a);n.visualMode&&le(e,!1),e.setCursor(u)},newLineAndEnterInsertMode:function(e,t,n){n.insertMode=!0;var o=q(e.getCursor());if(o.line!==e.firstLine()||t.after){o.line=t.after?o.line:o.line-1,o.ch=Y(e,o.line),e.setCursor(o);(St.commands.newlineAndIndentContinueComment||St.commands.newlineAndIndent)(e)}else e.replaceRange("\n",Tt(e.firstLine(),0)),e.setCursor(e.firstLine(),0);this.enterInsertMode(e,{repeat:t.repeat},n)},paste:function(e,t,n){var o=q(e.getCursor()),i=Ut.registerController.getRegister(t.registerName),r=i.toString();if(r){if(t.matchIndent){var s=e.getOption("tabSize"),a=function(e){var t=e.split("\t").length-1,n=e.split(" ").length-1;return t*s+1*n},l=e.getLine(e.getCursor().line),c=a(l.match(/^\s*/)[0]),u=r.replace(/\n$/,""),d=r!==u,h=a(r.match(/^\s*/)[0]),r=u.replace(/^\s*/gm,function(t){var n=c+(a(t)-h);if(n<0)return"";if(e.getOption("indentWithTabs")){var o=Math.floor(n/s);return Array(o+1).join("\t")}return Array(n+1).join(" ")});r+=d?"\n":""}if(t.repeat>1)var r=Array(t.repeat+1).join(r);var p=i.linewise,f=i.blockwise;if(p&&!f)n.visualMode?r=n.visualLine?r.slice(0,-1):"\n"+r.slice(0,r.length-1)+"\n":t.after?(r="\n"+r.slice(0,r.length-1),o.ch=Y(e,o.line)):o.ch=0;else{if(f){r=r.split("\n");for(var m=0;m<r.length;m++)r[m]=""==r[m]?" ":r[m]}o.ch+=t.after?1:0}var g,v;if(n.visualMode){n.lastPastedText=r;var y,b=ne(e,n),w=b[0],C=b[1],k=e.getSelection(),_=e.listSelections(),S=new Array(_.length).join("1").split("1");n.lastSelection&&(y=n.lastSelection.headMark.find()),Ut.registerController.unnamedRegister.setText(k),f?(e.replaceSelections(S),C=Tt(w.line+r.length-1,w.ch),e.setCursor(w),Z(e,C),e.replaceSelections(r),g=w):n.visualBlock?(e.replaceSelections(S),e.setCursor(w),e.replaceRange(r,w,w),g=w):(e.replaceRange(r,w,C),g=e.posFromIndex(e.indexFromPos(w)+r.length-1)),y&&(n.lastSelection.headMark=e.setBookmark(y)),p&&(g.ch=0)}else if(f){e.setCursor(o);for(var m=0;m<r.length;m++){var x=o.line+m;x>e.lastLine()&&e.replaceRange("\n",Tt(x,0));var $=Y(e,x);$<o.ch&&X(e,x,o.ch)}e.setCursor(o),Z(e,Tt(o.line+r.length-1,o.ch)),e.replaceSelections(r),g=o}else e.replaceRange(r,o),p&&t.after?g=Tt(o.line+1,de(e.getLine(o.line+1))):p&&!t.after?g=Tt(o.line,de(e.getLine(o.line))):!p&&t.after?(v=e.indexFromPos(o),g=e.posFromIndex(v+r.length-1)):(v=e.indexFromPos(o),g=e.posFromIndex(v+r.length));n.visualMode&&le(e,!1),e.setCursor(g)}},undo:function(e,t){e.operation(function(){U(e,St.commands.undo,t.repeat)(),e.setCursor(e.getCursor("anchor"))})},redo:function(e,t){U(e,St.commands.redo,t.repeat)()},setRegister:function(e,t,n){n.inputState.registerName=t.selectedCharacter},setMark:function(e,t,n){we(e,n,t.selectedCharacter,e.getCursor())},replace:function(e,t,n){var o,i,r=t.selectedCharacter,s=e.getCursor(),a=e.listSelections();if(n.visualMode)s=e.getCursor("start"),i=e.getCursor("end");else{var l=e.getLine(s.line);o=s.ch+t.repeat,o>l.length&&(o=l.length),i=Tt(s.line,o)}if("\n"==r)n.visualMode||e.replaceRange("",s,i),(St.commands.newlineAndIndentContinueComment||St.commands.newlineAndIndent)(e);else{var c=e.getRange(s,i);if(c=c.replace(/[^\n]/g,r),n.visualBlock){var u=new Array(e.getOption("tabSize")+1).join(" ");c=e.getSelection(),c=c.replace(/\t/g,u).replace(/[^\n]/g,r).split("\n"),e.replaceSelections(c)}else e.replaceRange(c,s,i);n.visualMode?(s=K(a[0].anchor,a[0].head)?a[0].anchor:a[0].head,e.setCursor(s),le(e,!1)):e.setCursor(N(i,0,-1))}},incrementNumberToken:function(e,t){for(var n,o,i,r,s,a=e.getCursor(),l=e.getLine(a.line),c=/-?\d+/g;null!==(n=c.exec(l))&&(s=n[0],o=n.index,i=o+s.length,!(a.ch<i)););if((t.backtrack||!(i<=a.ch))&&s){var u=t.increase?1:-1,d=parseInt(s)+u*t.repeat,h=Tt(a.line,o),p=Tt(a.line,i);r=d.toString(),e.replaceRange(r,h,p),e.setCursor(Tt(a.line,o+r.length-1))}},repeatLastEdit:function(e,t,n){if(n.lastEditInputState){var o=t.repeat;o&&t.repeatIsExplicit?n.lastEditInputState.repeatOverride=o:o=n.lastEditInputState.repeatOverride||o,at(e,n,o,!1)}},exitInsertMode:Ge},Yt={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},Qt={bracket:{isComplete:function(e){if(e.nextCh===e.symb){if(++e.depth>=1)return!0}else e.nextCh===e.reverseSymb&&e.depth--;return!1}},section:{init:function(e){e.curMoveThrough=!0,e.symb=(e.forward?"]":"[")===e.symb?"{":"}"},isComplete:function(e){return 0===e.index&&e.nextCh===e.symb}},comment:{isComplete:function(e){var t="*"===e.lastCh&&"/"===e.nextCh;return e.lastCh=e.nextCh,t}},method:{init:function(e){e.symb="m"===e.symb?"{":"}",e.reverseSymb="{"===e.symb?"}":"{"},isComplete:function(e){return e.nextCh===e.symb}},preprocess:{init:function(e){e.index=0},isComplete:function(e){if("#"===e.nextCh){var t=e.lineText.match(/#(\w+)/)[1];if("endif"===t){if(e.forward&&0===e.depth)return!0;e.depth++}else if("if"===t){if(!e.forward&&0===e.depth)return!0;e.depth--}if("else"===t&&0===e.depth)return!0}return!1}}};b("pcre",!0,"boolean"),xe.prototype={getQuery:function(){return Ut.query},setQuery:function(e){Ut.query=e},getOverlay:function(){return this.searchOverlay},setOverlay:function(e){this.searchOverlay=e},isReversed:function(){return Ut.isReversed},setReversed:function(e){Ut.isReversed=e},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(e){this.annotate=e}};var Jt={"\\n":"\n","\\r":"\r","\\t":"\t"},Xt={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"\t"},Zt="(Javascript regexp)",en=function(){this.buildCommandMap_()};en.prototype={processCommand:function(e,t,n){var o=this;e.operation(function(){e.curOp.isVimOp=!0,o._processCommand(e,t,n)})},_processCommand:function(e,t,n){var o=e.state.vim,i=Ut.registerController.getRegister(":"),r=i.toString();o.visualMode&&le(e);var s=new St.StringStream(t);i.setText(t);var a=n||{};a.input=t;try{this.parseInput_(e,s,a)}catch(t){throw De(e,t),t}var l,c;if(a.commandName){if(l=this.matchCommand_(a.commandName)){if(c=l.name,l.excludeFromCommandHistory&&i.setText(r),this.parseCommandArgs_(s,a,l),"exToKey"==l.type){for(var u=0;u<l.toKeys.length;u++)St.Vim.handleKey(e,l.toKeys[u],"mapping");return}if("exToEx"==l.type)return void this.processCommand(e,l.toInput)}}else a.line!==undefined&&(c="move");if(!c)return void De(e,'Not an editor command ":'+t+'"');try{tn[c](e,a),l&&l.possiblyAsync||!a.callback||a.callback()}catch(t){throw De(e,t),t}},parseInput_:function(e,t,n){t.eatWhile(":"),t.eat("%")?(n.line=e.firstLine(),n.lineEnd=e.lastLine()):(n.line=this.parseLineSpec_(e,t),n.line!==undefined&&t.eat(",")&&(n.lineEnd=this.parseLineSpec_(e,t,n.line)));var o=t.match(/^(\w+)/);return n.commandName=o?o[1]:t.match(/.*/)[0],n},parseLineSpec_:function(e,t,n){var o=t.match(/^(\d+)/);if(o)return parseInt(o[1],10)-1;switch(t.next()){case".":return e.getCursor().line;case"$":return e.lastLine();case"'":var i=e.state.vim.marks[t.next()];if(i&&i.find())return i.find().line;throw new Error("Mark not set");case"+":if(n){var r=t.match(/^\d+/);if(r)return n+parseInt(r[0],10)}throw new Error("Require prevLine");default:return t.backUp(1),undefined}},parseCommandArgs_:function(e,t,n){if(!e.eol()){t.argString=e.match(/.*/)[0];var o=n.argDelimiter||/\s+/,i=Q(t.argString).split(o);i.length&&i[0]&&(t.args=i)}},matchCommand_:function(e){for(var t=e.length;t>0;t--){var n=e.substring(0,t);if(this.commandMap_[n]){var o=this.commandMap_[n];if(0===o.name.indexOf(e))return o}}return null},buildCommandMap_:function(){this.commandMap_={};for(var e=0;e<$t.length;e++){var t=$t[e],n=t.shortName||t.name;this.commandMap_[n]=t}},map:function(e,t,n){if(":"!=e&&":"==e.charAt(0)){if(n)throw Error("Mode not supported for ex mappings");var o=e.substring(1);":"!=t&&":"==t.charAt(0)?this.commandMap_[o]={name:o,type:"exToEx",toInput:t.substring(1),user:!0}:this.commandMap_[o]={name:o,type:"exToKey",toKeys:t,user:!0}}else if(":"!=t&&":"==t.charAt(0)){var i={keys:e,type:"keyToEx",exArgs:{input:t.substring(1)},user:!0};n&&(i.context=n),xt.unshift(i)}else{var i={keys:e,type:"keyToKey",toKeys:t,user:!0};n&&(i.context=n),xt.unshift(i)}},unmap:function(e,t){if(":"!=e&&":"==e.charAt(0)){if(t)throw Error("Mode not supported for ex mappings");var n=e.substring(1);if(this.commandMap_[n]&&this.commandMap_[n].user)return void delete this.commandMap_[n]}else for(var o=e,i=0;i<xt.length;i++)if(o==xt[i].keys&&xt[i].context===t&&xt[i].user)return void xt.splice(i,1)}};var tn={colorscheme:function(e,t){if(!t.args||t.args.length<1)return void De(e,e.getOption("theme"));e.setOption("theme",t.args[0])},map:function(e,t,n){var o=t.args;if(!o||o.length<2)return void(e&&De(e,"Invalid mapping: "+t.input));nn.map(o[0],o[1],n)},imap:function(e,t){this.map(e,t,"insert")},nmap:function(e,t){this.map(e,t,"normal")},vmap:function(e,t){this.map(e,t,"visual")},unmap:function(e,t,n){var o=t.args;if(!o||o.length<1)return void(e&&De(e,"No such mapping: "+t.input));nn.unmap(o[0],n)},move:function(e,t){Kt.processCommand(e,e.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:t.line+1})},set:function(e,t){var n=t.args,o=t.setCfg||{};if(!n||n.length<1)return void(e&&De(e,"Invalid mapping: "+t.input));var i=n[0].split("="),r=i[0],s=i[1],a=!1;if("?"==r.charAt(r.length-1)){if(s)throw Error("Trailing characters: "+t.argString);r=r.substring(0,r.length-1),a=!0}s===undefined&&"no"==r.substring(0,2)&&(r=r.substring(2),s=!1);var l=Bt[r]&&"boolean"==Bt[r].type;if(l&&s==undefined&&(s=!0),!l&&s===undefined||a){var c=C(r,e,o);!0===c||!1===c?De(e," "+(c?"":"no")+r):De(e,"  "+r+"="+c)}else w(r,s,e,o)},setlocal:function(e,t){t.setCfg={scope:"local"},this.set(e,t)},setglobal:function(e,t){t.setCfg={scope:"global"},this.set(e,t)},registers:function(e,t){var n=t.args,o=Ut.registerController.registers,i="----------Registers----------<br><br>";if(n){var r;n=n.join("");for(var s=0;s<n.length;s++)if(r=n.charAt(s),Ut.registerController.isValidRegister(r)){var a=o[r]||new T;i+='"'+r+"    "+a.toString()+"<br>"}}else for(var r in o){var l=o[r].toString();l.length&&(i+='"'+r+"    "+l+"<br>")}De(e,i)},sort:function(e,t){function n(){if(t.argString){var e=new St.StringStream(t.argString);if(e.eat("!")&&(i=!0),e.eol())return;if(!e.eatSpace())return"Invalid arguments";var n=e.match(/[a-z]+/);if(n){n=n[0],r=-1!=n.indexOf("i"),s=-1!=n.indexOf("u");var o=-1!=n.indexOf("d")&&1,l=-1!=n.indexOf("x")&&1,c=-1!=n.indexOf("o")&&1;if(o+l+c>1)return"Invalid arguments";a=o&&"decimal"||l&&"hex"||c&&"octal"}if(e.match(/\/.*\//))return"patterns not supported"}}function o(e,t){if(i){var n;n=e,e=t,t=n}r&&(e=e.toLowerCase(),t=t.toLowerCase());var o=a&&f.exec(e),s=a&&f.exec(t);return o?(o=parseInt((o[1]+o[2]).toLowerCase(),m),s=parseInt((s[1]+s[2]).toLowerCase(),m),o-s):e<t?-1:1}var i,r,s,a,l=n();if(l)return void De(e,l+": "+t.argString);var c=t.line||e.firstLine(),u=t.lineEnd||t.line||e.lastLine();if(c!=u){var d=Tt(c,0),h=Tt(u,Y(e,u)),p=e.getRange(d,h).split("\n"),f="decimal"==a?/(-?)([\d]+)/:"hex"==a?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==a?/([0-7]+)/:null,m="decimal"==a?10:"hex"==a?16:"octal"==a?8:null,g=[],v=[];if(a)for(var y=0;y<p.length;y++)f.exec(p[y])?g.push(p[y]):v.push(p[y]);else v=p;if(g.sort(o),v.sort(o),p=i?g.concat(v):v.concat(g),s){var b,w=p;p=[];for(var y=0;y<w.length;y++)w[y]!=b&&p.push(w[y]),b=w[y]}e.replaceRange(p.join("\n"),d,h)}},global:function(e,t){var n=t.argString;if(!n)return void De(e,"Regular Expression missing from global");var o,i=t.line!==undefined?t.line:e.firstLine(),r=t.lineEnd||t.line||e.lastLine(),s=Ee(n),a=n;if(s.length&&(a=s[0],o=s.slice(1,s.length).join("/")),a)try{Fe(e,a,!0,!0)}catch(t){return void De(e,"Invalid regex: "+a)}for(var l=$e(e).getQuery(),c=[],u="",d=i;d<=r;d++){l.test(e.getLine(d))&&(c.push(d+1),u+=e.getLine(d)+"<br>")}if(!o)return void De(e,u);var h=0,p=function(){if(h<c.length){var t=c[h]+o;nn.processCommand(e,t,{callback:p})}h++};p()},substitute:function(e,t){if(!e.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var n,o,i,r,s=t.argString,a=s?Me(s,s[0]):[],l="",c=!1,u=!1;if(a.length)n=a[0],l=a[1],l!==undefined&&(l=C("pcre")?Le(l):Re(l),Ut.lastSubstituteReplacePart=l),o=a[2]?a[2].split(" "):[];else if(s&&s.length)return void De(e,"Substitutions should be of the form :s/pattern/replace/");if(o&&(i=o[0],r=parseInt(o[1]),i&&(-1!=i.indexOf("c")&&(c=!0,i.replace("c","")),-1!=i.indexOf("g")&&(u=!0,i.replace("g","")),n=n+"/"+i)),n)try{Fe(e,n,!0,!0)}catch(t){return void De(e,"Invalid regex: "+n)}if((l=l||Ut.lastSubstituteReplacePart)===undefined)return void De(e,"No previous substitute regular expression");var d=$e(e),h=d.getQuery(),p=t.line!==undefined?t.line:e.getCursor().line,f=t.lineEnd||p;p==e.firstLine()&&f==e.lastLine()&&(f=Infinity),r&&(p=f,f=p+r-1);var m=P(e,Tt(p,0));Ve(e,c,u,p,f,e.getSearchCursor(h,m),h,l,t.callback)},redo:St.commands.redo,undo:St.commands.undo,write:function(e){St.commands.save?St.commands.save(e):e.save()},nohlsearch:function(e){ze(e)},delmarks:function(e,t){if(!t.argString||!Q(t.argString))return void De(e,"Argument required");for(var n=e.state.vim,o=new St.StringStream(Q(t.argString));!o.eol();){o.eatSpace();var i=o.pos;if(!o.match(/[a-zA-Z]/,!1))return void De(e,"Invalid argument: "+t.argString.substring(i));var r=o.next();if(o.match("-",!0)){if(!o.match(/[a-zA-Z]/,!1))return void De(e,"Invalid argument: "+t.argString.substring(i));var s=r,a=o.next();if(!(p(s)&&p(a)||g(s)&&g(a)))return void De(e,"Invalid argument: "+s+"-");var l=s.charCodeAt(0),c=a.charCodeAt(0);if(l>=c)return void De(e,"Invalid argument: "+t.argString.substring(i));for(var u=0;u<=c-l;u++){var d=String.fromCharCode(l+u);delete n.marks[d]}}else delete n.marks[r]}}},nn=new en;St.keyMap.vim={attach:a,detach:s,call:l},b("insertModeEscKeysTimeout",200,"number"),St.keyMap["vim-insert"]={"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(e){(St.commands.newlineAndIndentContinueComment||St.commands.newlineAndIndent)(e)},fallthrough:["default"],attach:a,detach:s,call:l},St.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:a,detach:s,call:l},S(),St.Vim=Et(),Et=St.Vim;var on={"return":"CR",backspace:"BS","delete":"Del",esc:"Esc",left:"Left",right:"Right",up:"Up",down:"Down",space:"Space",home:"Home",end:"End",pageup:"PageUp",pagedown:"PageDown",enter:"CR"},rn=Et.handleKey.bind(Et);Et.handleKey=function(e,t,n){return e.operation(function(){return rn(e,t,n)},!0)},t.CodeMirror=St;var sn=Et.maybeInitVimState_;t.handler={$id:"ace/keyboard/vim",drawCursor:function(e,t,n,o,i){var r=this.state.vim||{},s=n.characterWidth,a=n.lineHeight,l=t.top,c=t.left;if(!r.insertMode){!(o.cursor?pt.comparePoints(o.cursor,o.start)<=0:i.selection.isBackwards()||i.selection.isEmpty())&&c>s&&(c-=s)}!r.insertMode&&r.status&&(a/=2,l+=a),e.left=c+"px",e.top=l+"px",e.width=s+"px",e.height=a+"px"},handleKeyboard:function(e,t,n,o,i){var r=e.editor,s=r.state.cm,a=sn(s);if(-1!=o){if(a.insertMode||(-1==t?(n.charCodeAt(0)>255&&e.inputKey&&(n=e.inputKey)&&4==e.inputHash&&(n=n.toUpperCase()),e.inputChar=n):4==t||0==t?e.inputKey==n&&e.inputHash==t&&e.inputChar?(n=e.inputChar,t=-1):(e.inputChar=null,e.inputKey=n,e.inputHash=t):e.inputChar=e.inputKey=null),"c"==n&&1==t&&!wt.isMac&&r.getCopyText())return r.once("copy",function(){r.selection.clearSelection()}),{command:"null",passEvent:!0};if(-1==t||1&t||0===t&&n.length>1){var l=a.insertMode,c=ct(t,n,i||{});null==a.status&&(a.status="");var u=dt(s,c,"user");if(a=sn(s),u&&null!=a.status?a.status+=c:null==a.status&&(a.status=""),s._signal("changeStatus"),!u&&(-1!=t||l))return;return{command:"null",passEvent:!u}}}},attach:function(e){function t(){var t=sn(n).insertMode;n.ace.renderer.setStyle("normal-mode",!t),e.textInput.setCommandMode(!t),e.renderer.$keepTextAreaAtCursor=t}e.state||(e.state={});var n=new St(e);e.state.cm=n,e.$vimModeHandler=this,St.keyMap.vim.attach(n),sn(n).status=null,n.on("vim-command-done",function(){n.virtualSelectionMode()||(sn(n).status=null,n.ace._signal("changeStatus"),n.ace.session.markUndoGroup())}),n.on("changeStatus",function(){n.ace.renderer.updateCursor(),n.ace._signal("changeStatus")}),n.on("vim-mode-change",function(){n.virtualSelectionMode()||(t(),n._signal("changeStatus"))}),t(),e.renderer.$cursorLayer.drawCursor=this.drawCursor.bind(n),this.updateMacCompositionHandlers(e,!0)},detach:function(e){var t=e.state.cm;St.keyMap.vim.detach(t),t.destroy(),e.state.cm=null,e.$vimModeHandler=null,e.renderer.$cursorLayer.drawCursor=null,e.renderer.setStyle("normal-mode",!1),e.textInput.setCommandMode(!1),e.renderer.$keepTextAreaAtCursor=!0,this.updateMacCompositionHandlers(e,!1)},getStatusText:function(e){var t=e.state.cm,n=sn(t);if(n.insertMode)return"INSERT";var o="";return n.visualMode&&(o+="VISUAL",n.visualLine&&(o+=" LINE"),n.visualBlock&&(o+=" BLOCK")),n.status&&(o+=(o?" ":"")+n.status),o},updateMacCompositionHandlers:function(e,t){var n=function(t){var n=e.state.cm;if(sn(n).insertMode)this.onCompositionUpdateOrig(t);else{var o=this.textInput.getElement();o.blur(),o.focus(),o.value=t}},o=function(t){var n=e.state.cm;sn(n).insertMode&&this.onCompositionStartOrig(t)};t?e.onCompositionUpdateOrig||(e.onCompositionUpdateOrig=e.onCompositionUpdate,e.onCompositionUpdate=n,e.onCompositionStartOrig=e.onCompositionStart,e.onCompositionStart=o):e.onCompositionUpdateOrig&&(e.onCompositionUpdate=e.onCompositionUpdateOrig,e.onCompositionUpdateOrig=null,e.onCompositionStart=e.onCompositionStartOrig,e.onCompositionStartOrig=null)}};Et.defineOption({name:"wrap",set:function(e,t){t&&t.ace.setOption("wrap",e)},type:"boolean"},!1),Et.defineEx("write","w",function(){console.log(":write is not implemented")}),xt.push({keys:"zc",type:"action",action:"fold",actionArgs:{open:!1}},{keys:"zC",type:"action",action:"fold",actionArgs:{open:!1,all:!0}},{keys:"zo",type:"action",action:"fold",actionArgs:{open:!0}},{keys:"zO",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"za",type:"action",action:"fold",actionArgs:{toggle:!0}},{keys:"zA",type:"action",action:"fold",actionArgs:{toggle:!0,all:!0}},{keys:"zf",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"zd",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"<C-A-k>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorAbove"}},{keys:"<C-A-j>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorBelow"}},{keys:"<C-A-S-k>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorAboveSkipCurrent"}},{keys:"<C-A-S-j>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorBelowSkipCurrent"}},{keys:"<C-A-h>",type:"action",action:"aceCommand",actionArgs:{name:"selectMoreBefore"}},{keys:"<C-A-l>",type:"action",action:"aceCommand",actionArgs:{name:"selectMoreAfter"}},{keys:"<C-A-S-h>",type:"action",action:"aceCommand",actionArgs:{name:"selectNextBefore"}},{keys:"<C-A-S-l>",type:"action",action:"aceCommand",actionArgs:{name:"selectNextAfter"}}),Gt.aceCommand=function(e,t){e.vimCmd=t,e.ace.inVirtualSelectionMode?e.ace.on("beforeEndOperation",ht):ht(null,e.ace)},Gt.fold=function(e,t){e.ace.execCommand(["toggleFoldWidget","toggleFoldWidget","foldOther","unfoldall"][(t.all?2:0)+(t.open?1:0)])},t.handler.defaultKeymap=xt,t.handler.actions=Gt,t.Vim=Et,Et.map("Y","yy","normal")}),define("ace/occur",["require","exports","module","ace/lib/oop","ace/range","ace/search","ace/edit_session","ace/search_highlight","ace/lib/dom"],function(e,t){"use strict";function n(){}var o=e("./lib/oop"),i=(e("./range").Range,e("./search").Search),r=e("./edit_session").EditSession,s=e("./search_highlight").SearchHighlight;o.inherits(n,i),function(){this.enter=function(e,t){if(!t.needle)return!1;var n=e.getCursorPosition();this.displayOccurContent(e,t);var o=this.originalToOccurPosition(e.session,n);return e.moveCursorToPosition(o),!0},this.exit=function(e,t){var n=t.translatePosition&&e.getCursorPosition(),o=n&&this.occurToOriginalPosition(e.session,n);return this.displayOriginalContent(e),o&&e.moveCursorToPosition(o),!0},this.highlight=function(e,t){(e.$occurHighlight=e.$occurHighlight||e.addDynamicMarker(new s(null,"ace_occur-highlight","text"))).setRegexp(t),e._emit("changeBackMarker")},this.displayOccurContent=function(e,t){this.$originalSession=e.session;var n=this.matchingLines(e.session,t),o=n.map(function(e){return e.content}),i=new r(o.join("\n"));i.$occur=this,i.$occurMatchingLines=n,e.setSession(i),this.$useEmacsStyleLineStart=this.$originalSession.$useEmacsStyleLineStart,i.$useEmacsStyleLineStart=this.$useEmacsStyleLineStart,this.highlight(i,t.re),i._emit("changeBackMarker")},this.displayOriginalContent=function(e){e.setSession(this.$originalSession),this.$originalSession.$useEmacsStyleLineStart=this.$useEmacsStyleLineStart},this.originalToOccurPosition=function(e,t){var n=e.$occurMatchingLines,o={row:0,column:0};if(!n)return o;for(var i=0;i<n.length;i++)if(n[i].row===t.row)return{row:i,column:t.column};return o},this.occurToOriginalPosition=function(e,t){var n=e.$occurMatchingLines;return n&&n[t.row]?{row:n[t.row].row,column:t.column}:t},this.matchingLines=function(e,t){if(t=o.mixin({},t),!e||!t.needle)return[];var n=new i;return n.set(t),n.findAll(e).reduce(function(t,n){var o=n.start.row,i=t[t.length-1];return i&&i.row===o?t:t.concat({row:o,content:e.getLine(o)})},[])}}.call(n.prototype),e("./lib/dom").importCssString(".ace_occur-highlight {\n    border-radius: 4px;\n    background-color: rgba(87, 255, 8, 0.25);\n    position: absolute;\n    z-index: 4;\n    box-sizing: border-box;\n    box-shadow: 0 0 4px rgb(91, 255, 50);\n}\n.ace_dark .ace_occur-highlight {\n    background-color: rgb(80, 140, 85);\n    box-shadow: 0 0 4px rgb(60, 120, 70);\n}\n","incremental-occur-highlighting"),t.Occur=n}),define("ace/commands/occur_commands",["require","exports","module","ace/config","ace/occur","ace/keyboard/hash_handler","ace/lib/oop"],function(e,t){function n(){}var o=(e("../config"),e("../occur").Occur),i={name:"occur",exec:function(e,t){var i=!!e.session.$occur;(new o).enter(e,t)&&!i&&n.installIn(e)},readOnly:!0},r=[{name:"occurexit",bindKey:"esc|Ctrl-G",exec:function(e){var t=e.session.$occur;t&&(t.exit(e,{}),e.session.$occur||n.uninstallFrom(e))},readOnly:!0},{name:"occuraccept",bindKey:"enter",exec:function(e){var t=e.session.$occur;t&&(t.exit(e,{translatePosition:!0}),e.session.$occur||n.uninstallFrom(e))},readOnly:!0}],s=e("../keyboard/hash_handler").HashHandler;e("../lib/oop").inherits(n,s),function(){this.isOccurHandler=!0,this.attach=function(e){s.call(this,r,e.commands.platform),this.$editor=e};var e=this.handleKeyboard;this.handleKeyboard=function(t,n,o,i){var r=e.call(this,t,n,o,i);return r&&r.command?r:undefined}}.call(n.prototype),n.installIn=function(e){var t=new this;e.keyBinding.addKeyboardHandler(t),e.commands.addCommands(r)},n.uninstallFrom=function(e){e.commands.removeCommands(r);var t=e.getKeyboardHandler();t.isOccurHandler&&e.keyBinding.removeKeyboardHandler(t)},t.occurStartCommand=i}),define("ace/commands/incremental_search_commands",["require","exports","module","ace/config","ace/lib/oop","ace/keyboard/hash_handler","ace/commands/occur_commands"],function(e,t){function n(e){this.$iSearch=e}var o=e("../config"),i=e("../lib/oop"),r=e("../keyboard/hash_handler").HashHandler,s=e("./occur_commands").occurStartCommand;t.iSearchStartCommands=[{name:"iSearch",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(e,t){o.loadModule(["core","ace/incremental_search"],function(n){var o=n.iSearch=n.iSearch||new n.IncrementalSearch;o.activate(e,t.backwards),t.jumpToFirstMatch&&o.next(t)})},readOnly:!0},{name:"iSearchBackwards",exec:function(e){e.execCommand("iSearch",{backwards:!0})},readOnly:!0},{name:"iSearchAndGo",bindKey:{win:"Ctrl-K",mac:"Command-G"},exec:function(e){e.execCommand("iSearch",{jumpToFirstMatch:!0,useCurrentOrPrevSearch:!0})},readOnly:!0},{name:"iSearchBackwardsAndGo",bindKey:{win:"Ctrl-Shift-K",mac:"Command-Shift-G"},exec:function(e){e.execCommand("iSearch",{jumpToFirstMatch:!0,backwards:!0,useCurrentOrPrevSearch:!0})},readOnly:!0}],t.iSearchCommands=[{name:"restartSearch",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(e){e.cancelSearch(!0)}},{name:"searchForward",bindKey:{win:"Ctrl-S|Ctrl-K",mac:"Ctrl-S|Command-G"},exec:function(e,t){t.useCurrentOrPrevSearch=!0,e.next(t)}},{name:"searchBackward",bindKey:{win:"Ctrl-R|Ctrl-Shift-K",mac:"Ctrl-R|Command-Shift-G"},exec:function(e,t){t.useCurrentOrPrevSearch=!0,t.backwards=!0,e.next(t)}},{name:"extendSearchTerm",exec:function(e,t){e.addString(t)}},{name:"extendSearchTermSpace",bindKey:"space",exec:function(e){e.addString(" ")}},{name:"shrinkSearchTerm",bindKey:"backspace",exec:function(e){e.removeChar()}},{name:"confirmSearch",bindKey:"return",exec:function(e){e.deactivate()}},{name:"cancelSearch",bindKey:"esc|Ctrl-G",exec:function(e){e.deactivate(!0)}},{name:"occurisearch",bindKey:"Ctrl-O",exec:function(e){var t=i.mixin({},e.$options);e.deactivate(),s.exec(e.$editor,t)}},{name:"yankNextWord",bindKey:"Ctrl-w",exec:function(e){var t=e.$editor,n=t.selection.getRangeOfMovements(function(e){e.moveCursorWordRight()}),o=t.session.getTextRange(n);e.addString(o)}},{name:"yankNextChar",bindKey:"Ctrl-Alt-y",exec:function(e){var t=e.$editor,n=t.selection.getRangeOfMovements(function(e){e.moveCursorRight()}),o=t.session.getTextRange(n);e.addString(o)}},{name:"recenterTopBottom",bindKey:"Ctrl-l",exec:function(e){e.$editor.execCommand("recenterTopBottom")}},{name:"selectAllMatches",bindKey:"Ctrl-space",exec:function(e){var t=e.$editor,n=t.session.$isearchHighlight,o=n&&n.cache?n.cache.reduce(function(e,t){return e.concat(t||[])},[]):[];e.deactivate(!1),o.forEach(t.selection.addRange.bind(t.selection))}},{name:"searchAsRegExp",bindKey:"Alt-r",exec:function(e){e.convertNeedleToRegExp()}}].map(function(e){return e.readOnly=!0,e.isIncrementalSearchCommand=!0,e.scrollIntoView="animate-cursor",e}),i.inherits(n,r),function(){this.attach=function(e){var n=this.$iSearch;r.call(this,t.iSearchCommands,e.commands.platform),this.$commandExecHandler=e.commands.addEventListener("exec",function(t){if(!t.command.isIncrementalSearchCommand)return n.deactivate();t.stopPropagation(),t.preventDefault();var o=e.session.getScrollTop(),i=t.command.exec(n,t.args||{});return e.renderer.scrollCursorIntoView(null,.5),e.renderer.animateScrolling(o),i})},this.detach=function(e){this.$commandExecHandler&&(e.commands.removeEventListener("exec",this.$commandExecHandler),delete this.$commandExecHandler)};var e=this.handleKeyboard;this.handleKeyboard=function(t,n,o,i){if((1===n||8===n)&&"v"===o||1===n&&"y"===o)return null;var r=e.call(this,t,n,o,i);if(r.command)return r;if(-1==n){var s=this.commands.extendSearchTerm;if(s)return{command:s,args:o}}return!1}}.call(n.prototype),t.IncrementalSearchKeyboardHandler=n}),define("ace/incremental_search",["require","exports","module","ace/lib/oop","ace/range","ace/search","ace/search_highlight","ace/commands/incremental_search_commands","ace/lib/dom","ace/commands/command_manager","ace/editor","ace/config"],function(e,t){"use strict";function n(){this.$options={wrap:!1,skipCurrent:!1},this.$keyboardHandler=new h(this)}function o(e){return e instanceof RegExp}function i(e){var t=String(e),n=t.indexOf("/"),o=t.lastIndexOf("/");return{expression:t.slice(n+1,o),flags:t.slice(o+1)}}function r(e,t){try{return new RegExp(e,t)}catch(t){return e}}function s(e){return r(e.expression,e.flags)}var a=e("./lib/oop"),l=e("./range").Range,c=e("./search").Search,u=e("./search_highlight").SearchHighlight,d=e("./commands/incremental_search_commands"),h=d.IncrementalSearchKeyboardHandler;a.inherits(n,c),function(){this.activate=function(e,t){this.$editor=e,this.$startPos=this.$currentPos=e.getCursorPosition(),this.$options.needle="",this.$options.backwards=t,e.keyBinding.addKeyboardHandler(this.$keyboardHandler),this.$originalEditorOnPaste=e.onPaste,e.onPaste=this.onPaste.bind(this),this.$mousedownHandler=e.addEventListener("mousedown",this.onMouseDown.bind(this)),this.selectionFix(e),this.statusMessage(!0)},this.deactivate=function(e){this.cancelSearch(e);var t=this.$editor;t.keyBinding.removeKeyboardHandler(this.$keyboardHandler),this.$mousedownHandler&&(t.removeEventListener("mousedown",this.$mousedownHandler),delete this.$mousedownHandler),t.onPaste=this.$originalEditorOnPaste,this.message("")},this.selectionFix=function(e){e.selection.isEmpty()&&!e.session.$emacsMark&&e.clearSelection()},this.highlight=function(e){var t=this.$editor.session;(t.$isearchHighlight=t.$isearchHighlight||t.addDynamicMarker(new u(null,"ace_isearch-result","text"))).setRegexp(e),t._emit("changeBackMarker")},this.cancelSearch=function(e){var t=this.$editor;return this.$prevNeedle=this.$options.needle,this.$options.needle="",e?(t.moveCursorToPosition(this.$startPos),this.$currentPos=this.$startPos):t.pushEmacsMark&&t.pushEmacsMark(this.$startPos,!1),this.highlight(null),l.fromPoints(this.$currentPos,this.$currentPos)},this.highlightAndFindWithNeedle=function(e,t){if(!this.$editor)return null;var n=this.$options;if(t&&(n.needle=t.call(this,n.needle||"")||""),0===n.needle.length)return this.statusMessage(!0),this.cancelSearch(!0);n.start=this.$currentPos;var o=this.$editor.session,i=this.find(o),r=this.$editor.emacsMark?!!this.$editor.emacsMark():!this.$editor.selection.isEmpty();return i&&(n.backwards&&(i=l.fromPoints(i.end,i.start)),this.$editor.selection.setRange(l.fromPoints(r?this.$startPos:i.end,i.end)),e&&(this.$currentPos=i.end),this.highlight(n.re)),this.statusMessage(i),i},this.addString=function(e){return this.highlightAndFindWithNeedle(!1,function(t){if(!o(t))return t+e;var n=i(t);return n.expression+=e,s(n)})},this.removeChar=function(){return this.highlightAndFindWithNeedle(!1,function(e){if(!o(e))return e.substring(0,e.length-1);var t=i(e);return t.expression=t.expression.substring(0,t.expression.length-1),s(t)})},this.next=function(e){return e=e||{},this.$options.backwards=!!e.backwards,this.$currentPos=this.$editor.getCursorPosition(),this.highlightAndFindWithNeedle(!0,function(t){return e.useCurrentOrPrevSearch&&0===t.length?this.$prevNeedle||"":t})},this.onMouseDown=function(){return this.deactivate(),!0},this.onPaste=function(e){this.addString(e)},this.convertNeedleToRegExp=function(){return this.highlightAndFindWithNeedle(!1,function(e){return o(e)?e:r(e,"ig")})},this.convertNeedleToString=function(){return this.highlightAndFindWithNeedle(!1,function(e){return o(e)?i(e).expression:e})},this.statusMessage=function(e){var t=this.$options,n="";n+=t.backwards?"reverse-":"",n+="isearch: "+t.needle,n+=e?"":" (not found)",this.message(n)},this.message=function(e){this.$editor.showCommandLine?(this.$editor.showCommandLine(e),this.$editor.focus()):console.log(e)}}.call(n.prototype),t.IncrementalSearch=n;var p=e("./lib/dom");p.importCssString&&p.importCssString(".ace_marker-layer .ace_isearch-result {  position: absolute;  z-index: 6;  box-sizing: border-box;}div.ace_isearch-result {  border-radius: 4px;  background-color: rgba(255, 200, 0, 0.5);  box-shadow: 0 0 4px rgb(255, 200, 0);}.ace_dark div.ace_isearch-result {  background-color: rgb(100, 110, 160);  box-shadow: 0 0 4px rgb(80, 90, 140);}","incremental-search-highlighting");var f=e("./commands/command_manager");(function(){this.setupIncrementalSearch=function(e,t){if(this.usesIncrementalSearch!=t){this.usesIncrementalSearch=t;var n=d.iSearchStartCommands;this[t?"addCommands":"removeCommands"](n)}}}).call(f.CommandManager.prototype);var m=e("./editor").Editor;e("./config").defineOptions(m.prototype,"editor",{useIncrementalSearch:{set:function(e){this.keyBinding.$handlers.forEach(function(t){
t.setupIncrementalSearch&&t.setupIncrementalSearch(this,e)}),this._emit("incrementalSearchSettingChanged",{isEnabled:e})}}})}),define("ace/keyboard/emacs",["require","exports","module","ace/lib/dom","ace/incremental_search","ace/commands/incremental_search_commands","ace/keyboard/hash_handler","ace/lib/keys"],function(e,t){"use strict";var n=e("../lib/dom");e("../incremental_search");var o=e("../commands/incremental_search_commands"),i=function(e,t){var n=this.scroller.getBoundingClientRect(),o=e+this.scrollLeft-n.left-this.$padding,i=Math.floor(o/this.characterWidth),r=Math.floor((t+this.scrollTop-n.top)/this.lineHeight);return this.session.screenToDocumentPosition(r,i,o)},r=e("./hash_handler").HashHandler;t.handler=new r,t.handler.isEmacs=!0,t.handler.$id="ace/keyboard/emacs";var s,a,l=!1;t.handler.attach=function(e){l||(l=!0,n.importCssString("            .emacs-mode .ace_cursor{                border: 1px rgba(50,250,50,0.8) solid!important;                box-sizing: border-box!important;                background-color: rgba(0,250,0,0.9);                opacity: 0.5;            }            .emacs-mode .ace_hidden-cursors .ace_cursor{                opacity: 1;                background-color: transparent;            }            .emacs-mode .ace_overwrite-cursors .ace_cursor {                opacity: 1;                background-color: transparent;                border-width: 0 0 2px 2px !important;            }            .emacs-mode .ace_text-layer {                z-index: 4            }            .emacs-mode .ace_cursor-layer {                z-index: 2            }","emacsMode")),s=e.session.$selectLongWords,e.session.$selectLongWords=!0,a=e.session.$useEmacsStyleLineStart,e.session.$useEmacsStyleLineStart=!0,e.session.$emacsMark=null,e.session.$emacsMarkRing=e.session.$emacsMarkRing||[],e.emacsMark=function(){return this.session.$emacsMark},e.setEmacsMark=function(e){this.session.$emacsMark=e},e.pushEmacsMark=function(e,t){var n=this.session.$emacsMark;n&&this.session.$emacsMarkRing.push(n),!e||t?this.setEmacsMark(e):this.session.$emacsMarkRing.push(e)},e.popEmacsMark=function(){var e=this.emacsMark();return e?(this.setEmacsMark(null),e):this.session.$emacsMarkRing.pop()},e.getLastEmacsMark=function(){return this.session.$emacsMark||this.session.$emacsMarkRing.slice(-1)[0]},e.emacsMarkForSelection=function(e){var t=this.selection,n=this.multiSelect?this.multiSelect.getAllRanges().length:1,o=t.index||0,i=this.session.$emacsMarkRing,r=i.length-(n-o),s=i[r]||t.anchor;return e&&i.splice(r,1,"row"in e&&"column"in e?e:undefined),s},e.on("click",u),e.on("changeSession",c),e.renderer.screenToTextCoordinates=i,e.setStyle("emacs-mode"),e.commands.addCommands(p),t.handler.platform=e.commands.platform,e.$emacsModeHandler=this,e.addEventListener("copy",this.onCopy),e.addEventListener("paste",this.onPaste)},t.handler.detach=function(e){delete e.renderer.screenToTextCoordinates,e.session.$selectLongWords=s,e.session.$useEmacsStyleLineStart=a,e.removeEventListener("click",u),e.removeEventListener("changeSession",c),e.unsetStyle("emacs-mode"),e.commands.removeCommands(p),e.removeEventListener("copy",this.onCopy),e.removeEventListener("paste",this.onPaste),e.$emacsModeHandler=null};var c=function(e){e.oldSession&&(e.oldSession.$selectLongWords=s,e.oldSession.$useEmacsStyleLineStart=a),s=e.session.$selectLongWords,e.session.$selectLongWords=!0,a=e.session.$useEmacsStyleLineStart,e.session.$useEmacsStyleLineStart=!0,e.session.hasOwnProperty("$emacsMark")||(e.session.$emacsMark=null),e.session.hasOwnProperty("$emacsMarkRing")||(e.session.$emacsMarkRing=[])},u=function(e){e.editor.session.$emacsMark=null},d=e("../lib/keys").KEY_MODS,h={C:"ctrl",S:"shift",M:"alt",CMD:"command"};["C-S-M-CMD","S-M-CMD","C-M-CMD","C-S-CMD","C-S-M","M-CMD","S-CMD","S-M","C-CMD","C-M","C-S","CMD","M","S","C"].forEach(function(e){var t=0;e.split("-").forEach(function(e){t|=d[h[e]]}),h[t]=e.toLowerCase()+"-"}),t.handler.onCopy=function(e,n){n.$handlesEmacsOnCopy||(n.$handlesEmacsOnCopy=!0,t.handler.commands.killRingSave.exec(n),n.$handlesEmacsOnCopy=!1)},t.handler.onPaste=function(e,t){t.pushEmacsMark(t.getCursorPosition())},t.handler.bindKey=function(e,t){if("object"==typeof e&&(e=e[this.platform]),e){var n=this.commandKeyBinding;e.split("|").forEach(function(e){e=e.toLowerCase(),n[e]=t,e.split(" ").slice(0,-1).reduce(function(e,t,n){var o=e[n-1]?e[n-1]+" ":"";return e.concat([o+t])},[]).forEach(function(e){n[e]||(n[e]="null")})},this)}},t.handler.getStatusText=function(e,t){var n="";return t.count&&(n+=t.count),t.keyChain&&(n+=" "+t.keyChain),n},t.handler.handleKeyboard=function(e,t,n,o){if(-1===o)return undefined;var i=e.editor;if(i._signal("changeStatus"),-1==t&&(i.pushEmacsMark(),e.count)){var r=new Array(e.count+1).join(n);return e.count=null,{command:"insertstring",args:r}}var s=h[t];if("c-"==s||e.count){var a=parseInt(n[n.length-1]);if("number"==typeof a&&!isNaN(a))return e.count=Math.max(e.count,0)||0,e.count=10*e.count+a,{command:"null"}}s&&(n=s+n),e.keyChain&&(n=e.keyChain+=" "+n);var l=this.commandKeyBinding[n];if(e.keyChain="null"==l?n:"",!l)return undefined;if("null"===l)return{command:"null"};if("universalArgument"===l)return e.count=-4,{command:"null"};var c;if("string"!=typeof l&&(c=l.args,l.command&&(l=l.command),"goorselect"===l&&(l=i.emacsMark()?c[1]:c[0],c=null)),"string"==typeof l&&("insertstring"!==l&&"splitline"!==l&&"togglecomment"!==l||i.pushEmacsMark(),!(l=this.commands[l]||i.commands.commands[l])))return undefined;if(l.readOnly||l.isYank||(e.lastCommand=null),!l.readOnly&&i.emacsMark()&&i.setEmacsMark(null),e.count){var a=e.count;if(e.count=0,!l||!l.handlesCount)return{args:c,command:{exec:function(e,t){for(var n=0;n<a;n++)l.exec(e,t)},multiSelectAction:l.multiSelectAction}};c||(c={}),"object"==typeof c&&(c.count=a)}return{command:l,args:c}},t.emacsKeys={"Up|C-p":{command:"goorselect",args:["golineup","selectup"]},"Down|C-n":{command:"goorselect",args:["golinedown","selectdown"]},"Left|C-b":{command:"goorselect",args:["gotoleft","selectleft"]},"Right|C-f":{command:"goorselect",args:["gotoright","selectright"]},"C-Left|M-b":{command:"goorselect",args:["gotowordleft","selectwordleft"]},"C-Right|M-f":{command:"goorselect",args:["gotowordright","selectwordright"]},"Home|C-a":{command:"goorselect",args:["gotolinestart","selecttolinestart"]},"End|C-e":{command:"goorselect",args:["gotolineend","selecttolineend"]},"C-Home|S-M-,":{command:"goorselect",args:["gotostart","selecttostart"]},"C-End|S-M-.":{command:"goorselect",args:["gotoend","selecttoend"]},"S-Up|S-C-p":"selectup","S-Down|S-C-n":"selectdown","S-Left|S-C-b":"selectleft","S-Right|S-C-f":"selectright","S-C-Left|S-M-b":"selectwordleft","S-C-Right|S-M-f":"selectwordright","S-Home|S-C-a":"selecttolinestart","S-End|S-C-e":"selecttolineend","S-C-Home":"selecttostart","S-C-End":"selecttoend","C-l":"recenterTopBottom","M-s":"centerselection","M-g":"gotoline","C-x C-p":"selectall","C-Down":{command:"goorselect",args:["gotopagedown","selectpagedown"]},"C-Up":{command:"goorselect",args:["gotopageup","selectpageup"]},"PageDown|C-v":{command:"goorselect",args:["gotopagedown","selectpagedown"]},"PageUp|M-v":{command:"goorselect",args:["gotopageup","selectpageup"]},"S-C-Down":"selectpagedown","S-C-Up":"selectpageup","C-s":"iSearch","C-r":"iSearchBackwards","M-C-s":"findnext","M-C-r":"findprevious","S-M-5":"replace",Backspace:"backspace","Delete|C-d":"del","Return|C-m":{command:"insertstring",args:"\n"},"C-o":"splitline","M-d|C-Delete":{command:"killWord",args:"right"},"C-Backspace|M-Backspace|M-Delete":{command:"killWord",args:"left"},"C-k":"killLine","C-y|S-Delete":"yank","M-y":"yankRotate","C-g":"keyboardQuit","C-w|C-S-W":"killRegion","M-w":"killRingSave","C-Space":"setMark","C-x C-x":"exchangePointAndMark","C-t":"transposeletters","M-u":"touppercase","M-l":"tolowercase","M-/":"autocomplete","C-u":"universalArgument","M-;":"togglecomment","C-/|C-x u|S-C--|C-z":"undo","S-C-/|S-C-x u|C--|S-C-z":"redo","C-x r":"selectRectangularRegion","M-x":{command:"focusCommandLine",args:"M-x "}},t.handler.bindKeys(t.emacsKeys),t.handler.addCommands({recenterTopBottom:function(e){var t=e.renderer,n=t.$cursorLayer.getPixelPosition(),o=t.$size.scrollerHeight-t.lineHeight,i=t.scrollTop;i=Math.abs(n.top-i)<2?n.top-o:Math.abs(n.top-i-.5*o)<2?n.top:n.top-.5*o,e.session.setScrollTop(i)},selectRectangularRegion:function(e){e.multiSelect.toggleBlockSelection()},setMark:{exec:function(e,t){function n(){var t=e.popEmacsMark();t&&e.moveCursorToPosition(t)}if(t&&t.count)return e.inMultiSelectMode?e.forEachSelection(n):n(),void n();var o=e.emacsMark(),i=e.selection.getAllRanges(),r=i.map(function(e){return{row:e.start.row,column:e.start.column}}),s=i.every(function(e){return e.isEmpty()});return!o&&s?o?void 0:(r.forEach(function(t){e.pushEmacsMark(t)}),void e.setEmacsMark(r[r.length-1])):(e.inMultiSelectMode?e.forEachSelection({exec:e.clearSelection.bind(e)}):e.clearSelection(),void(o&&e.pushEmacsMark(null)))},readOnly:!0,handlesCount:!0},exchangePointAndMark:{exec:function(e,t){var n=e.selection;if(!t.count&&!n.isEmpty())return void n.setSelectionRange(n.getRange(),!n.isBackwards());if(t.count){var o={row:n.lead.row,column:n.lead.column};n.clearSelection(),n.moveCursorToPosition(e.emacsMarkForSelection(o))}else n.selectToPosition(e.emacsMarkForSelection())},readOnly:!0,handlesCount:!0,multiSelectAction:"forEach"},killWord:{exec:function(e,n){e.clearSelection(),"left"==n?e.selection.selectWordLeft():e.selection.selectWordRight();var o=e.getSelectionRange(),i=e.session.getTextRange(o);t.killRing.add(i),e.session.remove(o),e.clearSelection()},multiSelectAction:"forEach"},killLine:function(e){e.pushEmacsMark(null),e.clearSelection();var n=e.getSelectionRange(),o=e.session.getLine(n.start.row);n.end.column=o.length,o=o.substr(n.start.column);var i=e.session.getFoldLine(n.start.row);i&&n.end.row!=i.end.row&&(n.end.row=i.end.row,o="x"),/^\s*$/.test(o)&&(n.end.row++,o=e.session.getLine(n.end.row),n.end.column=/^\s*$/.test(o)?o.length:0);var r=e.session.getTextRange(n);e.prevOp.command==this?t.killRing.append(r):t.killRing.add(r),e.session.remove(n),e.clearSelection()},yank:function(e){e.onPaste(t.killRing.get()||""),e.keyBinding.$data.lastCommand="yank"},yankRotate:function(e){"yank"==e.keyBinding.$data.lastCommand&&(e.undo(),e.session.$emacsMarkRing.pop(),e.onPaste(t.killRing.rotate()),e.keyBinding.$data.lastCommand="yank")},killRegion:{exec:function(e){t.killRing.add(e.getCopyText()),e.commands.byName.cut.exec(e),e.setEmacsMark(null)},readOnly:!0,multiSelectAction:"forEach"},killRingSave:{exec:function(e){e.$handlesEmacsOnCopy=!0;var n=e.session.$emacsMarkRing.slice(),o=[];t.killRing.add(e.getCopyText()),setTimeout(function(){function t(){var t=e.selection,n=t.getRange(),i=t.isBackwards()?n.end:n.start;o.push({row:i.row,column:i.column}),t.clearSelection()}e.$handlesEmacsOnCopy=!1,e.inMultiSelectMode?e.forEachSelection({exec:t}):t(),e.session.$emacsMarkRing=n.concat(o.reverse())},0)},readOnly:!0},keyboardQuit:function(e){e.selection.clearSelection(),e.setEmacsMark(null),e.keyBinding.$data.count=null},focusCommandLine:function(e,t){e.showCommandLine&&e.showCommandLine(t)}}),t.handler.addCommands(o.iSearchStartCommands);var p=t.handler.commands;p.yank.isYank=!0,p.yankRotate.isYank=!0,t.killRing={$data:[],add:function(e){e&&this.$data.push(e),this.$data.length>30&&this.$data.shift()},append:function(e){var t=this.$data.length-1,n=this.$data[t]||"";e&&(n+=e),n&&(this.$data[t]=n)},get:function(e){return e=e||1,this.$data.slice(this.$data.length-e,this.$data.length).reverse().join("\n")},pop:function(){return this.$data.length>1&&this.$data.pop(),this.get()},rotate:function(){return this.$data.unshift(this.$data.pop()),this.get()}}}),/*!
 * Select2 4.0.3
 * https://select2.github.io
 *
 * Released under the MIT license
 * https://github.com/select2/select2/blob/master/LICENSE.md
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var t=function(){if(e&&e.fn&&e.fn.select2&&e.fn.select2.amd)var t=e.fn.select2.amd;var t;/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 */
return function(){if(!t||!t.requirejs){t?n=t:t={};/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
var e,n,o;!function(t){function i(e,t){return w.call(e,t)}function r(e,t){var n,o,i,r,s,a,l,c,u,d,h,p=t&&t.split("/"),f=y.map,m=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),s=e.length-1,y.nodeIdCompat&&k.test(e[s])&&(e[s]=e[s].replace(k,"")),e=p.slice(0,p.length-1).concat(e),u=0;u<e.length;u+=1)if("."===(h=e[u]))e.splice(u,1),u-=1;else if(".."===h){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||m)&&f){for(n=e.split("/"),u=n.length;u>0;u-=1){if(o=n.slice(0,u).join("/"),p)for(d=p.length;d>0;d-=1)if((i=f[p.slice(0,d).join("/")])&&(i=i[o])){r=i,a=u;break}if(r)break;!l&&m&&m[o]&&(l=m[o],c=u)}!r&&l&&(r=l,a=c),r&&(n.splice(0,a,r),e=n.join("/"))}return e}function s(e,n){return function(){var o=C.call(arguments,0);return"string"!=typeof o[0]&&1===o.length&&o.push(null),p.apply(t,o.concat([e,n]))}}function a(e){return function(t){return r(t,e)}}function l(e){return function(t){g[e]=t}}function c(e){if(i(v,e)){var n=v[e];delete v[e],b[e]=!0,h.apply(t,n)}if(!i(g,e)&&!i(b,e))throw new Error("No "+e);return g[e]}function u(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function d(e){return function(){return y&&y.config&&y.config[e]||{}}}var h,p,f,m,g={},v={},y={},b={},w=Object.prototype.hasOwnProperty,C=[].slice,k=/\.js$/;f=function(e,t){var n,o=u(e),i=o[0];return e=o[1],i&&(i=r(i,t),n=c(i)),i?e=n&&n.normalize?n.normalize(e,a(t)):r(e,t):(e=r(e,t),o=u(e),i=o[0],e=o[1],i&&(n=c(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},m={require:function(e){return s(e)},exports:function(e){var t=g[e];return void 0!==t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:d(e)}}},h=function(e,n,o,r){var a,u,d,h,p,y,w=[],C=typeof o;if(r=r||e,"undefined"===C||"function"===C){for(n=!n.length&&o.length?["require","exports","module"]:n,p=0;p<n.length;p+=1)if(h=f(n[p],r),"require"===(u=h.f))w[p]=m.require(e);else if("exports"===u)w[p]=m.exports(e),y=!0;else if("module"===u)a=w[p]=m.module(e);else if(i(g,u)||i(v,u)||i(b,u))w[p]=c(u);else{if(!h.p)throw new Error(e+" missing "+u);h.p.load(h.n,s(r,!0),l(u),{}),w[p]=g[u]}d=o?o.apply(g[e],w):undefined,e&&(a&&a.exports!==t&&a.exports!==g[e]?g[e]=a.exports:d===t&&y||(g[e]=d))}else e&&(g[e]=o)},e=n=p=function(e,n,o,i,r){if("string"==typeof e)return m[e]?m[e](n):c(f(e,n).f);if(!e.splice){if(y=e,y.deps&&p(y.deps,y.callback),!n)return;n.splice?(e=n,n=o,o=null):e=t}return n=n||function(){},"function"==typeof o&&(o=i,i=r),i?h(t,e,n,o):setTimeout(function(){h(t,e,n,o)},4),p},p.config=function(e){return p(e)},e._defined=g,o=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),i(g,e)||i(v,e)||(v[e]=[e,t,n])},o.amd={jQuery:!0}}(),t.requirejs=e,t.require=n,t.define=o}}(),t.define("almond",function(){}),t.define("jquery",[],function(){var t=e||$;return null==t&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),t}),t.define("select2/utils",["jquery"],function(e){function t(e){var t=e.prototype,n=[];for(var o in t){"function"==typeof t[o]&&("constructor"!==o&&n.push(o))}return n}var n={};n.Extend=function(e,t){function n(){this.constructor=e}var o={}.hasOwnProperty;for(var i in t)o.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},n.Decorate=function(e,n){function o(){var t=Array.prototype.unshift,o=n.prototype.constructor.length,i=e.prototype.constructor;o>0&&(t.call(arguments,e.prototype.constructor),i=n.prototype.constructor),i.apply(this,arguments)}function i(){this.constructor=o}var r=t(n),s=t(e);n.displayName=e.displayName,o.prototype=new i;for(var a=0;a<s.length;a++){var l=s[a];o.prototype[l]=e.prototype[l]}for(var c=(function(e){var t=function(){};e in o.prototype&&(t=o.prototype[e]);var i=n.prototype[e];return function(){return Array.prototype.unshift.call(arguments,t),i.apply(this,arguments)}}),u=0;u<r.length;u++){var d=r[u];o.prototype[d]=c(d)}return o};var o=function(){this.listeners={}};return o.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},o.prototype.trigger=function(e){var t=Array.prototype.slice,n=t.call(arguments,1);this.listeners=this.listeners||{},null==n&&(n=[]),0===n.length&&n.push({}),n[0]._type=e,e in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},o.prototype.invoke=function(e,t){for(var n=0,o=e.length;n<o;n++)e[n].apply(this,t)},n.Observable=o,n.generateChars=function(e){for(var t="",n=0;n<e;n++){t+=Math.floor(36*Math.random()).toString(36)}return t},n.bind=function(e,t){return function(){e.apply(t,arguments)}},n._convertData=function(e){for(var t in e){var n=t.split("-"),o=e;if(1!==n.length){for(var i=0;i<n.length;i++){var r=n[i];r=r.substring(0,1).toLowerCase()+r.substring(1),r in o||(o[r]={}),i==n.length-1&&(o[r]=e[t]),o=o[r]}delete e[t]}}return e},n.hasScroll=function(t,n){var o=e(n),i=n.style.overflowX,r=n.style.overflowY;return(i!==r||"hidden"!==r&&"visible"!==r)&&("scroll"===i||"scroll"===r||(o.innerHeight()<n.scrollHeight||o.innerWidth()<n.scrollWidth))},n.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},n.appendMany=function(t,n){if("1.7"===e.fn.jquery.substr(0,3)){var o=e();e.map(n,function(e){o=o.add(e)}),n=o}t.append(n)},n}),t.define("select2/results",["jquery","./utils"],function(e,t){function n(e,t,o){this.$element=e,this.data=o,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,t.Observable),n.prototype.render=function(){var t=e('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},n.prototype.clear=function(){this.$results.empty()},n.prototype.displayMessage=function(t){var n=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var o=e('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),i=this.options.get("translations").get(t.message);o.append(n(i(t.args))),o[0].className+=" select2-results__message",this.$results.append(o)},n.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},n.prototype.append=function(e){this.hideLoading();var t=[];if(null==e.results||0===e.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));e.results=this.sort(e.results);for(var n=0;n<e.results.length;n++){var o=e.results[n],i=this.option(o);t.push(i)}this.$results.append(t)},n.prototype.position=function(e,t){t.find(".select2-results").append(e)},n.prototype.sort=function(e){return this.options.get("sorter")(e)},n.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option[aria-selected]"),t=e.filter("[aria-selected=true]");t.length>0?t.first().trigger("mouseenter"):e.first().trigger("mouseenter"),this.ensureHighlightVisible()},n.prototype.setClasses=function(){var t=this;this.data.current(function(n){var o=e.map(n,function(e){return e.id.toString()});t.$results.find(".select2-results__option[aria-selected]").each(function(){var t=e(this),n=e.data(this,"data"),i=""+n.id;null!=n.element&&n.element.selected||null==n.element&&e.inArray(i,o)>-1?t.attr("aria-selected","true"):t.attr("aria-selected","false")})})},n.prototype.showLoading=function(e){this.hideLoading();var t=this.options.get("translations").get("searching"),n={disabled:!0,loading:!0,text:t(e)},o=this.option(n);o.className+=" loading-results",this.$results.prepend(o)},n.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},n.prototype.option=function(t){var n=document.createElement("li");n.className="select2-results__option";var o={role:"treeitem","aria-selected":"false"};t.disabled&&(delete o["aria-selected"],o["aria-disabled"]="true"),null==t.id&&delete o["aria-selected"],null!=t._resultId&&(n.id=t._resultId),t.title&&(n.title=t.title),t.children&&(o.role="group",o["aria-label"]=t.text,delete o["aria-selected"]);for(var i in o){var r=o[i];n.setAttribute(i,r)}if(t.children){var s=e(n),a=document.createElement("strong");a.className="select2-results__group";e(a);this.template(t,a);for(var l=[],c=0;c<t.children.length;c++){var u=t.children[c],d=this.option(u);l.push(d)}var h=e("<ul></ul>",{"class":"select2-results__options select2-results__options--nested"});h.append(l),s.append(a),s.append(h)}else this.template(t,n);return e.data(n,"data",t),n},n.prototype.bind=function(t){var n=this,o=t.id+"-results";this.$results.attr("id",o),t.on("results:all",function(e){n.clear(),n.append(e.data),t.isOpen()&&(n.setClasses(),n.highlightFirstItem())}),t.on("results:append",function(e){n.append(e.data),t.isOpen()&&n.setClasses()}),t.on("query",function(e){n.hideMessages(),n.showLoading(e)}),t.on("select",function(){t.isOpen()&&(n.setClasses(),n.highlightFirstItem())}),t.on("unselect",function(){t.isOpen()&&(n.setClasses(),n.highlightFirstItem())}),t.on("open",function(){n.$results.attr("aria-expanded","true"),n.$results.attr("aria-hidden","false"),n.setClasses(),n.ensureHighlightVisible()}),t.on("close",function(){n.$results.attr("aria-expanded","false"),n.$results.attr("aria-hidden","true"),n.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=n.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e=n.getHighlightedResults();if(0!==e.length){var t=e.data("data");"true"==e.attr("aria-selected")?n.trigger("close",{}):n.trigger("select",{data:t})}}),t.on("results:previous",function(){var e=n.getHighlightedResults(),t=n.$results.find("[aria-selected]"),o=t.index(e);if(0!==o){var i=o-1;0===e.length&&(i=0);var r=t.eq(i);r.trigger("mouseenter");var s=n.$results.offset().top,a=r.offset().top,l=n.$results.scrollTop()+(a-s);0===i?n.$results.scrollTop(0):a-s<0&&n.$results.scrollTop(l)}}),t.on("results:next",function(){var e=n.getHighlightedResults(),t=n.$results.find("[aria-selected]"),o=t.index(e),i=o+1;if(!(i>=t.length)){var r=t.eq(i);r.trigger("mouseenter");var s=n.$results.offset().top+n.$results.outerHeight(!1),a=r.offset().top+r.outerHeight(!1),l=n.$results.scrollTop()+a-s;0===i?n.$results.scrollTop(0):a>s&&n.$results.scrollTop(l)}}),t.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),t.on("results:message",function(e){n.displayMessage(e)}),e.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=n.$results.scrollTop(),o=n.$results.get(0).scrollHeight-t+e.deltaY,i=e.deltaY>0&&t-e.deltaY<=0,r=e.deltaY<0&&o<=n.$results.height();i?(n.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):r&&(n.$results.scrollTop(n.$results.get(0).scrollHeight-n.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(t){var o=e(this),i=o.data("data");if("true"===o.attr("aria-selected"))return void(n.options.get("multiple")?n.trigger("unselect",{originalEvent:t,data:i}):n.trigger("close",{}));n.trigger("select",{originalEvent:t,data:i})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(){var t=e(this).data("data");n.getHighlightedResults().removeClass("select2-results__option--highlighted"),n.trigger("results:focus",{data:t,element:e(this)})})},n.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},n.prototype.destroy=function(){this.$results.remove()},n.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(0!==e.length){var t=this.$results.find("[aria-selected]"),n=t.index(e),o=this.$results.offset().top,i=e.offset().top,r=this.$results.scrollTop()+(i-o),s=i-o;r-=2*e.outerHeight(!1),n<=2?this.$results.scrollTop(0):(s>this.$results.outerHeight()||s<0)&&this.$results.scrollTop(r)}},n.prototype.template=function(t,n){var o=this.options.get("templateResult"),i=this.options.get("escapeMarkup"),r=o(t,n);null==r?n.style.display="none":"string"==typeof r?n.innerHTML=i(r):e(n).append(r)},n}),t.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),t.define("select2/selection/base",["jquery","../utils","../keys"],function(e,t,n){function o(e,t){this.$element=e,this.options=t,o.__super__.constructor.call(this)}return t.Extend(o,t.Observable),o.prototype.render=function(){var t=e('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),t.attr("title",this.$element.attr("title")),t.attr("tabindex",this._tabindex),this.$selection=t,t},o.prototype.bind=function(e){var t=this,o=(e.id,e.id+"-results");this.container=e,this.$selection.on("focus",function(e){t.trigger("focus",e)}),this.$selection.on("blur",function(e){t._handleBlur(e)}),this.$selection.on("keydown",function(e){t.trigger("keypress",e),e.which===n.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){t.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){t.update(e.data)}),e.on("open",function(){t.$selection.attr("aria-expanded","true"),t.$selection.attr("aria-owns",o),t._attachCloseHandler(e)}),e.on("close",function(){t.$selection.attr("aria-expanded","false"),t.$selection.removeAttr("aria-activedescendant"),t.$selection.removeAttr("aria-owns"),t.$selection.focus(),t._detachCloseHandler(e)}),e.on("enable",function(){t.$selection.attr("tabindex",t._tabindex)}),e.on("disable",function(){t.$selection.attr("tabindex","-1")})},o.prototype._handleBlur=function(t){var n=this;window.setTimeout(function(){document.activeElement==n.$selection[0]||e.contains(n.$selection[0],document.activeElement)||n.trigger("blur",t)},1)},o.prototype._attachCloseHandler=function(t){e(document.body).on("mousedown.select2."+t.id,function(t){var n=e(t.target),o=n.closest(".select2");e(".select2.select2-container--open").each(function(){var t=e(this);this!=o[0]&&t.data("element").select2("close")})})},o.prototype._detachCloseHandler=function(t){e(document.body).off("mousedown.select2."+t.id)},o.prototype.position=function(e,t){t.find(".selection").append(e)},o.prototype.destroy=function(){this._detachCloseHandler(this.container)},o.prototype.update=function(){throw new Error("The `update` method must be defined in child classes.")},o}),t.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,n){function o(){o.__super__.constructor.apply(this,arguments)}return n.Extend(o,t),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},o.prototype.bind=function(e){var t=this;o.__super__.bind.apply(this,arguments);var n=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",n),this.$selection.attr("aria-labelledby",n),this.$selection.on("mousedown",function(e){1===e.which&&t.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(){}),this.$selection.on("blur",function(){}),e.on("focus",function(){e.isOpen()||t.$selection.focus()}),e.on("selection:update",function(e){t.update(e.data)})},o.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},o.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},o.prototype.selectionContainer=function(){return e("<span></span>")},o.prototype.update=function(e){if(0===e.length)return void this.clear();var t=e[0],n=this.$selection.find(".select2-selection__rendered"),o=this.display(t,n);n.empty().append(o),n.prop("title",t.title||t.text)},o}),t.define("select2/selection/multiple",["jquery","./base","../utils"],function(e,t,n){function o(){o.__super__.constructor.apply(this,arguments)}return n.Extend(o,t),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},o.prototype.bind=function(){var t=this;o.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){t.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(n){if(!t.options.get("disabled")){var o=e(this),i=o.parent(),r=i.data("data");t.trigger("unselect",{originalEvent:n,data:r})}})},o.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},o.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},o.prototype.selectionContainer=function(){return e('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},o.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],o=0;o<e.length;o++){var i=e[o],r=this.selectionContainer(),s=this.display(i,r);r.append(s),r.prop("title",i.title||i.text),r.data("data",i),t.push(r)}var a=this.$selection.find(".select2-selection__rendered");n.appendMany(a,t)}},o}),t.define("select2/selection/placeholder",["../utils"],function(){function e(e,t,n){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n)}return e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.createPlaceholder=function(e,t){var n=this.selectionContainer();return n.html(this.display(t)),n.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),n},e.prototype.update=function(e,t){var n=1==t.length&&t[0].id!=this.placeholder.id;if(t.length>1||n)return e.call(this,t);this.clear();var o=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(o)},e}),t.define("select2/selection/allowClear",["jquery","../keys"],function(e,t){function n(){}return n.prototype.bind=function(e,t,n){var o=this;e.call(this,t,n),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){o._handleClear(e)}),t.on("keypress",function(e){o._handleKeyboardClear(e,t)})},n.prototype._handleClear=function(e,t){if(!this.options.get("disabled")){var n=this.$selection.find(".select2-selection__clear");if(0!==n.length){t.stopPropagation();for(var o=n.data("data"),i=0;i<o.length;i++){var r={data:o[i]};if(this.trigger("unselect",r),r.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},n.prototype._handleKeyboardClear=function(e,n,o){o.isOpen()||n.which!=t.DELETE&&n.which!=t.BACKSPACE||this._handleClear(n)},n.prototype.update=function(t,n){if(t.call(this,n),!(this.$selection.find(".select2-selection__placeholder").length>0||0===n.length)){var o=e('<span class="select2-selection__clear">&times;</span>');o.data("data",n),this.$selection.find(".select2-selection__rendered").prepend(o)}},n}),t.define("select2/selection/search",["jquery","../utils","../keys"],function(e,t,n){function o(e,t,n){e.call(this,t,n)}return o.prototype.render=function(t){var n=e('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=n,this.$search=n.find("input");var o=t.call(this);return this._transferTabIndex(),o},o.prototype.bind=function(e,t,o){var i=this;e.call(this,t,o),t.on("open",function(){i.$search.trigger("focus")}),t.on("close",function(){i.$search.val(""),i.$search.removeAttr("aria-activedescendant"),i.$search.trigger("focus")}),t.on("enable",function(){i.$search.prop("disabled",!1),i._transferTabIndex()}),t.on("disable",function(){i.$search.prop("disabled",!0)}),t.on("focus",function(){i.$search.trigger("focus")}),t.on("results:focus",function(e){i.$search.attr("aria-activedescendant",e.id)}),this.$selection.on("focusin",".select2-search--inline",function(e){i.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){i._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){if(e.stopPropagation(),i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented(),e.which===n.BACKSPACE&&""===i.$search.val()){var t=i.$searchContainer.prev(".select2-selection__choice");if(t.length>0){var o=t.data("data");i.searchRemoveChoice(o),e.preventDefault()}}});var r=document.documentMode,s=r&&r<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(){if(s)return void i.$selection.off("input.search input.searchcheck");i.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(s&&"input"===e.type)return void i.$selection.off("input.search input.searchcheck");var t=e.which;t!=n.SHIFT&&t!=n.CTRL&&t!=n.ALT&&t!=n.TAB&&i.handleSearch(e)})},o.prototype._transferTabIndex=function(){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},o.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},o.prototype.update=function(e,t){var n=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),n&&this.$search.focus()},o.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},o.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},o.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";if(""!==this.$search.attr("placeholder"))e=this.$selection.find(".select2-selection__rendered").innerWidth();else{e=.75*(this.$search.val().length+1)+"em"}this.$search.css("width",e)},o}),t.define("select2/selection/eventRelay",["jquery"],function(e){function t(){}return t.prototype.bind=function(t,n,o){var i=this,r=["open","opening","close","closing","select","selecting","unselect","unselecting"],s=["opening","closing","selecting","unselecting"];t.call(this,n,o),n.on("*",function(t,n){if(-1!==e.inArray(t,r)){n=n||{};var o=e.Event("select2:"+t,{params:n});i.$element.trigger(o),-1!==e.inArray(t,s)&&(n.prevented=o.isDefaultPrevented())}})},t}),t.define("select2/translation",["jquery","require"],function(e,t){function n(e){this.dict=e||{}}return n.prototype.all=function(){return this.dict},n.prototype.get=function(e){return this.dict[e]},n.prototype.extend=function(t){this.dict=e.extend({},t.all(),this.dict)},n._cache={},n.loadPath=function(e){if(!(e in n._cache)){var o=t(e);n._cache[e]=o}return new n(n._cache[e])},n}),t.define("select2/diacritics",[],function(){return{"\u24b6":"A","\uff21":"A","\xc0":"A","\xc1":"A","\xc2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\xc3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\xc4":"A","\u01de":"A","\u1ea2":"A","\xc5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\xc6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\xc7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\xc8":"E","\xc9":"E","\xca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\xcb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\xcc":"I","\xcd":"I","\xce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\xcf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\xd1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\xd2":"O","\xd3":"O","\xd4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\xd5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\xd6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\xd8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u1e9e":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\xd9":"U","\xda":"U","\xdb":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\xdc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\xdd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\xe0":"a","\xe1":"a","\xe2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\xe3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\xe4":"a","\u01df":"a","\u1ea3":"a","\xe5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\xe6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\xe7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\xe8":"e","\xe9":"e","\xea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\xeb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\xec":"i","\xed":"i","\xee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\xef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u017f":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\xf1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\xf2":"o","\xf3":"o","\xf4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\xf5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\xf6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\xf8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r",
"\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\xdf":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u1e9b":"s","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\xf9":"u","\xfa":"u","\xfb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\xfc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\xfd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\xff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038a":"\u0399","\u03aa":"\u0399","\u038c":"\u039f","\u038e":"\u03a5","\u03ab":"\u03a5","\u038f":"\u03a9","\u03ac":"\u03b1","\u03ad":"\u03b5","\u03ae":"\u03b7","\u03af":"\u03b9","\u03ca":"\u03b9","\u0390":"\u03b9","\u03cc":"\u03bf","\u03cd":"\u03c5","\u03cb":"\u03c5","\u03b0":"\u03c5","\u03c9":"\u03c9","\u03c2":"\u03c3"}}),t.define("select2/data/base",["../utils"],function(e){function t(){t.__super__.constructor.call(this)}return e.Extend(t,e.Observable),t.prototype.current=function(){throw new Error("The `current` method must be defined in child classes.")},t.prototype.query=function(){throw new Error("The `query` method must be defined in child classes.")},t.prototype.bind=function(){},t.prototype.destroy=function(){},t.prototype.generateResultId=function(t,n){var o=t.id+"-result-";return o+=e.generateChars(4),null!=n.id?o+="-"+n.id.toString():o+="-"+e.generateChars(4),o},t}),t.define("select2/data/select",["./base","../utils","jquery"],function(e,t,n){function o(e,t){this.$element=e,this.options=t,o.__super__.constructor.call(this)}return t.Extend(o,e),o.prototype.current=function(e){var t=[],o=this;this.$element.find(":selected").each(function(){var e=n(this),i=o.item(e);t.push(i)}),e(t)},o.prototype.select=function(e){var t=this;if(e.selected=!0,n(e.element).is("option"))return e.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(o){var i=[];e=[e],e.push.apply(e,o);for(var r=0;r<e.length;r++){var s=e[r].id;-1===n.inArray(s,i)&&i.push(s)}t.$element.val(i),t.$element.trigger("change")});else{var o=e.id;this.$element.val(o),this.$element.trigger("change")}},o.prototype.unselect=function(e){var t=this;if(this.$element.prop("multiple")){if(e.selected=!1,n(e.element).is("option"))return e.element.selected=!1,void this.$element.trigger("change");this.current(function(o){for(var i=[],r=0;r<o.length;r++){var s=o[r].id;s!==e.id&&-1===n.inArray(s,i)&&i.push(s)}t.$element.val(i),t.$element.trigger("change")})}},o.prototype.bind=function(e){var t=this;this.container=e,e.on("select",function(e){t.select(e.data)}),e.on("unselect",function(e){t.unselect(e.data)})},o.prototype.destroy=function(){this.$element.find("*").each(function(){n.removeData(this,"data")})},o.prototype.query=function(e,t){var o=[],i=this;this.$element.children().each(function(){var t=n(this);if(t.is("option")||t.is("optgroup")){var r=i.item(t),s=i.matches(e,r);null!==s&&o.push(s)}}),t({results:o})},o.prototype.addOptions=function(e){t.appendMany(this.$element,e)},o.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup"),t.label=e.text):(t=document.createElement("option"),t.textContent!==undefined?t.textContent=e.text:t.innerText=e.text),e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);var o=n(t),i=this._normalizeItem(e);return i.element=t,n.data(t,"data",i),o},o.prototype.item=function(e){var t={};if(null!=(t=n.data(e[0],"data")))return t;if(e.is("option"))t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){t={text:e.prop("label"),children:[],title:e.prop("title")};for(var o=e.children("option"),i=[],r=0;r<o.length;r++){var s=n(o[r]),a=this.item(s);i.push(a)}t.children=i}return t=this._normalizeItem(t),t.element=e[0],n.data(e[0],"data",t),t},o.prototype._normalizeItem=function(e){n.isPlainObject(e)||(e={id:e,text:e}),e=n.extend({},{text:""},e);var t={selected:!1,disabled:!1};return null!=e.id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),n.extend({},t,e)},o.prototype.matches=function(e,t){return this.options.get("matcher")(e,t)},o}),t.define("select2/data/array",["./select","../utils","jquery"],function(e,t,n){function o(e,t){var n=t.get("data")||[];o.__super__.constructor.call(this,e,t),this.addOptions(this.convertToOptions(n))}return t.Extend(o,e),o.prototype.select=function(e){var t=this.$element.find("option").filter(function(t,n){return n.value==e.id.toString()});0===t.length&&(t=this.option(e),this.addOptions(t)),o.__super__.select.call(this,e)},o.prototype.convertToOptions=function(e){function o(e){return function(){return n(this).val()==e.id}}for(var i=this,r=this.$element.find("option"),s=r.map(function(){return i.item(n(this)).id}).get(),a=[],l=0;l<e.length;l++){var c=this._normalizeItem(e[l]);if(n.inArray(c.id,s)>=0){var u=r.filter(o(c)),d=this.item(u),h=n.extend(!0,{},c,d),p=this.option(h);u.replaceWith(p)}else{var f=this.option(c);if(c.children){var m=this.convertToOptions(c.children);t.appendMany(f,m)}a.push(f)}}return a},o}),t.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,n){function o(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),o.__super__.constructor.call(this,e,t)}return t.Extend(o,e),o.prototype._applyDefaults=function(e){var t={data:function(e){return n.extend({},e,{q:e.term})},transport:function(e,t,o){var i=n.ajax(e);return i.then(t),i.fail(o),i}};return n.extend({},t,e,!0)},o.prototype.processResults=function(e){return e},o.prototype.query=function(e,t){function o(){var o=r.transport(r,function(o){var r=i.processResults(o,e);i.options.get("debug")&&window.console&&console.error&&(r&&r.results&&n.isArray(r.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),t(r)},function(){o.status&&"0"===o.status||i.trigger("results:message",{message:"errorLoading"})});i._request=o}var i=this;null!=this._request&&(n.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var r=n.extend({type:"GET"},this.ajaxOptions);"function"==typeof r.url&&(r.url=r.url.call(this.$element,e)),"function"==typeof r.data&&(r.data=r.data.call(this.$element,e)),this.ajaxOptions.delay&&null!=e.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(o,this.ajaxOptions.delay)):o()},o}),t.define("select2/data/tags",["jquery"],function(e){function t(t,n,o){var i=o.get("tags"),r=o.get("createTag");r!==undefined&&(this.createTag=r);var s=o.get("insertTag");if(s!==undefined&&(this.insertTag=s),t.call(this,n,o),e.isArray(i))for(var a=0;a<i.length;a++){var l=i[a],c=this._normalizeItem(l),u=this.option(c);this.$element.append(u)}}return t.prototype.query=function(e,t,n){function o(e,r){for(var s=e.results,a=0;a<s.length;a++){var l=s[a],c=null!=l.children&&!o({results:l.children},!0);if(l.text===t.term||c)return!r&&(e.data=s,void n(e))}if(r)return!0;var u=i.createTag(t);if(null!=u){var d=i.option(u);d.attr("data-select2-tag",!0),i.addOptions([d]),i.insertTag(s,u)}e.results=s,n(e)}var i=this;if(this._removeOldTags(),null==t.term||null!=t.page)return void e.call(this,t,n);e.call(this,t,o)},t.prototype.createTag=function(t,n){var o=e.trim(n.term);return""===o?null:{id:o,text:o}},t.prototype.insertTag=function(e,t,n){t.unshift(n)},t.prototype._removeOldTags=function(){this._lastTag;this.$element.find("option[data-select2-tag]").each(function(){this.selected||e(this).remove()})},t}),t.define("select2/data/tokenizer",["jquery"],function(e){function t(e,t,n){var o=n.get("tokenizer");o!==undefined&&(this.tokenizer=o),e.call(this,t,n)}return t.prototype.bind=function(e,t,n){e.call(this,t,n),this.$search=t.dropdown.$search||t.selection.$search||n.find(".select2-search__field")},t.prototype.query=function(t,n,o){function i(t){var n=s._normalizeItem(t);if(!s.$element.find("option").filter(function(){return e(this).val()===n.id}).length){var o=s.option(n);o.attr("data-select2-tag",!0),s._removeOldTags(),s.addOptions([o])}r(n)}function r(e){s.trigger("select",{data:e})}var s=this;n.term=n.term||"";var a=this.tokenizer(n,this.options,i);a.term!==n.term&&(this.$search.length&&(this.$search.val(a.term),this.$search.focus()),n.term=a.term),t.call(this,n,o)},t.prototype.tokenizer=function(t,n,o,i){for(var r=o.get("tokenSeparators")||[],s=n.term,a=0,l=this.createTag||function(e){return{id:e.term,text:e.term}};a<s.length;){var c=s[a];if(-1!==e.inArray(c,r)){var u=s.substr(0,a),d=e.extend({},n,{term:u}),h=l(d);null!=h?(i(h),s=s.substr(a+1)||"",a=0):a++}else a++}return{term:s}},t}),t.define("select2/data/minimumInputLength",[],function(){function e(e,t,n){this.minimumInputLength=n.get("minimumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){if(t.term=t.term||"",t.term.length<this.minimumInputLength)return void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}});e.call(this,t,n)},e}),t.define("select2/data/maximumInputLength",[],function(){function e(e,t,n){this.maximumInputLength=n.get("maximumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){if(t.term=t.term||"",this.maximumInputLength>0&&t.term.length>this.maximumInputLength)return void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}});e.call(this,t,n)},e}),t.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,n){this.maximumSelectionLength=n.get("maximumSelectionLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){var o=this;this.current(function(i){var r=null!=i?i.length:0;if(o.maximumSelectionLength>0&&r>=o.maximumSelectionLength)return void o.trigger("results:message",{message:"maximumSelected",args:{maximum:o.maximumSelectionLength}});e.call(o,t,n)})},e}),t.define("select2/dropdown",["jquery","./utils"],function(e,t){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,t.Observable),n.prototype.render=function(){var t=e('<span class="select2-dropdown"><span class="select2-results"></span></span>');return t.attr("dir",this.options.get("dir")),this.$dropdown=t,t},n.prototype.bind=function(){},n.prototype.position=function(){},n.prototype.destroy=function(){this.$dropdown.remove()},n}),t.define("select2/dropdown/search",["jquery","../utils"],function(e){function t(){}return t.prototype.render=function(t){var n=t.call(this),o=e('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=o,this.$search=o.find("input"),n.prepend(o),n},t.prototype.bind=function(t,n,o){var i=this;t.call(this,n,o),this.$search.on("keydown",function(e){i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(){e(this).off("keyup")}),this.$search.on("keyup input",function(e){i.handleSearch(e)}),n.on("open",function(){i.$search.attr("tabindex",0),i.$search.focus(),window.setTimeout(function(){i.$search.focus()},0)}),n.on("close",function(){i.$search.attr("tabindex",-1),i.$search.val("")}),n.on("focus",function(){n.isOpen()&&i.$search.focus()}),n.on("results:all",function(e){if(null==e.query.term||""===e.query.term){i.showSearch(e)?i.$searchContainer.removeClass("select2-search--hide"):i.$searchContainer.addClass("select2-search--hide")}})},t.prototype.handleSearch=function(){if(!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},t.prototype.showSearch=function(){return!0},t}),t.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,n,o){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n,o)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var n=t.slice(0),o=t.length-1;o>=0;o--){var i=t[o];this.placeholder.id===i.id&&n.splice(o,1)}return n},e}),t.define("select2/dropdown/infiniteScroll",["jquery"],function(e){function t(e,t,n,o){this.lastParams={},e.call(this,t,n,o),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return t.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&this.$results.append(this.$loadingMore)},t.prototype.bind=function(t,n,o){var i=this;t.call(this,n,o),n.on("query",function(e){i.lastParams=e,i.loading=!0}),n.on("query:append",function(e){i.lastParams=e,i.loading=!0}),this.$results.on("scroll",function(){var t=e.contains(document.documentElement,i.$loadingMore[0]);if(!i.loading&&t){i.$results.offset().top+i.$results.outerHeight(!1)+50>=i.$loadingMore.offset().top+i.$loadingMore.outerHeight(!1)&&i.loadMore()}})},t.prototype.loadMore=function(){this.loading=!0;var t=e.extend({},{page:1},this.lastParams);t.page++,this.trigger("query:append",t)},t.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},t.prototype.createLoadingMore=function(){var t=e('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),n=this.options.get("translations").get("loadingMore");return t.html(n(this.lastParams)),t},t}),t.define("select2/dropdown/attachBody",["jquery","../utils"],function(e,t){function n(t,n,o){this.$dropdownParent=o.get("dropdownParent")||e(document.body),t.call(this,n,o)}return n.prototype.bind=function(e,t,n){var o=this,i=!1;e.call(this,t,n),t.on("open",function(){o._showDropdown(),o._attachPositioningHandler(t),i||(i=!0,t.on("results:all",function(){o._positionDropdown(),o._resizeDropdown()}),t.on("results:append",function(){o._positionDropdown(),o._resizeDropdown()}))}),t.on("close",function(){o._hideDropdown(),o._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},n.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},n.prototype.position=function(e,t,n){t.attr("class",n.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=n},n.prototype.render=function(t){var n=e("<span></span>"),o=t.call(this);return n.append(o),this.$dropdownContainer=n,n},n.prototype._hideDropdown=function(){this.$dropdownContainer.detach()},n.prototype._attachPositioningHandler=function(n,o){var i=this,r="scroll.select2."+o.id,s="resize.select2."+o.id,a="orientationchange.select2."+o.id,l=this.$container.parents().filter(t.hasScroll);l.each(function(){e(this).data("select2-scroll-position",{x:e(this).scrollLeft(),y:e(this).scrollTop()})}),l.on(r,function(){var t=e(this).data("select2-scroll-position");e(this).scrollTop(t.y)}),e(window).on(r+" "+s+" "+a,function(){i._positionDropdown(),i._resizeDropdown()})},n.prototype._detachPositioningHandler=function(n,o){var i="scroll.select2."+o.id,r="resize.select2."+o.id,s="orientationchange.select2."+o.id;this.$container.parents().filter(t.hasScroll).off(i),e(window).off(i+" "+r+" "+s)},n.prototype._positionDropdown=function(){var t=e(window),n=this.$dropdown.hasClass("select2-dropdown--above"),o=this.$dropdown.hasClass("select2-dropdown--below"),i=null,r=this.$container.offset();r.bottom=r.top+this.$container.outerHeight(!1);var s={height:this.$container.outerHeight(!1)};s.top=r.top,s.bottom=r.top+s.height;var a={height:this.$dropdown.outerHeight(!1)},l={top:t.scrollTop(),bottom:t.scrollTop()+t.height()},c=l.top<r.top-a.height,u=l.bottom>r.bottom+a.height,d={left:r.left,top:s.bottom},h=this.$dropdownParent;"static"===h.css("position")&&(h=h.offsetParent());var p=h.offset();d.top-=p.top,d.left-=p.left,n||o||(i="below"),u||!c||n?!c&&u&&n&&(i="below"):i="above",("above"==i||n&&"below"!==i)&&(d.top=s.top-p.top-a.height),null!=i&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+i),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+i)),this.$dropdownContainer.css(d)},n.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},n.prototype._showDropdown=function(){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},n}),t.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(t){for(var n=0,o=0;o<t.length;o++){var i=t[o];i.children?n+=e(i.children):n++}return n}function t(e,t,n,o){this.minimumResultsForSearch=n.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=Infinity),e.call(this,t,n,o)}return t.prototype.showSearch=function(t,n){return!(e(n.data.results)<this.minimumResultsForSearch)&&t.call(this,n)},t}),t.define("select2/dropdown/selectOnClose",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var o=this;e.call(this,t,n),t.on("close",function(e){o._handleSelectOnClose(e)})},e.prototype._handleSelectOnClose=function(e,t){if(t&&null!=t.originalSelect2Event){var n=t.originalSelect2Event;if("select"===n._type||"unselect"===n._type)return}var o=this.getHighlightedResults();if(!(o.length<1)){var i=o.data("data");null!=i.element&&i.element.selected||null==i.element&&i.selected||this.trigger("select",{data:i})}},e}),t.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var o=this;e.call(this,t,n),t.on("select",function(e){o._selectTriggered(e)}),t.on("unselect",function(e){o._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var n=t.originalEvent;n&&n.ctrlKey||this.trigger("close",{originalEvent:n,originalSelect2Event:t})},e}),t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,n="Please delete "+t+" character";return 1!=t&&(n+="s"),n},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results\u2026"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching\u2026"}}}),t.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(e,t,n,o,i,r,s,a,l,c,u,d,h,p,f,m,g,v,y,b,w,C,k,_,S,x,$,T,E){function A(){this.reset()}return A.prototype.apply=function(d){if(d=e.extend(!0,{},this.defaults,d),null==d.dataAdapter){if(null!=d.ajax?d.dataAdapter=f:null!=d.data?d.dataAdapter=p:d.dataAdapter=h,d.minimumInputLength>0&&(d.dataAdapter=c.Decorate(d.dataAdapter,v)),d.maximumInputLength>0&&(d.dataAdapter=c.Decorate(d.dataAdapter,y)),d.maximumSelectionLength>0&&(d.dataAdapter=c.Decorate(d.dataAdapter,b)),d.tags&&(d.dataAdapter=c.Decorate(d.dataAdapter,m)),null==d.tokenSeparators&&null==d.tokenizer||(d.dataAdapter=c.Decorate(d.dataAdapter,g)),null!=d.query){var E=t(d.amdBase+"compat/query");d.dataAdapter=c.Decorate(d.dataAdapter,E)}if(null!=d.initSelection){var A=t(d.amdBase+"compat/initSelection");d.dataAdapter=c.Decorate(d.dataAdapter,A)}}if(null==d.resultsAdapter&&(d.resultsAdapter=n,null!=d.ajax&&(d.resultsAdapter=c.Decorate(d.resultsAdapter,_)),null!=d.placeholder&&(d.resultsAdapter=c.Decorate(d.resultsAdapter,k)),d.selectOnClose&&(d.resultsAdapter=c.Decorate(d.resultsAdapter,$))),null==d.dropdownAdapter){if(d.multiple)d.dropdownAdapter=w;else{var M=c.Decorate(w,C);d.dropdownAdapter=M}if(0!==d.minimumResultsForSearch&&(d.dropdownAdapter=c.Decorate(d.dropdownAdapter,x)),d.closeOnSelect&&(d.dropdownAdapter=c.Decorate(d.dropdownAdapter,T)),null!=d.dropdownCssClass||null!=d.dropdownCss||null!=d.adaptDropdownCssClass){var I=t(d.amdBase+"compat/dropdownCss");d.dropdownAdapter=c.Decorate(d.dropdownAdapter,I)}d.dropdownAdapter=c.Decorate(d.dropdownAdapter,S)}if(null==d.selectionAdapter){if(d.multiple?d.selectionAdapter=i:d.selectionAdapter=o,null!=d.placeholder&&(d.selectionAdapter=c.Decorate(d.selectionAdapter,r)),d.allowClear&&(d.selectionAdapter=c.Decorate(d.selectionAdapter,s)),d.multiple&&(d.selectionAdapter=c.Decorate(d.selectionAdapter,a)),null!=d.containerCssClass||null!=d.containerCss||null!=d.adaptContainerCssClass){var O=t(d.amdBase+"compat/containerCss");d.selectionAdapter=c.Decorate(d.selectionAdapter,O)}d.selectionAdapter=c.Decorate(d.selectionAdapter,l)}if("string"==typeof d.language)if(d.language.indexOf("-")>0){var R=d.language.split("-"),L=R[0];d.language=[d.language,L]}else d.language=[d.language];if(e.isArray(d.language)){var P=new u;d.language.push("en");for(var D=d.language,N=0;N<D.length;N++){var H=D[N],B={};try{B=u.loadPath(H)}catch(e){try{H=this.defaults.amdLanguageBase+H,B=u.loadPath(H)}catch(e){d.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+H+'" could not be automatically loaded. A fallback will be used instead.');continue}}P.extend(B)}d.translations=P}else{var F=u.loadPath(this.defaults.amdLanguageBase+"en"),j=new u(d.language);j.extend(F),d.translations=j}return d},A.prototype.reset=function(){function t(e){function t(e){return d[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function n(o,i){if(""===e.trim(o.term))return i;if(i.children&&i.children.length>0){for(var r=e.extend(!0,{},i),s=i.children.length-1;s>=0;s--){null==n(o,i.children[s])&&r.children.splice(s,1)}return r.children.length>0?r:n(o,r)}var a=t(i.text).toUpperCase(),l=t(o.term).toUpperCase();return a.indexOf(l)>-1?i:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:c.escapeMarkup,language:E,matcher:n,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},A.prototype.set=function(t,n){var o=e.camelCase(t),i={};i[o]=n;var r=c._convertData(i);e.extend(this.defaults,r)},new A}),t.define("select2/options",["require","jquery","./defaults","./utils"],function(e,t,n,o){function i(t,i){if(this.options=t,null!=i&&this.fromElement(i),this.options=n.apply(this.options),i&&i.is("input")){var r=e(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=o.Decorate(this.options.dataAdapter,r)}}return i.prototype.fromElement=function(e){var n=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.language&&(e.prop("lang")?this.options.language=e.prop("lang").toLowerCase():e.closest("[lang]").prop("lang")&&(this.options.language=e.closest("[lang]").prop("lang"))),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),e.data("data",e.data("select2Tags")),e.data("tags",!0)),e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",e.data("ajaxUrl")),e.data("ajax--url",e.data("ajaxUrl")));var i={};i=t.fn.jquery&&"1."==t.fn.jquery.substr(0,2)&&e[0].dataset?t.extend(!0,{},e[0].dataset,e.data()):e.data();var r=t.extend(!0,{},i);r=o._convertData(r);for(var s in r)t.inArray(s,n)>-1||(t.isPlainObject(this.options[s])?t.extend(this.options[s],r[s]):this.options[s]=r[s]);return this},i.prototype.get=function(e){return this.options[e]},i.prototype.set=function(e,t){this.options[e]=t},i}),t.define("select2/core",["jquery","./options","./utils","./keys"],function(e,t,n,o){var i=function(e,n){null!=e.data("select2")&&e.data("select2").destroy(),this.$element=e,this.id=this._generateId(e),n=n||{},this.options=new t(n,e),i.__super__.constructor.call(this);var o=e.attr("tabindex")||0;e.data("old-tabindex",o),e.attr("tabindex","-1");var r=this.options.get("dataAdapter");this.dataAdapter=new r(e,this.options);var s=this.render();this._placeContainer(s);var a=this.options.get("selectionAdapter");this.selection=new a(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,s);var l=this.options.get("dropdownAdapter");this.dropdown=new l(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,s);var c=this.options.get("resultsAdapter");this.results=new c(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var u=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){u.trigger("selection:update",{data:e})}),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),e.data("select2",this)};return n.Extend(i,n.Observable),i.prototype._generateId=function(e){var t="";return t=null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+n.generateChars(2):n.generateChars(4),t=t.replace(/(:|\.|\[|\]|,)/g,""),t="select2-"+t},i.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},i.prototype._resolveWidth=function(e,t){var n=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var o=this._resolveWidth(e,"style");return null!=o?o:this._resolveWidth(e,"element")}if("element"==t){var i=e.outerWidth(!1);return i<=0?"auto":i+"px"}if("style"==t){var r=e.attr("style");if("string"!=typeof r)return null;for(var s=r.split(";"),a=0,l=s.length;a<l;a+=1){var c=s[a].replace(/\s/g,""),u=c.match(n);if(null!==u&&u.length>=1)return u[1]}return null}return t},i.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},i.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this.$element.on("focus.select2",function(e){t.trigger("focus",e)}),this._syncA=n.bind(this._syncAttributes,this),this._syncS=n.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var o=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=o?(this._observer=new o(function(n){e.each(n,t._syncA),e.each(n,t._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",t._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",t._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",t._syncS,!1))},i.prototype._registerDataEvents=function(){var e=this;this.dataAdapter.on("*",function(t,n){e.trigger(t,n)})},i.prototype._registerSelectionEvents=function(){var t=this,n=["toggle","focus"];this.selection.on("toggle",function(){t.toggleDropdown()}),this.selection.on("focus",function(e){t.focus(e)}),this.selection.on("*",function(o,i){-1===e.inArray(o,n)&&t.trigger(o,i)})},i.prototype._registerDropdownEvents=function(){var e=this;this.dropdown.on("*",function(t,n){e.trigger(t,n)})},i.prototype._registerResultsEvents=function(){var e=this;this.results.on("*",function(t,n){e.trigger(t,n)})},i.prototype._registerEvents=function(){var e=this;this.on("open",function(){e.$container.addClass("select2-container--open")}),this.on("close",function(){e.$container.removeClass("select2-container--open")}),this.on("enable",function(){e.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){e.$container.addClass("select2-container--disabled")}),this.on("blur",function(){e.$container.removeClass("select2-container--focus")}),this.on("query",function(t){e.isOpen()||e.trigger("open",{}),this.dataAdapter.query(t,function(n){e.trigger("results:all",{data:n,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(n){e.trigger("results:append",{data:n,query:t})})}),this.on("keypress",function(t){var n=t.which;e.isOpen()?n===o.ESC||n===o.TAB||n===o.UP&&t.altKey?(e.close(),t.preventDefault()):n===o.ENTER?(e.trigger("results:select",{}),t.preventDefault()):n===o.SPACE&&t.ctrlKey?(e.trigger("results:toggle",{}),t.preventDefault()):n===o.UP?(e.trigger("results:previous",{}),t.preventDefault()):n===o.DOWN&&(e.trigger("results:next",{}),t.preventDefault()):(n===o.ENTER||n===o.SPACE||n===o.DOWN&&t.altKey)&&(e.open(),t.preventDefault())})},i.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},i.prototype._syncSubtree=function(e,t){var n=!1,o=this;if(!e||!e.target||"OPTION"===e.target.nodeName||"OPTGROUP"===e.target.nodeName){if(t)if(t.addedNodes&&t.addedNodes.length>0)for(var i=0;i<t.addedNodes.length;i++){var r=t.addedNodes[i];r.selected&&(n=!0)}else t.removedNodes&&t.removedNodes.length>0&&(n=!0);else n=!0;n&&this.dataAdapter.current(function(e){o.trigger("selection:update",{data:e})})}},i.prototype.trigger=function(e,t){var n=i.__super__.trigger,o={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(t===undefined&&(t={}),e in o){var r=o[e],s={prevented:!1,name:e,args:t};if(n.call(this,r,s),s.prevented)return void(t.prevented=!0)}n.call(this,e,t)},i.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},i.prototype.open=function(){this.isOpen()||this.trigger("query",{})},i.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},i.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},i.prototype.hasFocus=function(){
return this.$container.hasClass("select2-container--focus")},i.prototype.focus=function(){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},i.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=e&&0!==e.length||(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},i.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var e=[];return this.dataAdapter.current(function(t){e=t}),e},i.prototype.val=function(t){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==t||0===t.length)return this.$element.val();var n=t[0];e.isArray(n)&&(n=e.map(n,function(e){return e.toString()})),this.$element.val(n).trigger("change")},i.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},i.prototype.render=function(){var t=e('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return t.attr("dir",this.options.get("dir")),this.$container=t,this.$container.addClass("select2-container--"+this.options.get("theme")),t.data("element",this.$element),t},i}),t.define("select2/compat/utils",["jquery"],function(e){function t(t,n,o){var i,r,s=[];i=e.trim(t.attr("class")),i&&(i=""+i,e(i.split(/\s+/)).each(function(){0===this.indexOf("select2-")&&s.push(this)})),i=e.trim(n.attr("class")),i&&(i=""+i,e(i.split(/\s+/)).each(function(){0!==this.indexOf("select2-")&&null!=(r=o(this))&&s.push(r)})),t.attr("class",s.join(" "))}return{syncCssClasses:t}}),t.define("select2/compat/containerCss",["jquery","./utils"],function(e,t){function n(){return null}function o(){}return o.prototype.render=function(o){var i=o.call(this),r=this.options.get("containerCssClass")||"";e.isFunction(r)&&(r=r(this.$element));var s=this.options.get("adaptContainerCssClass");if(s=s||n,-1!==r.indexOf(":all:")){r=r.replace(":all:","");var a=s;s=function(e){var t=a(e);return null!=t?t+" "+e:e}}var l=this.options.get("containerCss")||{};return e.isFunction(l)&&(l=l(this.$element)),t.syncCssClasses(i,this.$element,s),i.css(l),i.addClass(r),i},o}),t.define("select2/compat/dropdownCss",["jquery","./utils"],function(e,t){function n(){return null}function o(){}return o.prototype.render=function(o){var i=o.call(this),r=this.options.get("dropdownCssClass")||"";e.isFunction(r)&&(r=r(this.$element));var s=this.options.get("adaptDropdownCssClass");if(s=s||n,-1!==r.indexOf(":all:")){r=r.replace(":all:","");var a=s;s=function(e){var t=a(e);return null!=t?t+" "+e:e}}var l=this.options.get("dropdownCss")||{};return e.isFunction(l)&&(l=l(this.$element)),t.syncCssClasses(i,this.$element,s),i.css(l),i.addClass(r),i},o}),t.define("select2/compat/initSelection",["jquery"],function(e){function t(e,t,n){n.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2"),this.initSelection=n.get("initSelection"),this._isInitialized=!1,e.call(this,t,n)}return t.prototype.current=function(t,n){var o=this;if(this._isInitialized)return void t.call(this,n);this.initSelection.call(null,this.$element,function(t){o._isInitialized=!0,e.isArray(t)||(t=[t]),n(t)})},t}),t.define("select2/compat/inputData",["jquery"],function(e){function t(e,t,n){this._currentData=[],this._valueSeparator=n.get("valueSeparator")||",","hidden"===t.prop("type")&&n.get("debug")&&console&&console.warn&&console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead."),e.call(this,t,n)}return t.prototype.current=function(t,n){function o(t,n){var i=[];return t.selected||-1!==e.inArray(t.id,n)?(t.selected=!0,i.push(t)):t.selected=!1,t.children&&i.push.apply(i,o(t.children,n)),i}for(var i=[],r=0;r<this._currentData.length;r++){var s=this._currentData[r];i.push.apply(i,o(s,this.$element.val().split(this._valueSeparator)))}n(i)},t.prototype.select=function(t,n){if(this.options.get("multiple")){var o=this.$element.val();o+=this._valueSeparator+n.id,this.$element.val(o),this.$element.trigger("change")}else this.current(function(t){e.map(t,function(e){e.selected=!1})}),this.$element.val(n.id),this.$element.trigger("change")},t.prototype.unselect=function(e,t){var n=this;t.selected=!1,this.current(function(e){for(var o=[],i=0;i<e.length;i++){var r=e[i];t.id!=r.id&&o.push(r.id)}n.$element.val(o.join(n._valueSeparator)),n.$element.trigger("change")})},t.prototype.query=function(e,t,n){for(var o=[],i=0;i<this._currentData.length;i++){var r=this._currentData[i],s=this.matches(t,r);null!==s&&o.push(s)}n({results:o})},t.prototype.addOptions=function(t,n){var o=e.map(n,function(t){return e.data(t[0],"data")});this._currentData.push.apply(this._currentData,o)},t}),t.define("select2/compat/matcher",["jquery"],function(e){function t(t){function n(n,o){var i=e.extend(!0,{},o);if(null==n.term||""===e.trim(n.term))return i;if(o.children){for(var r=o.children.length-1;r>=0;r--){var s=o.children[r];t(n.term,s.text,s)||i.children.splice(r,1)}if(i.children.length>0)return i}return t(n.term,o.text,o)?i:null}return n}return t}),t.define("select2/compat/query",[],function(){function e(e,t,n){n.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2."),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.callback=n,this.options.get("query").call(null,t)},e}),t.define("select2/dropdown/attachContainer",[],function(){function e(e,t,n){e.call(this,t,n)}return e.prototype.position=function(e,t,n){n.find(".dropdown-wrapper").append(t),t.addClass("select2-dropdown--below"),n.addClass("select2-container--below")},e}),t.define("select2/dropdown/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n);var o=["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"];this.$dropdown.on(o.join(" "),function(e){e.stopPropagation()})},e}),t.define("select2/selection/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n);var o=["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"];this.$selection.on(o.join(" "),function(e){e.stopPropagation()})},e}),function(n){"function"==typeof t.define&&t.define.amd?t.define("jquery-mousewheel",["jquery"],n):"object"==typeof exports?module.exports=n:n(e)}(function(e){function t(t){var s=t||window.event,a=l.call(arguments,1),c=0,d=0,h=0,p=0,f=0,m=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(h=-1*s.detail),"wheelDelta"in s&&(h=s.wheelDelta),"wheelDeltaY"in s&&(h=s.wheelDeltaY),"wheelDeltaX"in s&&(d=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(d=-1*h,h=0),c=0===h?d:h,"deltaY"in s&&(h=-1*s.deltaY,c=h),"deltaX"in s&&(d=s.deltaX,0===h&&(c=-1*d)),0!==h||0!==d){if(1===s.deltaMode){var g=e.data(this,"mousewheel-line-height");c*=g,h*=g,d*=g}else if(2===s.deltaMode){var v=e.data(this,"mousewheel-page-height");c*=v,h*=v,d*=v}if(p=Math.max(Math.abs(h),Math.abs(d)),(!r||p<r)&&(r=p,o(s,p)&&(r/=40)),o(s,p)&&(c/=40,d/=40,h/=40),c=Math[c>=1?"floor":"ceil"](c/r),d=Math[d>=1?"floor":"ceil"](d/r),h=Math[h>=1?"floor":"ceil"](h/r),u.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();f=t.clientX-y.left,m=t.clientY-y.top}return t.deltaX=d,t.deltaY=h,t.deltaFactor=r,t.offsetX=f,t.offsetY=m,t.deltaMode=0,a.unshift(t,c,d,h),i&&clearTimeout(i),i=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function n(){r=null}function o(e,t){return u.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var i,r,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var c=s.length;c;)e.event.fixHooks[s[--c]]=e.event.mouseHooks;var u=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=a.length;n;)this.addEventListener(a[--n],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",u.getLineHeight(this)),e.data(this,"mousewheel-page-height",u.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=a.length;n;)this.removeEventListener(a[--n],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),o=n["offsetParent"in e.fn?"offsetParent":"parent"]();return o.length||(o=e("body")),parseInt(o.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(e,t,n,o){if(null==e.fn.select2){var i=["open","close","destroy"];e.fn.select2=function(t){if("object"==typeof(t=t||{}))return this.each(function(){var o=e.extend(!0,{},t);new n(e(this),o)}),this;if("string"==typeof t){var o,r=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=e(this).data("select2");null==n&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2."),o=n[t].apply(n,r)}),e.inArray(t,i)>-1?this:o}throw new Error("Invalid arguments for Select2: "+t)}}return null==e.fn.select2.defaults&&(e.fn.select2.defaults=o),n}),{define:t.define,require:t.require}}(),n=t.require("jquery.select2");return e.fn.select2.amd=t,n});var sanitize_user_input=function(e){return $.trim(e).replace(/<.*>/,"").replace(/<.*/,"").replace(/.*>/,"").replace(/&.*;/,"")},sanitize_list=function(e){if(0===e.length)return[];var t=Object.keys(e[0]);return e.map(function(e){return t.forEach(function(t){e[t]=sanitize_user_input(e[t])}),e})},defaultTemplateSelection=function(e){return e.loading?e.text:"<div class='select2-result-repository clearfix'><div class='select2-result-repository__meta'><div class='select2-result-repository__title'>"+sanitize_user_input(e.text)+"</div></div>"},defaultTemplateResult=function(e){return e.text},ib_select2=function(e,t,n,o){o===undefined&&(o={});var i=o.minInputLength===undefined?3:o.minInputLength,r=o.forceEntry===undefined||o.forceEntry,s=o.createTags===undefined?!r:o.createTags,a=o.templateResult===undefined?defaultTemplateResult:o.templateResult,l=o.templateSelection===undefined?defaultTemplateSelection:o.templateSelection;return e.select2({width:"100%",placeholder:n,ajax:{url:t,dataType:"json",delay:250,data:function(e){return{q:sanitize_user_input(e.term),page:e.page}},processResults:function(e,t){var n;if(r&&e.items.length<5){var o=sanitize_user_input(t.term);return n=-1===e.items.map(function(e){return e.text}).indexOf(o)?e.items.concat([{text:o,id:o}]):e.items,{results:sanitize_list(n)}}return n=e.items,t.page=t.page||1,{results:sanitize_list(n),pagination:{more:30*t.page<e.total_count}}},cache:!0},tags:s,createTag:function(e){return{text:sanitize_user_input(e.term),id:sanitize_user_input(e.term),newOption:!0}},escapeMarkup:function(e){return e},minimumInputLength:i,templateResult:a,templateSelection:l,dropdownParent:o.parent}),e};/*!
 * ngTagsInput v3.2.0
 * http://mbenford.github.io/ngTagsInput
 *
 * Copyright (c) 2013-2017 Michael Benford
 * License: MIT
 *
 * Generated at 2017-04-15 17:08:51 -0300
 */
!function(){"use strict";var e={backspace:8,tab:9,enter:13,escape:27,space:32,up:38,down:40,left:37,right:39,"delete":46,comma:188},t=9007199254740991,n=["text","email","url"],o=angular.module("ngTagsInput",[]);o.directive("tagsInput",["$timeout","$document","$window","$q","tagsInputConfig","tiUtil",function(o,i,r,s,a,l){function c(e,t,n,o){var i,r,a,c,u={};return i=function(t){return l.safeToString(t[e.displayProperty])},r=function(t,n){t[e.displayProperty]=n},a=function(t){var o=i(t),r=o&&o.length>=e.minLength&&o.length<=e.maxLength&&e.allowedTagsPattern.test(o)&&!l.findInObjectArray(u.items,t,e.keyProperty||e.displayProperty);return s.when(r&&n({$tag:t})).then(l.promisifyValue)},c=function(e){return s.when(o({$tag:e})).then(l.promisifyValue)},u.items=[],u.addText=function(e){var t={};return r(t,e),u.add(t)},u.add=function(n){var o=i(n);return e.replaceSpacesWithDashes&&(o=l.replaceSpacesWithDashes(o)),r(n,o),a(n).then(function(){u.items.push(n),t.trigger("tag-added",{$tag:n})})["catch"](function(){o&&t.trigger("invalid-tag",{$tag:n})})},u.remove=function(e){var n=u.items[e];return c(n).then(function(){return u.items.splice(e,1),u.clearSelection(),t.trigger("tag-removed",{$tag:n}),n})},u.select=function(e){e<0?e=u.items.length-1:e>=u.items.length&&(e=0),u.index=e,u.selected=u.items[e]},u.selectPrior=function(){u.select(--u.index)},u.selectNext=function(){u.select(++u.index)},u.removeSelected=function(){return u.remove(u.index)},u.clearSelection=function(){u.selected=null,u.index=-1},u.getItems=function(){return e.useStrings?u.items.map(i):u.items},u.clearSelection(),u}function u(e){return-1!==n.indexOf(e)}return{restrict:"E",require:"ngModel",scope:{tags:"=ngModel",text:"=?",templateScope:"=?",tagClass:"&",onTagAdding:"&",onTagAdded:"&",onInvalidTag:"&",onTagRemoving:"&",onTagRemoved:"&",onTagClicked:"&"},replace:!1,transclude:!0,templateUrl:"ngTagsInput/tags-input.html",controller:["$scope","$attrs","$element",function(e,n,o){e.events=l.simplePubSub(),a.load("tagsInput",e,n,{template:[String,"ngTagsInput/tag-item.html"],type:[String,"text",u],placeholder:[String,"Add a tag"],tabindex:[Number,null],removeTagSymbol:[String,String.fromCharCode(215)],replaceSpacesWithDashes:[Boolean,!0],minLength:[Number,3],maxLength:[Number,t],addOnEnter:[Boolean,!0],addOnSpace:[Boolean,!1],addOnComma:[Boolean,!0],addOnBlur:[Boolean,!0],addOnPaste:[Boolean,!1],pasteSplitPattern:[RegExp,/,/],allowedTagsPattern:[RegExp,/.+/],enableEditingLastTag:[Boolean,!1],minTags:[Number,0],maxTags:[Number,t],displayProperty:[String,"text"],keyProperty:[String,""],allowLeftoverText:[Boolean,!1],addFromAutocompleteOnly:[Boolean,!1],spellcheck:[Boolean,!0],useStrings:[Boolean,!1]}),e.tagList=new c(e.options,e.events,l.handleUndefinedResult(e.onTagAdding,!0),l.handleUndefinedResult(e.onTagRemoving,!0)),this.registerAutocomplete=function(){o.find("input");return{addTag:function(t){return e.tagList.add(t)},getTags:function(){return e.tagList.items},getCurrentTagText:function(){return e.newTag.text()},getOptions:function(){return e.options},getTemplateScope:function(){return e.templateScope},on:function(t,n){return e.events.on(t,n,!0),this}}},this.registerTagItem=function(){return{getOptions:function(){return e.options},removeTag:function(t){e.disabled||e.tagList.remove(t)}}}}],link:function(t,n,s,a){var c,u,d=[e.enter,e.comma,e.space,e.backspace,e["delete"],e.left,e.right],h=t.tagList,p=t.events,f=t.options,m=n.find("input"),g=["minTags","maxTags","allowLeftoverText"];c=function(){a.$setValidity("maxTags",h.items.length<=f.maxTags),a.$setValidity("minTags",h.items.length>=f.minTags),a.$setValidity("leftoverText",!(!t.hasFocus&&!f.allowLeftoverText)||!t.newTag.text())},u=function(){o(function(){m[0].focus()})},a.$isEmpty=function(e){return!e||!e.length},t.newTag={text:function(e){if(!angular.isDefined(e))return t.text||"";t.text=e,p.trigger("input-change",e)},invalid:null},t.track=function(e){return e[f.keyProperty||f.displayProperty]},t.getTagClass=function(e,n){var o=e===h.selected;return[t.tagClass({$tag:e,$index:n,$selected:o}),{selected:o}]},t.$watch("tags",function(e){if(e){if(h.items=l.makeObjectArray(e,f.displayProperty),f.useStrings)return;t.tags=h.items}else h.items=[]}),t.$watch("tags.length",function(){c(),a.$validate()}),s.$observe("disabled",function(e){t.disabled=e}),t.eventHandlers={input:{keydown:function(e){p.trigger("input-keydown",e)},focus:function(){t.hasFocus||(t.hasFocus=!0,p.trigger("input-focus"))},blur:function(){o(function(){var e=i.prop("activeElement"),o=e===m[0],r=n[0].contains(e);!o&&r||(t.hasFocus=!1,p.trigger("input-blur"))})},paste:function(e){e.getTextData=function(){var t=e.clipboardData||e.originalEvent&&e.originalEvent.clipboardData;return t?t.getData("text/plain"):r.clipboardData.getData("Text")},p.trigger("input-paste",e)}},host:{click:function(){t.disabled||u()}},tag:{click:function(e){p.trigger("tag-clicked",{$tag:e})}}},p.on("tag-added",t.onTagAdded).on("invalid-tag",t.onInvalidTag).on("tag-removed",t.onTagRemoved).on("tag-clicked",t.onTagClicked).on("tag-added",function(){t.newTag.text("")}).on("tag-added tag-removed",function(){t.tags=h.getItems(),a.$setDirty(),u()}).on("invalid-tag",function(){t.newTag.invalid=!0}).on("option-change",function(e){-1!==g.indexOf(e.name)&&c()}).on("input-change",function(){h.clearSelection(),t.newTag.invalid=null}).on("input-focus",function(){n.triggerHandler("focus"),a.$setValidity("leftoverText",!0)}).on("input-blur",function(){f.addOnBlur&&!f.addFromAutocompleteOnly&&h.addText(t.newTag.text()),n.triggerHandler("blur"),c()}).on("input-keydown",function(n){var o,i,r,s,a=n.keyCode,c={};l.isModifierOn(n)||-1===d.indexOf(a)||(c[e.enter]=f.addOnEnter,c[e.comma]=f.addOnComma,c[e.space]=f.addOnSpace,o=!f.addFromAutocompleteOnly&&c[a],i=(a===e.backspace||a===e["delete"])&&h.selected,s=a===e.backspace&&0===t.newTag.text().length&&f.enableEditingLastTag,r=(a===e.backspace||a===e.left||a===e.right)&&0===t.newTag.text().length&&!f.enableEditingLastTag,o?h.addText(t.newTag.text()):s?(h.selectPrior(),h.removeSelected().then(function(e){e&&t.newTag.text(e[f.displayProperty])})):i?h.removeSelected():r&&(a===e.left||a===e.backspace?h.selectPrior():a===e.right&&h.selectNext()),(o||r||i||s)&&n.preventDefault())}).on("input-paste",function(e){if(f.addOnPaste){var t=e.getTextData(),n=t.split(f.pasteSplitPattern);n.length>1&&(n.forEach(function(e){h.addText(e)}),e.preventDefault())}})}}}]),o.directive("tiTagItem",["tiUtil",function(e){return{restrict:"E",require:"^tagsInput",template:'<ng-include src="$$template"></ng-include>',scope:{$scope:"=scope",data:"="},link:function(t,n,o,i){var r=i.registerTagItem(),s=r.getOptions();t.$$template=s.template,t.$$removeTagSymbol=s.removeTagSymbol,t.$getDisplayText=function(){return e.safeToString(t.data[s.displayProperty])},t.$removeTag=function(){r.removeTag(t.$index)},t.$watch("$parent.$index",function(e){t.$index=e})}}}]),o.directive("autoComplete",["$document","$timeout","$sce","$q","tagsInputConfig","tiUtil",function(t,n,o,i,r,s){function a(e,t,n){var o,r,a,l={};return a=function(){return t.tagsInput.keyProperty||t.tagsInput.displayProperty},o=function(e,n){return e.filter(function(e){return!s.findInObjectArray(n,e,a(),function(e,n){return t.tagsInput.replaceSpacesWithDashes&&(e=s.replaceSpacesWithDashes(e),n=s.replaceSpacesWithDashes(n)),s.defaultComparer(e,n)})})},l.reset=function(){r=null,l.items=[],l.visible=!1,l.index=-1,l.selected=null,l.query=null},l.show=function(){t.selectFirstMatch?l.select(0):l.selected=null,l.visible=!0},l.load=s.debounce(function(n,c){l.query=n;var u=i.when(e({$query:n}));r=u,u.then(function(e){u===r&&(e=s.makeObjectArray(e.data||e,a()),e=o(e,c),l.items=e.slice(0,t.maxResultsToShow),l.items.length>0?l.show():l.reset())})},t.debounceDelay),l.selectNext=function(){l.select(++l.index)},l.selectPrior=function(){l.select(--l.index)},l.select=function(e){e<0?e=l.items.length-1:e>=l.items.length&&(e=0),l.index=e,l.selected=l.items[e],n.trigger("suggestion-selected",e)},l.reset(),l}function l(e,t){var n=e.find("li").eq(t),o=n.parent(),i=n.prop("offsetTop"),r=n.prop("offsetHeight"),s=o.prop("clientHeight"),a=o.prop("scrollTop");i<a?o.prop("scrollTop",i):i+r>s+a&&o.prop("scrollTop",i+r-s)}return{restrict:"E",require:"^tagsInput",scope:{source:"&",matchClass:"&"},templateUrl:"ngTagsInput/auto-complete.html",controller:["$scope","$element","$attrs",function(e,t,n){e.events=s.simplePubSub(),r.load("autoComplete",e,n,{template:[String,"ngTagsInput/auto-complete-match.html"],debounceDelay:[Number,100],minLength:[Number,3],highlightMatchedText:[Boolean,!0],maxResultsToShow:[Number,10],loadOnDownArrow:[Boolean,!1],loadOnEmpty:[Boolean,!1],loadOnFocus:[Boolean,!1],selectFirstMatch:[Boolean,!0],displayProperty:[String,""]}),e.suggestionList=new a(e.source,e.options,e.events),this.registerAutocompleteMatch=function(){return{getOptions:function(){return e.options},getQuery:function(){return e.suggestionList.query}}}}],link:function(t,n,o,i){var r,a=[e.enter,e.tab,e.escape,e.up,e.down],c=t.suggestionList,u=i.registerAutocomplete(),d=t.options,h=t.events;d.tagsInput=u.getOptions(),r=function(e){return e&&e.length>=d.minLength||!e&&d.loadOnEmpty},t.templateScope=u.getTemplateScope(),t.addSuggestionByIndex=function(e){c.select(e),t.addSuggestion()},t.addSuggestion=function(){var e=!1;return c.selected&&(u.addTag(angular.copy(c.selected)),c.reset(),e=!0),e},t.track=function(e){return e[d.tagsInput.keyProperty||d.tagsInput.displayProperty]},t.getSuggestionClass=function(e,n){var o=e===c.selected;return[t.matchClass({$match:e,$index:n,$selected:o}),{selected:o}]},u.on("tag-added tag-removed invalid-tag input-blur",function(){c.reset()}).on("input-change",function(e){r(e)?c.load(e,u.getTags()):c.reset()}).on("input-focus",function(){var e=u.getCurrentTagText();d.loadOnFocus&&r(e)&&c.load(e,u.getTags())}).on("input-keydown",function(n){var o=n.keyCode,i=!1;if(!s.isModifierOn(n)&&-1!==a.indexOf(o))return c.visible?o===e.down?(c.selectNext(),i=!0):o===e.up?(c.selectPrior(),i=!0):o===e.escape?(c.reset(),i=!0):o!==e.enter&&o!==e.tab||(i=t.addSuggestion()):o===e.down&&t.options.loadOnDownArrow&&(c.load(u.getCurrentTagText(),u.getTags()),i=!0),i?(n.preventDefault(),n.stopImmediatePropagation(),!1):void 0}),h.on("suggestion-selected",function(e){l(n,e)})}}}]),o.directive("tiAutocompleteMatch",["$sce","tiUtil",function(e,t){return{restrict:"E",require:"^autoComplete",template:'<ng-include src="$$template"></ng-include>',scope:{$scope:"=scope",data:"="},link:function(n,o,i,r){var s=r.registerAutocompleteMatch(),a=s.getOptions();n.$$template=a.template,n.$index=n.$parent.$index,n.$highlight=function(n){return a.highlightMatchedText&&(n=t.safeHighlight(n,s.getQuery())),e.trustAsHtml(n)},n.$getDisplayText=function(){return t.safeToString(n.data[a.displayProperty||a.tagsInput.displayProperty])}}}}]),o.directive("tiTranscludeAppend",function(){return function(e,t,n,o,i){i(function(e){t.append(e)})}}),o.directive("tiAutosize",["tagsInputConfig",function(e){return{restrict:"A",require:"ngModel",link:function(t,n,o,i){var r,s,a=e.getTextAutosizeThreshold();r=angular.element('<span class="input"></span>'),r.css("display","none").css("visibility","hidden").css("width","auto").css("white-space","pre"),n.parent().append(r),s=function(e){var t,i=e;return angular.isString(i)&&0===i.length&&(i=o.placeholder),i&&(r.text(i),r.css("display",""),t=r.prop("offsetWidth"),r.css("display","none")),n.css("width",t?t+a+"px":""),e},i.$parsers.unshift(s),i.$formatters.unshift(s),o.$observe("placeholder",function(e){i.$modelValue||s(e)})}}}]),o.directive("tiBindAttrs",function(){return function(e,t,n){e.$watch(n.tiBindAttrs,function(e){angular.forEach(e,function(e,t){n.$set(t,e)})},!0)}}),o.provider("tagsInputConfig",function(){var e={},t={},n=3;this.setDefaults=function(t,n){return e[t]=n,this},this.setActiveInterpolation=function(e,n){return t[e]=n,this},this.setTextAutosizeThreshold=function(e){return n=e,this},this.$get=["$interpolate",function(o){var i={};return i[String]=function(e){return e},i[Number]=function(e){return parseInt(e,10)},i[Boolean]=function(e){return"true"===e.toLowerCase()},i[RegExp]=function(e){return new RegExp(e)},{load:function(n,r,s,a){var l=function(){return!0};r.options={},angular.forEach(a,function(a,c){var u,d,h,p,f,m;u=a[0],d=a[1],h=a[2]||l,p=i[u],f=function(){var t=e[n]&&e[n][c];return angular.isDefined(t)?t:d},m=function(e){r.options[c]=e&&h(e)?p(e):f()},t[n]&&t[n][c]?s.$observe(c,function(e){m(e),r.events.trigger("option-change",{name:c,newValue:e})}):m(s[c]&&o(s[c])(r.$parent))})},getTextAutosizeThreshold:function(){return n}}}]}),o.factory("tiUtil",["$timeout","$q",function(e,t){var n={};return n.debounce=function(t,n){var o;return function(){var i=arguments;e.cancel(o),o=e(function(){t.apply(null,i)},n)}},n.makeObjectArray=function(e,t){if(!angular.isArray(e)||0===e.length||angular.isObject(e[0]))return e;var n=[];return e.forEach(function(e){var o={};o[t]=e,n.push(o)}),n},n.findInObjectArray=function(e,t,o,i){var r=null;return i=i||n.defaultComparer,e.some(function(e){if(i(e[o],t[o]))return r=e,!0}),r},n.defaultComparer=function(e,t){return n.safeToString(e).toLowerCase()===n.safeToString(t).toLowerCase()},n.safeHighlight=function(e,t){function o(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}if(e=n.encodeHTML(e),!(t=n.encodeHTML(t)))return e;var i=new RegExp("&[^;]+;|"+o(t),"gi");return e.replace(i,function(e){return e.toLowerCase()===t.toLowerCase()?"<em>"+e+"</em>":e})},n.safeToString=function(e){return angular.isUndefined(e)||null==e?"":e.toString().trim()},n.encodeHTML=function(e){return n.safeToString(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},n.handleUndefinedResult=function(e,t){return function(){var n=e.apply(null,arguments);return angular.isUndefined(n)?t:n}},n.replaceSpacesWithDashes=function(e){return n.safeToString(e).replace(/\s/g,"-")},n.isModifierOn=function(e){return e.shiftKey||e.ctrlKey||e.altKey||e.metaKey},n.promisifyValue=function(e){return e=!!angular.isUndefined(e)||e,t[e?"when":"reject"]()},n.simplePubSub=function(){var e={};return{on:function(t,n,o){return t.split(" ").forEach(function(t){e[t]||(e[t]=[]),(o?[].unshift:[].push).call(e[t],n)}),this},trigger:function(t,o){return(e[t]||[]).every(function(e){return n.handleUndefinedResult(e,!0)(o)}),this}}},n}]),o.run(["$templateCache",function(e){e.put("ngTagsInput/tags-input.html",'<div class="host" tabindex="-1" ng-click="eventHandlers.host.click()" ti-transclude-append><div class="tags" ng-class="{focused: hasFocus}"><ul class="tag-list"><li class="tag-item" ng-repeat="tag in tagList.items track by track(tag)" ng-class="getTagClass(tag, $index)" ng-click="eventHandlers.tag.click(tag)"><ti-tag-item scope="templateScope" data="::tag"></ti-tag-item></li></ul><input class="input" autocomplete="off" ng-model="newTag.text" ng-model-options="{getterSetter: true}" ng-keydown="eventHandlers.input.keydown($event)" ng-focus="eventHandlers.input.focus($event)" ng-blur="eventHandlers.input.blur($event)" ng-paste="eventHandlers.input.paste($event)" ng-trim="false" ng-class="{\'invalid-tag\': newTag.invalid}" ng-disabled="disabled" ti-bind-attrs="{type: options.type, placeholder: options.placeholder, tabindex: options.tabindex, spellcheck: options.spellcheck}" ti-autosize></div></div>'),e.put("ngTagsInput/tag-item.html",'<span ng-bind="$getDisplayText()"></span> <a class="remove-button" ng-click="$removeTag()" ng-bind="::$$removeTagSymbol"></a>'),e.put("ngTagsInput/auto-complete.html",'<div class="autocomplete" ng-if="suggestionList.visible"><ul class="suggestion-list"><li class="suggestion-item" ng-repeat="item in suggestionList.items track by track(item)" ng-class="getSuggestionClass(item, $index)" ng-click="addSuggestionByIndex($index)" ng-mouseenter="suggestionList.select($index)"><ti-autocomplete-match scope="templateScope" data="::item"></ti-autocomplete-match></li></ul></div>'),e.put("ngTagsInput/auto-complete-match.html",'<span ng-bind-html="$highlight($getDisplayText())"></span>')}])}();var ENABLE_SUBMISSION_STATUS_PUSH=!0,alertCount=0,MAX_ALERTS=5,EXIT_WARNINGS=0,CONNECTIVITY_MODAL=0,DISCONNECTED=!1,globalConfig=null,currentSaveRequest=null,getStatusTimer=null,autoSave=null,currentCodeRequest=null,currSelLang=null,sessionPoll=null,MAX_STATUS_COUNT=30,LINK_SPEED_THRESHOLD=400,POLL_FREQUENCY=15e3,SNAPSHOT_SCREENSHOT_FREQUENCY=3e4,shownConnectivityToast=!1,rootUrl="";window.unauthorized=!1,window.ignore_event=!1;var languageMap={4:"python",11:"c_cpp",35:"javascript",44:"c_cpp",511:"java",512:"ruby",42:"swift",43:"objectivec",27:"csharp",114:"go",510:"java",116:"python",55:"java",39:"scala",62:"text",117:"r",29:"php"};toastr.options.newestOnTop=!1,toastr.options.closeButton=!0,toastr.options.escapeHtml=!1,toastr.options.preventDuplicates=!0,toastr.options.progressBar=!0,toastr.options.positionClass="toast-bottom-right";var summerNoteOptions={focus:!0,height:200,toolbar:[["edit",["undo","redo"]],["headline",["style"]],["style",["bold","italic","underline","clear"]],["font",["strikethrough","superscript","subscript"]],["fontface",["fontname"]],["textsize",["fontsize"]],["fontclr",["color"]],["alignment",["ul","ol","paragraph","height"]],["table",["table"]],["insert",["link","picture","hr"]],["help",["help"]]],fontNames:["Serif","Sans","Arial","Arial Black","Courier","Courier New","Comic Sans MS","Helvetica","Impact","Lucida Grande","Source Sans Pro","Nunito","ASAP","Barlow","d-din","Din","Heebo","Lato","montserrat","OpenSans","Oswald","Oxygen","quicksand","Raleway","RobotoMono","Ubuntu","Anton","Archivo","Avenir","CreteRound","D-DIN-Bold","DinPro"],fontNamesIgnoreCheck:["Source Sans Pro","Nunito","ASAP","Barlow","d-din","Din","Heebo","Lato","montserrat","OpenSans","Oswald","Oxygen","quicksand","Raleway","RobotoMono","Ubuntu","Anton","Archivo","Avenir","CreteRound","D-DIN-Bold","DinPro"]},debounce=function(e,t){var n;return function(){var o=this,i=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(o,i)},t)}},throttle=function(e,t){var n;return function(){var o=arguments,i=this;n||(e.apply(i,o),n=!0,setTimeout(function(){n=!1},t))}};$("body").on("click",".ga-event-track",function(e){var t=e.target,n=$(t).data("eventaction");trackGaEvent("ib_test",n)}),window.onunload=function(){cancelAllRequestsAndIntervals()},$(document).ready(function(){window.seek_help_pop_up_unsolved_hash={},window.seek_help_pop_up_solved_hash={},$("body").delegate("#failed-test-button","click",function(){$("#custom-input-modal-"+globalConfig.index).modal("show");var e=$(this).data("input");$("#custom_input_textarea_"+globalConfig.index).val(e)}),window.seek_help_pop_up=function(e){location.href.includes("/academy/")&&(classroom_scope=angular.element(document.getElementById("academy-classroom")).scope(),"solved"!=e||window.seek_help_pop_up_solved_hash[globalConfig.problem_id]?"unsolved"!=e||window.seek_help_pop_up_unsolved_hash[globalConfig.problem_id]||(classroom_scope.seek_help_pop_up_status="unsolved",$("#help_options").css("display","block"),window.seek_help_pop_up_unsolved_hash[globalConfig.problem_id]=!0):(classroom_scope.seek_help_pop_up_status="solved",window.seek_help_pop_up_solved_hash[globalConfig.problem_id]=!0))}}),function(){myinterviewtrainer.createNS("problem"),myinterviewtrainer.createNS("problem.submit");var e=function(e){if(null===(null==e?document.getElementById("editor"):document.getElementById("editor_"+e)))return myinterviewtrainer.problem.editor=null,null;ace.require("ace/ext/language_tools"),myinterviewtrainer.problem.editor=null==e?ace.edit("editor"):ace.edit("editor_"+e);var t=myinterviewtrainer.problem.editor;return t.setOptions({showLineNumbers:!0,displayIndentGuides:!0,enableBasicAutocompletion:!0,fontSize:"14px",maxLines:100,minLines:20,showInvisibles:!1,showPrintMargin:!1,scrollPastEnd:!1,useSoftTabs:!0,tabSize:4}),t.$blockScrolling=Infinity,t.setTheme("ace/theme/chrome"),t.getSession().setUseWorker(!1),null==e?t.getSession().setMode("ace/mode/"+languageMap[$("#select-language").val()]):t.getSession().setMode("ace/mode/"+languageMap[$("#select-language-"+e).val()]),t.commands.addCommand({name:"SaveCode",bindKey:{win:"Ctrl-s",mac:"Command-s",linux:"Ctrl-s"},exec:function(){myinterviewtrainer.problem.save_code.apply($("#problem-save-btn"))}}),t};window.initAceEditor=e,myinterviewtrainer.problem.submit.init=function(t){if(globalConfig=t,t.live)var n=e(t.index);else var n=e(null);null!==n&&(myinterviewtrainer.problem.change_language.init(t),t.live?($("#select-language-"+t.index).val(t.programming_language_id).trigger("change","init_editor"),myinterviewtrainer.problem.init_auto_save()):($("#select-language").val("44").trigger("change"),myinterviewtrainer.problem.init_auto_save()))},myinterviewtrainer.problem.save_code=function(e){var e=e;if([null,undefined].includes(e)&&(e=!1),DISCONNECTED)e||openConnectivityCheck();else{myinterviewtrainer.problem.disable_save(globalConfig),null!==currentSaveRequest&&currentSaveRequest.abort();var t=null;myinterviewtrainer.problem.editor&&(t=myinterviewtrainer.problem.editor.getValue()),t?currentSaveRequest=$.ajax({url:rootUrl+"save-code",method:"POST",data:{problem_id:globalConfig.problem_id,programming_language_id:$("#select-language-"+globalConfig.index).val(),problem_code:myinterviewtrainer.problem.editor.getValue()},success:function(){myinterviewtrainer.problem.enable_save(globalConfig)},error:function(e){$("#ib_sub_loader").fadeOut("fast"),myinterviewtrainer.problem.enable_save(globalConfig),serverErrorHandling(e)}}):(toastr.warning("Please provide some code"),myinterviewtrainer.problem.enable_save(globalConfig))}},myinterviewtrainer.problem.init_auto_save=function(){null!==autoSave&&clearTimeout(autoSave),null!==currentSaveRequest&&currentSaveRequest.abort(),clearTimeout(getStatusTimer),null!==myinterviewtrainer.problem.editor&&myinterviewtrainer.problem.editor.on("change",function(){autoSave&&clearTimeout(autoSave),autoSave=setTimeout(function(){myinterviewtrainer.problem.save_code.apply($("#problem_save_btn_"+globalConfig.index),[!0])},6e4)})},myinterviewtrainer.createNS("problem.change_language"),myinterviewtrainer.problem.change_language.init=function(e){currSelLang=parseInt($("#select-language-"+e.index).val()),$("#select-keybindings-"+e.index).on("change",function(){var e=$(this).val();"ace"===e?myinterviewtrainer.problem.editor.setKeyboardHandler(null):myinterviewtrainer.problem.editor.setKeyboardHandler(e)}),$("#select-language-"+e.index).on("change",function(t,n){var o=document.querySelector("#liveTest"),i=angular.element(o).scope();if(DISCONNECTED)$(t.target).val(currSelLang),i!=undefined&&(i.curr_selected_language=currSelLang,i.selected_language_hash[globalConfig.problem_id]=currSelLang,i.safeApply()),openConnectivityCheck();else{var r=this;null!==currentSaveRequest&&currentSaveRequest.abort(),null!=currentCodeRequest&&currentCodeRequest.abort(),$(this).val()&&(e.programming_language_id=parseInt($(this).val())),$(".code_editor_loader").show(),currentCodeRequest=$.ajax({url:rootUrl+"solution",data:{programming_language_id:$(this).val()||e.programming_language_id,problem_id:e.problem_id},success:function(o){if(o.success){if(myinterviewtrainer.problem.editor){var s=function e(){if(myinterviewtrainer.problem.editor.firepadReady){var t=myinterviewtrainer.problem.editor.getValue();n&&"init_editor"===n?t&&""!==t||myinterviewtrainer.problem.editor.setValue(o.code||""):(myinterviewtrainer.problem.editor.setValue(o.code||""),myinterviewtrainer.problem.save_code(!0)),$(".code_editor_loader").hide()}else setTimeout(e,100)};myinterviewtrainer.problem.editor.firepadReady?s():setTimeout(s,100),setGlobalConfig(e)}myinterviewtrainer.problem.editor.getSession().setUseWorker(!1),myinterviewtrainer.problem.editor.getSession().setMode("ace/mode/"+languageMap[$(r).val()]),currSelLang=parseInt($("#select-language-"+e.index).val())}else $(t.target).val(currSelLang);i!=undefined&&(i.curr_selected_language=currSelLang,i.selected_language_hash[globalConfig.problem_id]=currSelLang,i.safeApply()),$("#ib_sub_loader").fadeOut("fast")},error:function(e){DISCONNECTED&&$(t.target).val(currSelLang),i!=undefined&&(i.curr_selected_language=currSelLang,i.selected_language_hash[globalConfig.problem_id]=currSelLang,i.safeApply()),$("#ib_sub_loader").fadeOut("fast"),serverErrorHandling(e)}})}})},myinterviewtrainer.problem.reset_editor=function(){DISCONNECTED?openConnectivityCheck():($(".code_editor_loader").show(),$.confirm({icon:"fa fa-warning",title:"Warning",content:"You will irreversibly lose your saved solution. Are you sure you want to go back to the original template?",columnClass:"col-sm-12 col-md-offset-3 col-lg-offset-3 col-md-6 col-lg-6",buttons:{confirm:{text:"RESET CODE TEMPLATE",btnClass:"btn-red",action:function(){null!==currentSaveRequest&&currentSaveRequest.abort();var e=$("#select-language-"+globalConfig.index).val();$.ajax({url:rootUrl+"reset-code",method:"get",data:{problem_id:globalConfig.problem_id,programming_language_id:e},success:function(t){t.success&&(myinterviewtrainer.problem.editor?(myinterviewtrainer.problem.editor.setValue(t.code),$(".code_editor_loader").hide()):recordErrors("Code editor Loading infinietly"),myinterviewtrainer.problem.editor.getSession().setUseWorker(!1),myinterviewtrainer.problem.editor.getSession().setMode("ace/mode/"+languageMap[e])),$("#ib_sub_loader").fadeOut("fast")},error:function(e){$("#ib_sub_loader").fadeOut("fast"),recordErrors("Reset code failed"),serverErrorHandling(e)}})}}},backgroundDismiss:!0,theme:"supervan",closeIcon:!0}))},myinterviewtrainer.problem.submission_status_hash={},myinterviewtrainer.problem.submit_code=function(e,t){if(DISCONNECTED)openConnectivityCheck();else{var n=$("#select-language-"+globalConfig.index).val();if(n){$("#submission_status_indicator").attr("style","display : none;");var o="",i="";"submit"==e?(o="We will run your solution for all the test cases present. Do you want to submit your solution?",i="SUBMIT SOLUTION"):"test"==e?(o="We will test your solution with the trivial test case for this problem. Do you want to test your solution?",i="TEST CODE"):"custom"==e&&(o="We will test your solution with the custom input provided. Do you want to test your solution?",i="TEST WITH CUSTOM INPUT");var r=globalConfig.custom_input;null==r&&(r=$("#custom_input_textarea_"+globalConfig.index).val()),"test"!=e?$.confirm({icon:"fa fa-info-circle",title:"Evaluate Solution",content:o,columnClass:"col-sm-12 col-md-offset-3 col-lg-offset-3 col-md-6 col-lg-6",buttons:{confirm:{text:i,btnClass:"btn-blue",action:function(){null!==currentSaveRequest&&currentSaveRequest.abort(),null!=currentCodeRequest&&currentCodeRequest.abort(),$("#custom-input-modal-"+globalConfig.index).modal("hide"),trackGaEvent("ib_test","solution_submit"),myinterviewtrainer.problem.submission_status_hash[globalConfig.problem_id]={submitted:!0,evaluated:!1},$.ajax({url:rootUrl+"evaluate-code",method:"post",data:{problem_id:globalConfig.problem_id,programming_language_id:n,submission_content:myinterviewtrainer.problem.editor.getValue(),submission_type:e,custom_input:r},success:function(e){var n=new Date;myinterviewtrainer.problem.submission_status_hash||(myinterviewtrainer.problem.submission_status_hash={}),myinterviewtrainer.problem.submission_status_hash[e.problem_id]={submitted:e.success,evaluated:!1};var o=document.querySelector("#liveTest"),i=angular.element(o).scope();i!=undefined&&i.attempted_hash&&(i.attempted_hash[e.problem_id]=!0,$("#attempted_problems").text(i.countValues(i.attempted_hash),!0)),$("#current_submission_id").val(e.submission_id);var r="WebSocket"in window||"MozWebSocket"in window,s=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);ENABLE_SUBMISSION_STATUS_PUSH&&r&&!s?setTimeout(function(){myinterviewtrainer.problem.submission_status_hash[e.problem_id].evaluated||myinterviewtrainer.problem.status.init({url:rootUrl+"status",submit_time:n},t)},5e3):(s||trackGaEvent("ib_test","no_websocket"),trackGaEvent("ib_test","polling"),myinterviewtrainer.problem.status.init({url:rootUrl+"status",submit_time:n},t)),$("#status-ht-"+globalConfig.index).parent().show(),$("#status-ht-"+globalConfig.index).show(),$("#status-ht-"+globalConfig.index).html('Please wait while we are evaluating... <i class="fa fa-spinner fa-spin" style="float: right;"></i>'),$("#status-ct-"+globalConfig.index).empty(),$(".main").animate({scrollTop:$("#status-ct-"+globalConfig.index)[0].offsetTop-50},1e3)},error:function(e){$("#ib_sub_loader").fadeOut("fast"),recordErrors("Submit code failed"),serverErrorHandling(e)}})}}},backgroundDismiss:!0,theme:"supervan",closeIcon:!0}):(null!==currentSaveRequest&&currentSaveRequest.abort(),null!=currentCodeRequest&&currentCodeRequest.abort(),$.ajax({url:rootUrl+"evaluate-code",method:"post",data:{problem_id:t||globalConfig.problem_id,programming_language_id:n,submission_content:myinterviewtrainer.problem.editor.getValue(),submission_type:e,custom_input:r},success:function(e){var n=new Date,o=document.querySelector("#liveTest"),i=angular.element(o).scope();i!=undefined&&i.attempted_hash&&(i.attempted_hash[e.problem_id]=!0,$("#attempted_problems").text(i.countValues(i.attempted_hash),!0)),$("#current_submission_id").val(e.submission_id),myinterviewtrainer.problem.status.init({url:rootUrl+"status",submit_time:n},t),$("#status-ht-"+globalConfig.index).parent().show(),$("#status-ht-"+globalConfig.index).show(),$("#status-ht-"+globalConfig.index).html('Please wait while we are evaluating... <i class="fa fa-spinner fa-spin" style="float: right;"></i>'),$("#status-ct-"+globalConfig.index).empty(),$(".main").animate({scrollTop:$("#status-ct-"+globalConfig.index)[0].offsetTop-50},1e3)},error:function(e){recordErrors("Submit code failed"),serverErrorHandling(e)}}))}else alert("Invalid Programming Language provided. Try reloading...")}},myinterviewtrainer.createNS("problem.status"),myinterviewtrainer.problem.status.process_status_response=function(e){var t=null;if(e.problem_id==globalConfig.problem_id&&(t=$("#status-ct-"+globalConfig.index),t.parent().show(),t.html(e.html),0===e.status)){if(trackGaEvent("ib_test","status_received",e.push_type||"poll"),myinterviewtrainer.problem.submission_status_hash[e.problem_id]={submitted:!0,evaluated:!0},256==e.result&&0==e.submission_type){var n=document.querySelector("#liveTest");if(n!=undefined){var o=angular.element(n).scope();o.solved_hash[e.problem_id]||(o.solved_hash[e.problem_id]=!0,window.seek_help_pop_up("solved"))}}else if(256==e.result&&1==e.submission_type){var n=document.querySelector("#liveTest");if(n!=undefined){var o=angular.element(n).scope();o.attempted_hash[e.problem_id]=!0}}else 256!=e.result&&0==e.submission_type&&location.href.includes("/academy/")&&window.seek_help_pop_up("unsolved");myinterviewtrainer.problem.enable_submit(globalConfig),clearTimeout(getStatusTimer),$('[data-toggle="tooltip"]').tooltip(),$("#status-ht-"+globalConfig.index).hide()}},myinterviewtrainer.problem.status.init=function(e,t){var n=0;myinterviewtrainer.problem.disable_submit(globalConfig),$("#custom-input-modal-"+globalConfig.index).modal("hide"),clearTimeout(getStatusTimer);var o=function o(){++n<=8&&($.ajax({url:rootUrl+e.url,data:{submission_id:$("#current_submission_id").val(),problem_id:t||globalConfig.problem_id},success:myinterviewtrainer.problem.status.process_status_response}),getStatusTimer=setTimeout(o,5e3*Math.pow(1.5,n)))};getStatusTimer=setTimeout(o,5e3)},myinterviewtrainer.problem.disable_submit=function(e){$("#submit_solution_"+e.index).attr("disabled",!0),$("#submit_solution_"+e.index).html("Please wait.."),$("#test_solution_"+e.index).attr("disabled",!0),$("#test_solution_"+e.index).text("Please wait.."),$("#test_custom_input_"+e.index).attr("disabled",!0),$("#test_custom_input_"+e.index).text("Please wait.."),setTimeout(function(){myinterviewtrainer.problem.enable_submit(e)},3e4)},myinterviewtrainer.problem.enable_submit=function(e){$("#submit_solution_"+e.index).attr("disabled",!1),$("#submit_solution_"+e.index).html('<i class="fa fa-play-circle" style="color: #5cb85c;"></i>&nbsp;&nbsp;Submit'),$("#test_solution_"+e.index).attr("disabled",!1),$("#test_solution_"+e.index).html('<i class="fa fa-play-circle" style="color: #f0ad4e;"></i>&nbsp;&nbsp;Test'),$("#test_custom_input_"+e.index).attr("disabled",!1),$("#test_custom_input_"+e.index).html('<i class="fa fa-bug" style="color: #5cb85c;"></i>&nbsp;&nbsp;Test with Custom Input')},myinterviewtrainer.problem.disable_save=function(e){$("#problem_save_btn_"+e.index).attr("disabled",!0),$("#problem_save_btn_"+e.index).html("Saving..."),setTimeout(function(){myinterviewtrainer.problem.enable_save(e)},5e3)},myinterviewtrainer.problem.enable_save=function(e){$("#problem_save_btn_"+e.index).attr("disabled",!1),
$("#problem_save_btn_"+e.index).html('<i class="fa fa-save" style="color: #5cb85c;"></i>&nbsp;&nbsp;Save')}}();var ibTestApp=angular.module("ibTestApp",["ng-showdown","ngAnimate","angularFileUpload","webcam","summernote","ngTagsInput"]);ibTestApp.controller("RegisterIBTestController",["$scope","testBackend","$sce","FileUploader",function(e){angular.element(document).ready(function(){function t(){e.candidate_degree=null}t()})}]),ibTestApp.controller("LiveIBTestController",["$scope","testBackend","$sce","FileUploader","$interval",function(e,t,n,o,r){function s(){function s(n){$("#ib_sub_loader").show();var o={hint_id:n};t.getHintAccess(o,function(t){$("#ib_sub_loader").hide(),e.current_hint_title=t.hint.title,e.current_hint_descripton=t.hint.markdown_content,$("#showHintModal").modal("show")})}var a,l,c=null,u="snapshots/interviewbit_test_sessions",d=null,h="screenshots/interviewbit_test_sessions",p=new S3Store("us-west-2","ib-assessment-tests"),f=new S3Store("us-west-2","ib-assessment-tests"),m="https://dajh2p2mfq4ra.cloudfront.net/assets/icons/ib-logo-hire-8f3406787bc4241628bb7e5bea43d56a7ab275401134c297b6631c8b81cd3996.png",g=null;e.supported_languages=null,e.LOW_BANDWIDTH=!0,e.dsml_submission_state=1,e.filter_tags={},e.all_tags=[],e.member_emails=[],e.section_timers={},e.myinterviewtrainer=window.myinterviewtrainer,e.checkDownloadSpeed=function(){g=new Image,a=(new Date).getTime(),g.src=m,g.onload=function(){l=(new Date).getTime();var t=e.downloadSpeedInKiloBits();console.log("Your link speed (in Kbps): ",t),t<LINK_SPEED_THRESHOLD?(e.LOW_BANDWIDTH=!0,recordErrors("[Slow Internet]Asset Download Speeed(in Kbps): "+t)):e.LOW_BANDWIDTH=!1,console.log("Low bandwidth Internet: ",e.LOW_BANDWIDTH)}},e.downloadSpeedInKiloBits=function(){return(148824/((l-a)/1e3)/1024).toFixed(2)},e.safeApply=function(e){var t=this.$root.$$phase;"$apply"==t||"$digest"==t?e&&"function"==typeof e&&e():this.$apply(e)},e.problemInitializers=function(t){e.filter_tags[t]=[],e.ideas&&(e.original_idea_indices={},angular.forEach(e.ideas[t].idea_associations,function(t,n){e.original_idea_indices[t.idea_association_id]=n,angular.forEach(t.tags,function(t){e.all_tags.includes(t.name)||e.all_tags.push(t.name)})}),angular.forEach(e.ideas[t].wishlist_ideas,function(t){angular.forEach(t.tags,function(t){e.all_tags.includes(t.name)||e.all_tags.push(t.name)})}))},sortProblemsBasedOnSection=function(e,t){var n=[],o=[],i={},r=e.length;for(let o=0;o<r;o++){var s=e[o].id;i[s]=e[o];for(var a in t)t[a].questions.includes(Number(s))&&n.push([s,a])}n.sort(function(e,t){return e[1]-t[1]});var l=n.length;for(let e=0;e<l;e++)o.push(i[n[e][0]]);return o},e.getLiveTestProblems=function(){t.getLiveTestProblems(function(n){n.success?(sections=n.current_test.questions_blue_print?n.current_test.questions_blue_print.sections:null,e=angular.extend(e,n,n.current_test,{test_problems:sortProblemsBasedOnSection(n.test_problems,sections)}),[null,undefined].includes(e.sections)&&(e.sections=n.current_test.questions_blue_print.sections),angular.forEach(e.section_usage_hash,function(t,n){e.initializeSectionTimers(n)}),window.POLL_FREQUENCY=n.POLL_FREQUENCY||15e3,window.SNAPSHOT_SCREENSHOT_FREQUENCY=n.SNAPSHOT_SCREENSHOT_FREQUENCY||3e4,$("#liveTest").show(),$("#ib_loader").fadeOut("slow",function(){setTimeout(function(){$("#index_page").click(),$(".tooltip-enable").tooltip()},500),e.show_problem_alert&&toastr.info("Problems don't change on every refresh for test taking candidates. It is only for demonstration purposes.","Info",{timeOut:0,extendedTimeOut:0})}),setTimeout(function(){$("#initializer").fadeOut()},1e3),e.do_polling&&(sessionPoll=setInterval(function(){t.durationPoll({current_duration:e.test_duration,current_extra_time:e.extra_time},function(e){if(e.success)if(window.POLL_FREQUENCY=e.POLL_FREQUENCY||15e3,window.SNAPSHOT_SCREENSHOT_FREQUENCY=e.SNAPSHOT_SCREENSHOT_FREQUENCY||3e4,closeConnectivityCheck(),e.disqualified)toastr.clear(),toastr.info("You have been disqualified. Please contact your test administrator for further queries. Redirecting...","DISQUALIFIED!",{timeOut:0}),setTimeout(function(){location.reload()},5e3);else if(e.reload){var t=e.status_message||"Test Settings have been changed. Refreshing..";toastr.info(t,"Info",{timeOut:5e3}),setTimeout(function(){location.reload()},5e3)}else e.status_message!=undefined&&""!=e.status_message&&toastr.info(e.status_message,"ANNOUNCEMENT",{timeOut:0,extendedTimeOut:0})},function(e){e.success||recordErrors("Polling Failed")})},POLL_FREQUENCY)),["webcam_optional","webcam_required"].includes(window.webcam)&&(e.LOW_BANDWIDTH||setInterval(function(){try{e.makeSnapshot(),e.takeScreenshot()}catch(e){trackGaEvent("spy","fail",navigator.appName)}},SNAPSHOT_SCREENSHOT_FREQUENCY),["webcam_required"].includes(window.webcam)&&setInterval(function(){window.checkForWebcam()},15e3))):toastr.error(n.error_message||"Something went wrong!","ERROR")})},e.renderHtml=function(e){return n.trustAsHtml(e)};var v=function(t){e.current_section="";for(var n in e.sections){e.sections[n].questions.includes(t)&&(e.current_section=parseInt(n))}};e.populateCodeEditorWrapper=function(t){var n=0,o={};for(var i in e.test_problems){var r=e.test_problems[i];r.id==t&&(n=i,o=r)}e.is_on_all_question_tab=!1,e.populateCodeEditor(o,parseInt(n)),location.href.includes("/academy/")&&(classroom_scope=angular.element(document.getElementById("academy-classroom")).scope(),classroom_scope&&(current_tab=classroom_scope.currentTab,"completed"==classroom_scope.data.tabs[current_tab].status&&(e.solved_hash[t]?window.seek_help_pop_up("solved"):$("#help_options").css("display","none"))))},e.populateCodeEditor=function(n,o){if(v(n.id),e.current_section_info=e.current_test.questions_blue_print.sections[e.section_problem_hash[n.id]],e.answer=null,e.current_test.enable_section_locking&&e.section_timers[e.current_section].ended)$.alert({icon:"fa fa-info-circle",title:"Section has Ended!",content:"<b>"+e.current_section_info.name+"</b> has ended. You cannot attempt any questions in this section.",columnClass:"col-sm-12 col-md-offset-2 col-lg-offset-2 col-md-8 col-lg-8",backgroundDismiss:!0,theme:"supervan",closeIcon:!0}),setTimeout(function(){$("#index_page").click()},1e3);else if(e.current_test.enable_section_locking&&e.section_timers[e.current_section].locked)$.confirm({icon:"fa fa-warning",title:"Do you really want to unlock '"+e.current_section_info.name+"'?",content:"Once unlocked, your section timer will not stop!",columnClass:"col-sm-12 col-md-12 col-lg-12",buttons:{confirm:{text:"Unlock Section",btnClass:"btn-blue",action:function(){e.unlockSection(),$("#index_page").click()}},cancel:{text:"Cancel",btnClass:"btn-red",action:function(){$("#index_page").click()}}},backgroundDismiss:!0,theme:"supervan",closeIcon:!0}),setTimeout(function(){$("#index_page").click()},1e3);else{e.current_problem_no=o+1,$("#ib_sub_loader").show(),$("#div_editor_"+(o+1)).html('<textarea id="editor_'+(o+1)+'" rows="18"></textarea>');var i=e.curr_selected_language||Object.keys(e.all_problems_supported_languages[n.id])[0];e.selected_language_hash[n.id]!=undefined&&-1!=e.selected_language_hash[n.id]&&-1!=e.supported_languages.indexOf(e.selected_language_hash[n.id])&&(i=e.selected_language_hash[n.id]),e.curr_selected_language=i,setGlobalConfig({problem_id:$("#problem_"+(o+1)).data("problemId"),programming_language_id:i,live:!0,index:$("#problem_"+(o+1)).data("problemIndex")}),t.markProblemOpened({problem_id:n.id},function(){$("#ib_sub_loader").fadeOut("fast")}),["code","code_no_template","shell","sql","machine_learning","data_science","approximate","test_coverage","non_deterministic"].includes(n.judge_type)?(myinterviewtrainer.problem.submit.init({problem_id:$("#problem_"+(o+1)).data("problemId"),programming_language_id:i,live:!0,index:$("#problem_"+(o+1)).data("problemIndex")}),myinterviewtrainer.problem.editor&&!myinterviewtrainer.problem.editor.firepadInitiated&&e.initFirePad({ibt_session_slug:e.ibt_session_slug,problem_id:$("#problem_"+(o+1)).data("problemId")})):(null!==autoSave&&clearTimeout(autoSave),t.getSolution({problem_id:n.id,programming_language_id:-1},function(t){if(t.success)if($("#ib_sub_loader").fadeOut("fast"),e.solution=t.code,"objective"==t.problem.judge_type)"text"==t.problem.answer_type?$(".obj-value-"+t.problem.id).val(e.solution):"multiple_choice"==t.problem.answer_type&&$(".checked_"+t.problem.id).each(function(e,n){var o=$(n).val();-1!=t.code.indexOf(o)?$(n).prop("checked",!0):$(n).prop("checked",!1)});else if(["ideathon","project"].includes(t.problem.judge_type)){e.milestones=Object.assign(e.milestones||{},t.milestones||{}),e.ideas=Object.assign(e.ideas||{},t.ideas||{}),e.project_links=Object.assign(e.project_links||{},t.project_links||{}),e.users=Object.assign(e.users||{},t.users||{});for(var n in e.ideas)e.ideas[n].idea_associations=Object.values(e.ideas[n].idea_associations),e.ideas[n].wishlist_ideas=Object.values(e.ideas[n].wishlist_ideas),e.ideas[n].project_problem&&(e.ideas[n].project_problem.project_link=e.project_links[e.ideas[n].project_problem.id]);e.today=new Date,Object.keys(e.milestones).forEach(function(t){for(var n in e.milestones[t])e.milestones[t][n].due_date&&(e.milestones[t][n].due_date=new Date(e.milestones[t][n].due_date))}),e.presentations=Object.assign(e.presentations||{},t.presentations||{}),e.sortIdeasByPriority(),e.initializePhaseTimers(),e.problemInitializers(t.problem.id)}}))}},e.activateProblemTab=function(t){e.problemTabIndex="problem_index_"+t,e.problemTabParent=angular.element(document.getElementById(e.problemTabIndex)),e.problemTabParent.addClass("active")},e.saveObjectiveAnswer=function(t,n,o){var o=o,i=null;e.current_test.realtime_objective&&(e.attempted_hash[o]||e.solved_hash[o])?(toastr.warning("You have already answered this question","ALREADY SUBMITTED"),e.is_academy&&(e.answer=e.objective_problems_answer_hash[o])):e.current_test.realtime_objective?$.confirm({icon:"fa fa-warning",title:"Do you really want to submit your answer for this question?",content:"You cannot edit your answer once you submit",columnClass:"col-sm-12 col-md-12 col-lg-12",buttons:{confirm:{text:"SUBMIT ANSWER",btnClass:"btn-blue",action:function(){e.saveObjectiveAnswerHelper(t,n,o,i)}},cancel:{text:"Cancel",btnClass:"btn-red"}},backgroundDismiss:!0,theme:"supervan",closeIcon:!0}):e.saveObjectiveAnswerHelper(t,n,o,i)},e.saveObjectiveAnswerHelper=function(e,n,o,i){if($(".submit-objective").prop("disabled","true"),$(".submit-objective").val("Submitting..."),"text"===e.answer_type)i=$("#objective_content_"+(n+1)).val();else{var r=[];$("#objective_"+(n+1)+" :checked").each(function(){r.push($(this).val())}),i=r}null!=i&&i.length>0?t.saveObjectiveAnswer({problem_id:o,programming_language_id:-1,answer_type:e.answer_type,content:i},function(e){y(e)},function(){recordErrors("Failed to record users response"),toastr.error("Failed to record your response.")}):toastr.warning("Please provide some answer","WARNING!")};var y=function(t){e.is_academy||(success_message="Your answer has been recorded.",e.current_test.realtime_objective||(success_message+=" It will be evaluated after the test has ended."),toastr.success(success_message,"SUCCESS")),$(".submit-objective").prop("disabled",!1),$(".submit-objective").val("Submit"),$(".test_problem_"+t.submission.problem_id+" a span").addClass("solved"),e.attempted_hash[t.submission.problem_id]||(e.attempted_hash[t.submission.problem_id]=!0,e.is_academy?e.solved_hash[t.submission.problem_id]=t.submission_result:e.solved_hash[t.submission.problem_id]=!1),e.is_academy?e.answer=t.aa:setTimeout(function(){e.test_problems[index+1]!=undefined&&$(".test_problem_"+e.test_problems[index+1].id+" > a").click()},500)};e.openSubmissionFileModal=function(t){$("#submissionFileModal_"+t).modal("show"),e.changeDSMLSubmissionState(1,t)},e.changeDSMLSubmissionState=function(t,n){switch(t?e.dsml_submission_state=t:toastr.warning("Invalid Submission State","WARNING!"),t){case 1:$("#ds-upload-code-"+n).addClass("in active"),$("#ds-upload-project-files-"+n).removeClass("in active"),$("#ds-upload-submission-file-"+n).removeClass("in active");break;case 2:$("#ds-upload-code-"+n).removeClass("in active"),$("#ds-upload-project-files-"+n).addClass("in active"),$("#ds-upload-submission-file-"+n).removeClass("in active");break;case 3:$("#ds-upload-code-"+n).removeClass("in active"),$("#ds-upload-project-files-"+n).removeClass("in active"),$("#ds-upload-submission-file-"+n).addClass("in active");break;default:$("#ds-upload-code-"+n).addClass("in active"),$("#ds-upload-project-files-"+n).removeClass("in active"),$("#ds-upload-submission-file-"+n).removeClass("in active")}},e.resetDSMLSubmissionState=function(){$.confirm({icon:"fa fa-warning",title:"Warning",content:"This will restart your submission flow. Do you really want to restart this submission?",columnClass:"col-sm-12 col-md-offset-3 col-lg-offset-3 col-md-6 col-lg-6",buttons:{confirm:{text:"RESTART SUBMISSION",btnClass:"btn-orange",action:function(){e.current_code_file_content="",myinterviewtrainer.problem.editor.setValue(e.current_code_file_content),myinterviewtrainer.problem.save_code(!0),e.changeDSMLSubmissionState(1,globalConfig.problem_id)}}},backgroundDismiss:!0,theme:"supervan",closeIcon:!0})},e.initializePhaseTimers=function(){phase_timers=$(".phase-timer"),phase_timers.each(function(){var e=$(this),t=60*parseInt(e.data("time-left-minutes")),n=moment().add(e.data("time-left-minutes"),"minutes").toDate();$(e).countdown(n).on("update.countdown",function(e){var o="%H Hr : %M min : %S sec ",i=(new Date(n).getTime()-parseInt(e.timeStamp))/1e3;parseFloat(t);i>=86400&&(o="%D day %H hr : %M min : %S sec"),i>=172800&&(o="%D days %H hr : %M min : %S sec"),$(this).html(e.strftime(o))}).on("finish.countdown",function(e){if("ideathon-phase"==$(e.target).data("type")){endIdeathonPhase($(e.target).data("name"))}})})},e.tagsAutocomplete=function(t){var t=t.toLowerCase(),n=[];return angular.forEach(e.all_tags,function(e){e.toLowerCase().includes(t)&&n.push(e)}),n},e.viewDetailedIdea=function(t,n){e.selected_idea=n,$("#view_detailed_idea_modal_"+t).modal("show")},e.viewTeamFormationGuidelines=function(e){$("#team_formation_guidelines_"+e).modal("show")},e.showAcceptRequestModal=function(t,n){e.decoded_member_key=decodeMemberKey(n.from_id+"-"+n.from_type),e.selected_request=n,e.selected_member=e.participant_info[e.decoded_member_key.id],e.selected_idea=e.getMatchingWishlistIdea(t,n.for_id),$("#accept_request_modal"+t).modal("show")},e.showDenyRequestModal=function(t,n){e.decoded_member_key=decodeMemberKey(n.from_id+"-"+n.from_type),e.selected_request=n,e.selected_member=e.participant_info[e.decoded_member_key.id],e.selected_idea=e.getMatchingWishlistIdea(t,n.for_id),$("#deny_request_modal"+t).modal("show")},e.showCounterRequestModal=function(t,n){e.decoded_member_key=decodeMemberKey(n.from_id+"-"+n.from_type),e.selected_request=n,e.selected_member=e.participant_info[e.decoded_member_key.id],e.selected_idea=e.getMatchingWishlistIdea(t,n.for_id),$("#counter_request_modal"+t).modal("show")},decodeMemberKey=function(e){return{id:e.split("-")[0],type:e.split("-")[1]}},e.getMatchingWishlistIdea=function(t,n){if(t){wishlist_ideas=e.ideas[t].wishlist_ideas;for(i in wishlist_ideas)if(wishlist_ideas[i].idea_association_id==n)return wishlist_ideas[i]}},e.showRequestIdeaModal=function(t,n){e.decoded_member_key=decodeMemberKey(n),e.selected_member=e.participant_info[e.decoded_member_key.id],$("#select_request_idea_modal"+t).modal("show")},e.setIdeaAssociation=function(t){e.selected_idea_ass_id=t},e.showRequestTeamJoinModal=function(t,n){e.decoded_member_key=decodeMemberKey(n),e.selected_idea=e.getMatchingWishlistIdea(t,e.team_invite_suggestions[t][n].ideas[0]),$("#request_team_join_modal"+t).modal("show")},e.upvoteIdea=function(e){t.giveVote({target_type:"IdeaAssociation",target_id:e.idea_association_id,source_type:"InterviewbitTestSession",vote_type:"upvote"},function(e){e.success||toastr.error(e.error_message||"Something went wrong!","ERROR")})},e.downvoteIdea=function(e){t.giveVote({target_type:"IdeaAssociation",target_id:e.idea_association_id,source_type:"InterviewbitTestSession",vote_type:"downvote"},function(e){e.success||toastr.error(e.error_message||"Something went wrong!","ERROR")})},e.indexIdeas=function(t){e.original_idea_indices={},angular.forEach(e.ideas[t].idea_associations,function(t,n){e.original_idea_indices[t.idea_association_id]=n})},e.moveIdeaToWishlist=function(t,n){if(e.ideas[t].wishlist_ideas.length<e.ideathons_hash[t].max_ideas_per_user){var o=e.original_idea_indices[n],i=e.ideas[t].idea_associations.splice(o,1)[0];i.wishlist=!0,i.already_selected=(i.already_selected||0)+1,e.ideas[t].wishlist_ideas.splice(e.ideas[t].wishlist_ideas.length,0,i),e.updateIdeaPriorities(t),toastr.success("<b>"+i.title.toString()+"</b> has been added to your preferred Ideas!","SUCCESS")}else toastr.warning("You can only select "+e.ideathons_hash[t].max_ideas_per_user+" ideas.","WARNING");e.indexIdeas(t)},e.moveIdeaToAll=function(t,n){var o=e.ideas[t].wishlist_ideas.splice(n,1)[0];o.wishlist=!0,o.already_selected=Math.max((o.already_selected||0)-1,0),e.ideas[t].idea_associations.splice(0,0,o),e.updateIdeaPriorities(t),e.indexIdeas(t)},e.moveIdeaInWishlist=function(t,n,o){var i=e.ideas[t].wishlist_ideas.splice(n,1)[0];e.ideas[t].wishlist_ideas.splice(o,0,i),e.updateIdeaPriorities(t)},e.sortIdeasByPriority=function(){for(var t in e.ideas)e.ideas[t].wishlist_ideas.sort((e,t)=>e.priority>t.priority?1:-1)},e.getIdeaPriorities=function(t){if([null,undefined].includes(t))return[];var n={};return e.ideas[t].wishlist_ideas.forEach(function(e,t){n[t]=e.idea_association_id}),n},e.updateIdeaPriorities=function(n){var o=e.getIdeaPriorities(n);t.updatePriorities({targets:Object.values(sortObjectByKey(o)),target_type:"IdeaAssociation",source_type:"InterviewbitTestSessionProblem",problem_id:n},function(e){e.success||toastr.error(e.error_message||"Something went wrong!","ERROR")})},e.addMilestone=function(t){var n={title:"Task",description:"Please type your Task description here",edit:!0};e.milestones[t].push(n),e.updateMilestone(t,n,"create")},e.toggleMilestoneEditMode=function(e){e&&(e.edit=!e.edit)},e.updateMilestone=function(n,o,i){n&&o&&i&&t.updateMilestone({milestone:o,action_type:i,problem_id:n},function(t){if(t.success){if(t.milestones){e.milestones[n]=t.milestones;for(var r in e.milestones[n])e.milestones[n][r].due_date&&(e.milestones[n][r].due_date=new Date(e.milestones[n][r].due_date))}"create"==i&&(e.milestones[n][e.milestones[n].length-1].edit=!0),"incomplete"==i&&toastr.info(o.title.toString()+" marked Incomplete!","INFO")}else toastr.error(t.error_message||"Something went wrong!","ERROR")})},e.updateMilestoneAction=function(t,n,o){"delete"==o?$.confirm({icon:"fa fa-warning",title:"Do you really want to delete this task ?",content:"Once deleted, you cannot get it back",columnClass:"col-sm-12 col-md-12 col-lg-12",buttons:{confirm:{text:"Delete Task",btnClass:"btn-red",action:function(){e.updateMilestone(t,n,o)}},cancel:{text:"Cancel",btnClass:"btn-default"}},backgroundDismiss:!0,theme:"supervan",closeIcon:!0}):e.updateMilestone(t,n,o)},e.openCommentsModal=function(t,n,o){e.selected_milestone=o,$("#view_milesotne_comments_"+t).modal("show")},e.assignMilestoneDueDate=function(t,n){n.due_date=new Date,e.updateMilestoneAction(t,n,"update")},e.openIdeathonSubmissionModal=function(t,n,o){e.ideas[t].project_problem&&e.isProjectLinkValid(e.project_links[e.ideas[t].project_problem.id])?(e.selected_milestone=o,e.milestone_attachment_params={problem_id:n,milestone_achievement_id:o.milestone_achievement_id,attachment_type:o.attachment_type},$("#milestone_achievement_attachment_"+t).modal("show")):toastr.warning("Provide a valid Github Repository Link","WARNING")};var b=null;document.querySelector('meta[name="csrf-token"]')&&(b=document.querySelector('meta[name="csrf-token"]').getAttribute("content")),e.updateMilestoneAchievementAttachment=new o({headers:{"X-CSRF-TOKEN":b},alias:"attachment",url:rootUrl+"save-milestone-attachment",queueLimit:1,removeAfterUpload:!0,autoUpload:!0}),e.updateMilestoneAchievementAttachment.onBeforeUploadItem=function(t){t.formData=[Object.assign(e.milestone_attachment_params,{attachment_type:e.selected_milestone.attachment_type})]},e.updateMilestoneAchievementAttachment.onSuccessItem=function(t,n){n.success?(e.selected_milestone.state="completed",toastr.success(e.selected_milestone.title.toString()+" marked Complete!","SUCCESS")):toastr.error(n.error_message||"Something went wrong! Please contact support@interviewbit.com for further assistance."),$(".modal").modal("hide")},e.updateMilestoneAchievementAttachment.onErrorItem=function(){recordErrors("Failed to upload Task Attachment!"),toastr.error("Error occured while Uploading Attachment. Please refresh your page and try again."),$(".modal").modal("hide")},e.uploadProjectPresentation=new o({headers:{"X-CSRF-TOKEN":b},alias:"attachment",url:rootUrl+"save-project-presentation",queueLimit:1,removeAfterUpload:!0,autoUpload:!0}),e.uploadProjectPresentation.onBeforeUploadItem=function(t){t.formData=[{problem_id:e.ideas[globalConfig.problem_id].project_problem.id}]},e.uploadProjectPresentation.onSuccessItem=function(t,n){n.success?(e.presentations=Object.assign(e.presentations||{},n.presentations||{}),toastr.success("Project Presentation uploaded successfully!","SUCCESS")):toastr.error(n.error_message||"Something went wrong! Please contact support@interviewbit.com for further assistance.")},e.uploadProjectPresentation.onErrorItem=function(){recordErrors("Failed to upload Project Presentation!"),toastr.error("Error occured while Uploading Presentation. Please refresh your page and try again.")},e.commentOnMilestoneAchievement=function(n,o,i,r,s){n&&o&&i&&t.commentOnMilestoneAchievement({milestone_achievement_id:o.milestone_achievement_id,problem_id:n,action_type:"add",parent_id:s,comment_text:r},function(t){t.success?(e.comment_text="",t.comments&&t.comments.length>0&&(o.comments=t.comments)):toastr.error(t.error_message||"Something went wrong!","ERROR")})},e.isProjectLinkValid=function(e){return!(!e||!e.match(/https:\/\/(www.)?github.com\/([a-zA-Z0-9\-\.]+)\/([a-zA-Z0-9\-\.]+)/g))},e.updateProjectProblem=function(n,o){if($("#ib_sub_loader").show(),!e.project_links[n.id].match(/https:\/\/(www.)?github.com\/([a-zA-Z0-9\-\.]+)\/([a-zA-Z0-9\-\.]+)/g))return toastr.warning("Please provide a valid Github Repository Link"),$("#ib_sub_loader").hide(),null;var i={};"description_statement"==o?i={problem_id:n.id,problem_statement:n.problem_statement,markdown_content:n.markdown_content,project_link:e.project_links[n.id],action_type:o}:"project_link"==o&&(i={problem_id:n.id,project_link:e.project_links[n.id],action_type:o}),t.updateProjectProblem(i,function(t){$("#ib_sub_loader").hide(),t.success?(n.project_link=e.project_links[n.id]||n.project_link,"project_link"==o?toastr.success("Repository link updated successfully!","SUCCESS"):toastr.success("Project Details updated successfully!","SUCCESS")):toastr.error(t.error_message||"Something went wrong!","ERROR")})},e.getPreviousSubmissions=function(){t.getPreviousSubmissions({},function(e){e.success||toastr.error(e.error_message||"Something went wrong!","ERROR")})},e.openSEOModal=function(t){$("#seoModal").modal("show"),e.currentInputDescriptor=e.input_descriptor_hash[t]},e.seeExpectedOutput=function(){$("#ib_sub_loader").show(),$("#seoModal").modal("hide"),t.seeExpectedOutput({problem_id:globalConfig.problem_id,input:$("#seo_input").val()},function(e){if($("#seoModal").modal("hide"),e.success)var n=setInterval(function(){$("#ib_sub_loader").show(),t.getExpectedOutput({ask_interviewer_id:e.ai_id},function(e){if($("#seoModal").modal("hide"),e.success&&0!=e.status){11==e.status?"Compilation Error":12==e.status?"Runtime Error":13==e.status?"Time Limit Exceeded":17==e.status?"Memory Limit Exceeded":20==e.status?"Internal Error":"Done",$("#ib_sub_loader").hide(),$.alert({icon:"fa fa-info-circle",title:"See Expected Output",content:"<b style=' color: #ffebcd;'>Your Input:</b><br />"+e.input+"<br /><br /><b style=' color: #ffebcd;'>Expected Output:</b><br />"+e.output,columnClass:"col-sm-12 col-md-offset-2 col-lg-offset-2 col-md-8 col-lg-8",backgroundDismiss:!0,theme:"supervan",closeIcon:!0}),clearInterval(n)}},function(e){$("#ib_sub_loader").hide(),$("#seoModal").modal("hide"),e.success||(recordErrors("See Expected Output failed"),toastr.error("Error","Something went wrong! Please contact support team for further assistance"))})},2e3);else $("#seoModal").modal("hide")},function(e){$("#ib_sub_loader").hide(),$("#seoModal").modal("hide"),e.success||(recordErrors("See Expected Output failed"),toastr.error("Error","Something went wrong! Please contact support team for further assistance."))})},e.unlockSection=function(){$("#ib_sub_loader").show(),t.unlockSection({section_key:e.current_section},function(t){$("#ib_sub_loader").hide(),t.success?(e.section_usage_hash=t.section_usage_hash,toastr.success("Section unlocked Successfully!","SUCCESS"),e.initializeSectionTimers(e.current_section)):toastr.error(t.error_message||"Something went wrong. Please contact support@interviewbit.com for further assistance","ERROR")})},e.initializeSectionTimers=function(t){e.section_timers[t]={},e.section_timers[t].time_remaining_seconds=60*parseFloat(e.section_usage_hash[t].minutes_left),e.section_timers[t].locked=e.section_usage_hash[t].locked,e.section_timers[t].ended=e.section_usage_hash[t].ended,!0!==e.section_timers[t].timer_on&&0==e.section_timers[t].locked&&e.startSectionTimers(t)},e.startSectionTimers=function(t){e.section_timers[t].timer_on=!0,e.section_timers[t].countdown_timer=r(function(){--e.section_timers[t].time_remaining_seconds<=1&&e.stopSectionTimers(t)},1e3)},e.stopSectionTimers=function(t){0==e.section_timers[t].ended&&(r.cancel(e.section_timers[t].countdown_timer),e.section_timers[t].countdown_timer=null,e.section_timers[t].ended=!0,endSection(t))},e.flagQuestion=function(n){$("#flag_question_"+globalConfig.index).toggleClass("fa-bookmark"),$("#flag_question_"+globalConfig.index).toggleClass("fa-bookmark-o"),$("#flag_question_"+globalConfig.index).toggleClass("flag"),e.flag_hash[n.id]=!e.flag_hash[n.id],$(".test_problem_"+globalConfig.problem_id+" a span").toggleClass("flagb"),t.flagQuestion({problem_id:n.id})},e.inActiveMenu=function(){$("#menu > .active").removeClass("active"),e.current_problem_no=""},e.finishTest=function(){$.confirm({icon:"fa fa-warning",title:"Warning",content:"This can not be reverted back. Do you really want to end this test?",columnClass:"col-sm-12 col-md-offset-3 col-lg-offset-3 col-md-6 col-lg-6",buttons:{confirm:{text:"END TEST",btnClass:"btn-red",action:function(){t.finishTest({type:"finish"})}}},backgroundDismiss:!0,theme:"supervan",closeIcon:!0})},e.testCustomInput=function(e){globalConfig.custom_input=$("#custom_input_textarea_"+globalConfig.index).val(),myinterviewtrainer.problem.submit_code("custom",e)},e.hintAlreadyAccessed=function(t,n){return-1!=e.accessed_hints_hash[t].indexOf(n)},e.getHintAccess=function(t,n,o){e.hintAlreadyAccessed(o,t)||e.solved_hash[o]?s(t):$.confirm({icon:"fa fa-warning",title:"Sure about accessing Hint?",content:"Accessing this hint would deduct <b>"+n+"</b> percent of question's max score. Are you sure you want to access this hint?",columnClass:"col-sm-12 col-md-offset-3 col-lg-offset-3 col-md-6 col-lg-6",buttons:{confirm:{text:"ACCESS HINT",action:function(){s(t),e.accessed_hints_hash[o].push(t)}},cancel:{text:"Cancel",btnClass:"btn-red"}},backgroundDismiss:!0,theme:"supervan",closeIcon:!0})},e.poll=function(){t.durationPoll({},function(e){e.success&&closeConnectivityCheck()},function(e){e.success||(recordErrors("Polling failed"),toastr.error("Something went wrong","Error"))})},e.getLiveScoreboard=function(){$("#scoreboard_loader").show(),t.liveScoreboard({},function(t){t.success&&($("#scoreboard_loader").hide(),e.scoreboard=t.scoreboard)})};var b=null;document.querySelector('meta[name="csrf-token"]')&&(b=document.querySelector('meta[name="csrf-token"]').getAttribute("content")),e.uploadProjectFile=new o({headers:{"X-CSRF-TOKEN":b},alias:"project_files",url:rootUrl+"save-project-file",queueLimit:1,removeAfterUpload:!0,autoUpload:!0}),e.uploadProjectFile.onBeforeUploadItem=function(e){e.formData=[{problem_id:globalConfig.problem_id}]},e.uploadProjectFile.onSuccessItem=function(t,n){var o=e.test_problems[e.current_problem_no-1].id;e.project_files_hash[o]=t.file.name,$(".test_problem_"+o+" a span").addClass("solved"),e.attempted_hash[o]||(e.attempted_hash[o]=!0,e.solved_hash[o]=!1),n.success&&(2==e.dsml_submission_state&&e.changeDSMLSubmissionState(3,globalConfig.problem_id),toastr.success("Succesfully Uploaded Files","SUCCESS"))},e.uploadProjectFile.onErrorItem=function(){recordErrors("Project/Assignment file upload failed"),toastr.error("Error occured while Uploading Files. Please refresh your page and try again.")},e.uploadSubmissionFile=new o({headers:{"X-CSRF-TOKEN":b},alias:"submission_file",url:rootUrl+"save-submission-file",queueLimit:1,removeAfterUpload:!0,autoUpload:!0}),e.uploadSubmissionFile.onBeforeUploadItem=function(t){t.formData=[{problem_id:globalConfig.problem_id,programming_language_id:globalConfig.programming_language_id,submission_type:"submit",submission_content:e.current_code_file_content}]},e.uploadSubmissionFile.onSuccessItem=function(t,n){var o=e.test_problems[e.current_problem_no-1].id;e.attempted_hash[o]||(e.attempted_hash[o]=!0),n.success?(e.submission_limits=n.submission_limits,toastr.success("Succesfully Uploaded Files","SUCCESS")):toastr.error(n.error_message||"Something went wrong! Please contact support@interviewbit.com for further assistance.")},e.uploadSubmissionFile.onErrorItem=function(){recordErrors("Submission file upload failed"),toastr.error("Error occured while Uploading Files. Please refresh your page and try again.")},e.uploadCodeFile=new o({headers:{"X-CSRF-TOKEN":b},alias:"submission_code_file",url:rootUrl+"save-code-file",queueLimit:1,removeAfterUpload:!0,autoUpload:!0}),e.uploadCodeFile.onBeforeUploadItem=function(e){e.formData=[{problem_id:globalConfig.problem_id,programming_language_id:globalConfig.programming_language_id}]},e.uploadCodeFile.onSuccessItem=function(t,n){var o=e.test_problems[e.current_problem_no-1].id;e.attempted_hash[o]||(e.attempted_hash[o]=!0),n.success&&(e.current_code_file_content=n.submission_content,myinterviewtrainer.problem.editor.setValue(e.current_code_file_content||""),myinterviewtrainer.problem.save_code(!0),e.changeDSMLSubmissionState(2,globalConfig.problem_id),toastr.success("Succesfully Uploaded Files","SUCCESS"))},e.uploadCodeFile.onErrorItem=function(){recordErrors("Code upload failed"),toastr.error("Error occured while Uploading Files. Please refresh your page and try again.")},e.showPreviousSubmissionCode=function(t,n){e.current_previous_submission_code=null,e.previous_submissions[t]&&e.previous_submissions[t][n]&&(e.current_previous_submission_code=e.previous_submissions[t][n].submission_content),$("#previous_submission_code_"+t).modal("show")};var w=null,C=null;e.patOpts={x:0,y:0,w:25,h:25},e.channel={},e.webcamError=!1,e.onError=function(t){e.$apply(function(){e.webcamError=t})},e.onSuccess=function(){w=e.channel.video,e.$apply(function(){e.patOpts.w=w.width,e.patOpts.h=w.height,e.showDemos=!0})},e.onStream=function(){},e.makeSnapshot=function(){var t=document.querySelector("#snapshot");if(t&&w){t.width=w.width,t.height=w.height;var n=t.getContext("2d"),o=k(e.patOpts.x,e.patOpts.y,e.patOpts.w,e.patOpts.h);n.putImageData(o,0,0),C=o;p.resizeBase64Image(t.toDataURL("image/png"),160,120).then(function(t){if(t[0]){var n=e.dataURItoBlob(t[0].src),o=[u,e.test_session_id,"image_"+Date.now()+".png"].join("/");c={Key:o,ContentType:"image/png",Body:n},p.addPhoto("snapshot",c)}})}},e.dataURItoBlob=function(e){for(var t=atob(e.split(",")[1]),n=[],o=0;o<t.length;o++)n.push(t.charCodeAt(o));return new Blob([new Uint8Array(n)],{type:"image/png"})};var k=function(e,t,n,o){var i=document.createElement("canvas");i.width=w.width,i.height=w.height;var r=i.getContext("2d");return r.drawImage(w,0,0,w.width,w.height),r.getImageData(e,t,n,o)};e.takeScreenshot=function(){html2canvas(window.parent.document.body).then(function(t){f.resizeBase64Image(t.toDataURL("image/png"),480,270).then(function(t){if(t[0]){var n=e.dataURItoBlob(t[0].src),o=[h,e.test_session_id,"image_"+Date.now()+".png"].join("/");d={Key:o,ContentType:"image/png",Body:n},f.addPhoto("screenshot",d)}})})},e.toggleChatRoom=function(){var e=$("#issuesModal");if("none"==e.css("display")){e.fadeIn();var t=$("#chat_messages");t.length>0&&t.parent().scrollTop(t.parent()[0].scrollHeight)}else e.fadeOut()},
e.closeChatRoom=function(){$("#issuesModal").fadeOut()},e.toggleElement=function(e){var t=$("#"+e);t.is(":visible")?(t.slideUp(),e.includes("solution_prefix")&&t.prev().text("+ Show Solution Prefix"),e.includes("solution_suffix")&&t.prev().text("+ Show Solution Suffix")):(t.slideDown(),e.includes("solution_prefix")&&t.prev().text("- Hide Solution Prefix"),e.includes("solution_suffix")&&t.prev().text("- Hide Solution Suffix"))},e.parseTime=function(e){if(e){return new Date(e).toLocaleString()}},e.getObjectLength=function(e){return e?Object.keys(e).length||0:0},e.parseDateTime=function(e){if(e){var t=new Date(e);return moment(t).format("LLL")}},e.parseInt=function(e){return parseInt(e)},e.objectLength=function(e){return e?Object.keys(e).length:0},e.countValues=function(e,t){var n=0;for(var o in e)e[o]==t&&(n+=1);return n},e.copyToClipboard=function(e){var t=$("<input>");$("body").append(t),t.val(e).select(),document.execCommand("copy"),t.remove(),toastr.info("Code copied to Clipboard","Copied!")},e.markMembersAsPreferred=function(n,o){if(!e.member_emails||0==e.member_emails.length)return void toastr.error("Kindly input a few emails before submitting");t.markMembersAsPreferred({emails:e.member_emails,team_id:o},function(t){t.success?(e.teams_info[n].team_members=t.team_members,toastr.success(t.error_message)):toastr.error(t.error_message),e.member_emails=[]},function(e){e.success||(recordErrors("Mark members as preferred failed"),toastr.error("Error","Something went wrong! Please contact support team for further assistance."))})},e.sendRequestForTeamFormation=function(n,o,i,r){t.sendRequestForTeamFormation({problem_id:n,idea_ass_id:o,member_id:i,member_type:r},function(t){t.success?(toastr.success(t.message),t.request&&(e.requests_sent_hash[n][t.request.id]=t.request),$("#select_request_idea_modal"+n).modal("hide"),$("#request_team_join_modal"+n).modal("hide")):toastr.error(t.message)})},e.actionOfRequest=function(n,o,i=null,r=null){t.actionOfRequest({request_action_type:n,request_id:o,problem_id:i,idea_ass_id:r},function(t){t.success?(toastr.success(t.message),"accept"==n?setTimeout(function(){location.reload()},3e3):"reject"==n?delete e.requests_received_hash[i][o]:"cancel"==n?delete e.requests_sent_hash[i][o]:"counter"==n&&(delete e.requests_received_hash[i][o],t.request&&(e.requests_sent_hash[i][t.request.id]=t.request)),$("#deny_request_modal"+i).modal("hide"),$("#counter_request_modal"+i).modal("hide"),$("#accept_request_modal"+i).modal("hide")):toastr.error(t.message)})},e.openFullScoreboard=function(e){window.ignore_event=!0;var t=$(e).attr("href");e.stopPropagation(),t&&window.open(t,"_blank")}}angular.element(document).ready(function(){s(),$("#ib_loader").show(),e.getLiveTestProblems(),e.checkDownloadSpeed()}),e.summerNoteOptions=summerNoteOptions,e.initalizeFirebase=function(){firebase.apps.length||firebase.initializeApp(e.firebase)},e.initFirePad=function(t){try{e.initalizeFirebase()}catch(e){recordErrors(e)}var n=firebase.database().ref(),o=n.child("assessment_playbacks").child(t.ibt_session_slug).child(t.problem_id);Firepad.fromACE(o,myinterviewtrainer.problem.editor).on("ready",function(){myinterviewtrainer.problem.editor.firepadReady=!0}),myinterviewtrainer.problem.editor.firepadInitiated=!0}}]),ibTestApp.factory("testBackend",["$http",function(e){return e.defaults.headers.common["X-Requested-With"]="AngularXMLHttpRequest",{getLiveTestProblems:function(t){e({method:"GET",url:rootUrl+"live-problems"}).then(function(e){t(e.data)},function(e){serverErrorHandling(e)})},seeExpectedOutput:function(t,n,o){e({method:"POST",url:rootUrl+"see-expected-output",data:t}).then(function(e){e.data.success?n(e.data):o(e.data)},function(e){serverErrorHandling(e)})},getExpectedOutput:function(t,n,o){e({method:"GET",url:rootUrl+"get-expected-output?ask_interviewer_id="+t.ask_interviewer_id}).then(function(e){e.data.success?n(e.data):o(e.data)},function(e){serverErrorHandling(e)})},saveObjectiveAnswer:function(t,n,o){e({method:"POST",url:rootUrl+"save-objective-answer",data:t}).then(function(e){e.data.success?n(e.data):o(e.data)},function(e){serverErrorHandling(e)})},markProblemOpened:function(t,n){e({method:"POST",url:rootUrl+"mark-problem-opened",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},flagQuestion:function(t){e({method:"POST",url:rootUrl+"flag-question",data:t}).then(function(e){e.data.success},function(e){$("#flag_question_"+globalConfig.index).toggleClass("fa-bookmark"),$("#flag_question_"+globalConfig.index).toggleClass("fa-bookmark-o"),$("#flag_question_"+globalConfig.index).toggleClass("flag"),$(".test_problem_"+globalConfig.problem_id+" a span").toggleClass("flagb"),serverErrorHandling(e)})},unlockSection:function(t,n){e({method:"POST",url:rootUrl+"unlock-section",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},updatePriorities:function(t,n){e({method:"POST",url:rootUrl+"update-priorities",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},giveVote:function(t,n){e({method:"POST",url:rootUrl+"give-vote",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},updateMilestone:function(t,n){e({method:"POST",url:rootUrl+"update-milestone",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},commentOnMilestoneAchievement:function(t,n){e({method:"POST",url:rootUrl+"comment",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},updateProjectProblem:function(t,n){e({method:"POST",url:rootUrl+"update-project-details",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},finishTest:function(t){e({method:"POST",url:rootUrl+"finish",data:t}).then(function(e){e.data.success&&(window.location="feedback")},function(e){serverErrorHandling(e)})},getSolution:function(t,n){e({method:"GET",url:rootUrl+"get-code?is_objective=true&problem_id="+t.problem_id+"&programming_language_id="+t.programming_language_id}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},getHintAccess:function(t,n){e({method:"GET",params:t,url:rootUrl+"access-hint"}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},durationPoll:function(t,n,o){var i="poll";t.current_duration!=undefined&&t.current_extra_time!=undefined&&(i=i+"?current_duration="+t.current_duration+"&current_extra_time="+t.current_extra_time),e({method:"GET",url:rootUrl+i}).then(function(e){e.data.success?(DISCONNECTED=!1,n(e.data)):o(e.data)},function(e){DISCONNECTED=!0,CONNECTIVITY_MODAL<1&&e!=undefined&&-1==e.status&&(CONNECTIVITY_MODAL++,openConnectivityCheck())})},liveScoreboard:function(t,n){e({method:"GET",url:rootUrl+"scoreboard"}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},getPostPolicyDocument:function(t,n){e({method:"GET",url:rootUrl+"ppd",params:t}).then(function(e){n(e.data)},function(){})},notifyAdmin:function(t,n){e({method:"POST",url:rootUrl+"notify-admin",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},markMembersAsPreferred:function(t,n){e({method:"POST",url:rootUrl+"invite-members-to-team",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},sendRequestForTeamFormation:function(t,n){e({method:"POST",url:rootUrl+"send-request-for-team-formation",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})},actionOfRequest:function(t,n){e({method:"POST",url:rootUrl+"action-of-request",data:t}).then(function(e){n(e.data)},function(e){serverErrorHandling(e)})}}}]),ibTestApp.filter("sanitize",function(){return function(e){if(e)return e=e.replace(/_/g," "),e?e.split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}).join(" "):""}}),ibTestApp.filter("countdownTimer",function(){return function(e){if(e){var t=Math.floor(e),n=0,o=0,i=0;return t>86400&&(n=Math.floor(t/86400),t%=86400),t>3600&&(o=Math.floor(t/3600),t%=3600),t>60&&(i=Math.floor(t/60),t%=60),n>0?n+"d : "+o+"h : "+i+"m : "+t+"s":o+"h : "+i+"m : "+t+"s"}}}),ibTestApp.filter("scoreFilter",function(){return function(e,t){var n=[];if(e)for(var o=0;o<e.length;o++){var i=e[o].score;i>=t&&n.push(e[o])}return n}}),ibTestApp.filter("startFrom",function(){return function(e,t){return e?(t=+t,e.slice(t)):[]}}),ibTestApp.filter("trim",function(){return function(e){return angular.isString(e)?e.replace(/^\s+|\s+$/g,""):e}}),ibTestApp.filter("truncate",function(){return function(e,t,n,o){if(!e)return"";if(!(n=parseInt(n,10)))return e;if(e.length<=n)return e;if(e=e.substr(0,n),t){var i=e.lastIndexOf(" ");-1!==i&&("."!==e.charAt(i-1)&&","!==e.charAt(i-1)||(i-=1),e=e.substr(0,i))}return e+(o||" \u2026")}}),ibTestApp.filter("filterByTags",function(){return function(e,t){if(!t||t.length<1)return e;var n=[];return(e||[]).forEach(function(e){t.some(function(t){var n=[];return angular.forEach(e.tags,function(e){n.push(e.name)}),n.indexOf(t.text)>-1||e.title.toString().toLowerCase().includes(t.text.toLowerCase())||e.description.toString().toLowerCase().includes(t.text.toLowerCase())})&&n.push(e)}),n}});